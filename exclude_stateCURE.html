<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Methodology for the Fiscal Futures Annual Report - 3&nbsp; Alternate Analysis: Dropping State CURE Funds</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Everything.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>


</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Methodology for the Fiscal Futures Annual Report</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" aria-current="page"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/AleaWM/Fiscal-Futures-IL-FY2023/tree/main/data"> 
<span class="menu-text">Data</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/AleaWM/Fiscal-Futures-IL-FY2023.git"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./exclude_stateCURE.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Alternate Analysis: Dropping State CURE Funds</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Background Information</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Everything_notrounded.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Calculating the Fiscal Gap - Extra Decimals in tables</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Everything.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Calculating the Fiscal Gap</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exclude_stateCURE.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Alternate Analysis: Dropping State CURE Funds</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#with-federal-stimulus-from-covid-response" id="toc-with-federal-stimulus-from-covid-response" class="nav-link active" data-scroll-target="#with-federal-stimulus-from-covid-response"><span class="header-section-number">3.1</span> With Federal Stimulus from COVID Response</a></li>
  <li><a href="#drop-state-cure-federal-stimulus-funds" id="toc-drop-state-cure-federal-stimulus-funds" class="nav-link" data-scroll-target="#drop-state-cure-federal-stimulus-funds"><span class="header-section-number">3.2</span> Drop State CURE Federal Stimulus Funds</a>
  <ul class="collapse">
  <li><a href="#forecasting-attempt" id="toc-forecasting-attempt" class="nav-link" data-scroll-target="#forecasting-attempt"><span class="header-section-number">3.2.1</span> Forecasting attempt</a></li>
  <li><a href="#all-categories-with-totals" id="toc-all-categories-with-totals" class="nav-link" data-scroll-target="#all-categories-with-totals"><span class="header-section-number">3.2.2</span> All Categories with Totals</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Alternate Analysis: Dropping State CURE Funds</span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<blockquote class="blockquote">
<p>Not correct yet.</p>
</blockquote>
<blockquote class="blockquote">
<p>Moved from the Calculating the Fiscal Gap quarto doc and it became more of an ordeal than I thought it would be.</p>
</blockquote>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cmapplot)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">warning =</span> <span class="cn">FALSE</span>, <span class="at">message =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_classic</span>() )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>exp_temp <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/exp_temp.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">agency =</span> <span class="fu">as.character</span>(agency),</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">object =</span> <span class="fu">as.character</span>(object),</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">object =</span> <span class="fu">str_pad</span>(object, <span class="at">side =</span> <span class="st">"left"</span>, <span class="dv">4</span>, <span class="at">pad =</span> <span class="st">"0"</span>),</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">sequence =</span> <span class="fu">as.character</span>(sequence),</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">sequence =</span> <span class="fu">str_pad</span>(sequence, <span class="at">side =</span> <span class="st">"left"</span>, <span class="dv">2</span>, <span class="at">pad =</span> <span class="st">"0"</span>),</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="fu">as.character</span>(type),</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="fu">str_pad</span>(type, <span class="at">side =</span> <span class="st">"left"</span>, <span class="dv">2</span>, <span class="at">pad =</span> <span class="st">"0"</span>),</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">appr_org =</span> <span class="fu">as.character</span>(appr_org),</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">appr_org =</span> <span class="fu">str_pad</span>(appr_org, <span class="at">side =</span> <span class="st">"left"</span>, <span class="dv">2</span>, <span class="at">pad =</span> <span class="st">"0"</span>),</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">fund =</span> <span class="fu">as.character</span>(fund),</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">fund =</span> <span class="fu">str_pad</span>(fund, <span class="at">side =</span> <span class="st">"left"</span>, <span class="dv">4</span>, <span class="at">pad =</span> <span class="st">"0"</span>),</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">fund_ioc =</span> <span class="fu">as.character</span>(fund_ioc))</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>exp_temp <span class="ot">&lt;-</span> exp_temp <span class="sc">%&gt;%</span> </span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">eehc =</span> <span class="fu">ifelse</span>(</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># group insurance contributions for 1998-2005 and 2013-present</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>   fund <span class="sc">==</span> <span class="st">"0001"</span> <span class="sc">&amp;</span> (object <span class="sc">==</span> <span class="st">"1180"</span> <span class="sc">|</span> object <span class="sc">==</span><span class="st">"1900"</span>) <span class="sc">&amp;</span> agency <span class="sc">==</span> <span class="st">"416"</span> <span class="sc">&amp;</span> appr_org<span class="sc">==</span><span class="st">"20"</span>, <span class="dv">0</span>, <span class="dv">1</span>) )<span class="sc">%&gt;%</span> </span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">eehc =</span> <span class="fu">ifelse</span>(</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># group insurance contributions for 2006-2012</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    fund <span class="sc">==</span> <span class="st">"0001"</span> <span class="sc">&amp;</span> object <span class="sc">==</span> <span class="st">"1180"</span> <span class="sc">&amp;</span> agency <span class="sc">==</span> <span class="st">"478"</span> </span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    <span class="sc">&amp;</span> appr_org<span class="sc">==</span><span class="st">"80"</span>, <span class="dv">0</span>, eehc) )<span class="sc">%&gt;%</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>   <span class="co"># group insurance contributions from road fund</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># coded with 1900 for some reason??</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">eehc =</span> <span class="fu">ifelse</span>(</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>      fund <span class="sc">==</span> <span class="st">"0011"</span> <span class="sc">&amp;</span> object <span class="sc">==</span> <span class="st">"1900"</span> <span class="sc">&amp;</span> </span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>        agency <span class="sc">==</span> <span class="st">"416"</span> <span class="sc">&amp;</span> appr_org<span class="sc">==</span><span class="st">"20"</span>, <span class="dv">0</span>, eehc) ) <span class="sc">%&gt;%</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">expenditure =</span> <span class="fu">ifelse</span>(eehc<span class="sc">==</span><span class="st">"0"</span>, <span class="dv">0</span>, expenditure)) <span class="sc">%&gt;%</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">agency =</span> <span class="fu">case_when</span>(   <span class="co"># turns specific items into State Employee Healthcare (agency=904)</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>      fund<span class="sc">==</span><span class="st">"0907"</span> <span class="sc">&amp;</span> (agency<span class="sc">==</span><span class="st">"416"</span> <span class="sc">&amp;</span> appr_org<span class="sc">==</span><span class="st">"20"</span>) <span class="sc">~</span> <span class="st">"904"</span>,   <span class="co"># central management Bureau of benefits using health insurance reserve </span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>      fund<span class="sc">==</span><span class="st">"0907"</span> <span class="sc">&amp;</span> (agency<span class="sc">==</span><span class="st">"478"</span> <span class="sc">&amp;</span> appr_org<span class="sc">==</span><span class="st">"80"</span>) <span class="sc">~</span> <span class="st">"904"</span>,   <span class="co"># agency = 478: healthcare &amp; family services using health insurance reserve - stopped using this in 2012</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.character</span>(agency))) <span class="sc">%&gt;%</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">agency_name =</span> <span class="fu">ifelse</span>(</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>    agency <span class="sc">==</span> <span class="st">"904"</span>, <span class="st">"STATE EMPLOYEE HEALTHCARE"</span>, <span class="fu">as.character</span>(agency_name)),</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>         <span class="at">in_ff =</span> <span class="fu">ifelse</span>( agency <span class="sc">==</span> <span class="st">"904"</span>, <span class="dv">1</span>, in_ff),</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>         <span class="at">group =</span> <span class="fu">ifelse</span>(agency <span class="sc">==</span> <span class="st">"904"</span>, <span class="st">"904"</span>, <span class="fu">as.character</span>(agency)))  </span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a><span class="co"># creates group variable</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Default group = agency number</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>healthcare_costs <span class="ot">&lt;-</span> exp_temp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">"904"</span>)</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>healthcare_costs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["fy"],"name":[1],"type":["int"],"align":["right"]},{"label":["fund"],"name":[2],"type":["chr"],"align":["left"]},{"label":["fund_name"],"name":[3],"type":["chr"],"align":["left"]},{"label":["agency"],"name":[4],"type":["chr"],"align":["left"]},{"label":["agency_name"],"name":[5],"type":["chr"],"align":["left"]},{"label":["appr_org"],"name":[6],"type":["chr"],"align":["left"]},{"label":["org_name"],"name":[7],"type":["chr"],"align":["left"]},{"label":["obj_seq_type"],"name":[8],"type":["chr"],"align":["left"]},{"label":["wh_approp_name"],"name":[9],"type":["chr"],"align":["left"]},{"label":["appn_net_xfer"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["expenditure"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["data_source"],"name":[12],"type":["chr"],"align":["left"]},{"label":["fund_ab"],"name":[13],"type":["chr"],"align":["left"]},{"label":["fund_ioc"],"name":[14],"type":["chr"],"align":["left"]},{"label":["fund_re"],"name":[15],"type":["int"],"align":["right"]},{"label":["a_end"],"name":[16],"type":["lgl"],"align":["right"]},{"label":["in_ff"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["fund_name_ab"],"name":[18],"type":["chr"],"align":["left"]},{"label":["fund_category"],"name":[19],"type":["chr"],"align":["left"]},{"label":["fund_cat_name"],"name":[20],"type":["chr"],"align":["left"]},{"label":["transfer"],"name":[21],"type":["int"],"align":["right"]},{"label":["trans_agency"],"name":[22],"type":["int"],"align":["right"]},{"label":["trans_type"],"name":[23],"type":["chr"],"align":["left"]},{"label":["object"],"name":[24],"type":["chr"],"align":["left"]},{"label":["sequence"],"name":[25],"type":["chr"],"align":["left"]},{"label":["type"],"name":[26],"type":["chr"],"align":["left"]},{"label":["eehc"],"name":[27],"type":["dbl"],"align":["right"]},{"label":["group"],"name":[28],"type":["chr"],"align":["left"]}],"data":[{"1":"1998","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"20","7":"BUREAU OF BENEFITS","8":"19001000","9":"NA","10":"0","11":"0.000000e+00","12":"exp IOC 12.08.13","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"10","26":"00","27":"1","28":"904"},{"1":"1998","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"20","7":"BUREAU OF BENEFITS","8":"19001100","9":"NA","10":"0","11":"0.000000e+00","12":"exp IOC 12.08.13","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"11","26":"00","27":"1","28":"904"},{"1":"1998","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"20","7":"BUREAU OF BENEFITS","8":"19002000","9":"NA","10":"730641100","11":"7.296027e+08","12":"exp IOC 12.08.13","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"20","26":"00","27":"1","28":"904"},{"1":"1998","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"20","7":"BUREAU OF BENEFITS","8":"19002100","9":"NA","10":"158900","11":"1.578291e+05","12":"exp IOC 12.08.13","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"21","26":"00","27":"1","28":"904"},{"1":"1999","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"20","7":"BUREAU OF BENEFITS","8":"19002000","9":"NA","10":"779533100","11":"7.788591e+08","12":"exp IOC 13.08.13","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"20","26":"00","27":"1","28":"904"},{"1":"1999","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"20","7":"BUREAU OF BENEFITS","8":"19002100","9":"NA","10":"158900","11":"1.583926e+05","12":"exp IOC 13.08.13","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"21","26":"00","27":"1","28":"904"},{"1":"2000","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"20","7":"BUREAU OF BENEFITS","8":"19002000","9":"NA","10":"927841100","11":"9.273363e+08","12":"exp IOC 13.08.13","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"20","26":"00","27":"1","28":"904"},{"1":"2000","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"20","7":"BUREAU OF BENEFITS","8":"19002100","9":"NA","10":"158900","11":"1.501953e+05","12":"exp IOC 13.08.13","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"21","26":"00","27":"1","28":"904"},{"1":"2001","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"20","7":"BUREAU OF BENEFITS","8":"19002000","9":"NA","10":"1005744400","11":"9.999671e+08","12":"exp IOC 13.08.12","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"20","26":"00","27":"1","28":"904"},{"1":"2001","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"20","7":"BUREAU OF BENEFITS","8":"19002100","9":"NA","10":"158900","11":"1.586296e+05","12":"exp IOC 13.08.12","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"21","26":"00","27":"1","28":"904"},{"1":"2002","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"20","7":"BUREAU OF BENEFITS","8":"19002000","9":"NA","10":"1176087800","11":"1.061777e+09","12":"exp IOC 13.08.13","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"20","26":"00","27":"1","28":"904"},{"1":"2002","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"20","7":"BUREAU OF BENEFITS","8":"19002100","9":"NA","10":"158900","11":"1.584219e+05","12":"exp IOC 13.08.13","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"21","26":"00","27":"1","28":"904"},{"1":"2003","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"20","7":"BUREAU OF BENEFITS","8":"19002000","9":"NA","10":"1316781200","11":"1.314591e+09","12":"exp IOC 13.08.12","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"20","26":"00","27":"1","28":"904"},{"1":"2003","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"20","7":"BUREAU OF BENEFITS","8":"19002100","9":"NA","10":"158900","11":"1.571030e+05","12":"exp IOC 13.08.12","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"21","26":"00","27":"1","28":"904"},{"1":"2004","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"20","7":"BUREAU OF BENEFITS","8":"19002000","9":"NA","10":"1533131846","11":"1.431409e+09","12":"exp IOC 13.08.12","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"20","26":"00","27":"1","28":"904"},{"1":"2004","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"20","7":"BUREAU OF BENEFITS","8":"19002100","9":"NA","10":"158900","11":"1.557220e+05","12":"exp IOC 13.08.12","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"21","26":"00","27":"1","28":"904"},{"1":"2005","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"20","7":"BUREAU OF BENEFITS","8":"19002000","9":"NA","10":"1641441958","11":"1.522538e+09","12":"exp IOC 13.08.12","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"20","26":"00","27":"1","28":"904"},{"1":"2005","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"20","7":"BUREAU OF BENEFITS","8":"19002100","9":"NA","10":"158900","11":"1.589000e+05","12":"exp IOC 13.08.12","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"21","26":"00","27":"1","28":"904"},{"1":"2006","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"20","7":"BUREAU OF BENEFITS","8":"19002000","9":"NA","10":"17924200","11":"1.020864e+07","12":"exp IOC 13.08.12","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"20","26":"00","27":"1","28":"904"},{"1":"2006","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"20","7":"BUREAU OF BENEFITS","8":"19002100","9":"NA","10":"158900","11":"1.557220e+05","12":"exp IOC 13.08.12","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"21","26":"00","27":"1","28":"904"},{"1":"2006","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"80","7":"EMPLOYEE HEALTH INSURANCE","8":"19000000","9":"NA","10":"1683284300","11":"1.612468e+09","12":"exp IOC 13.08.12","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"00","26":"00","27":"1","28":"904"},{"1":"2007","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"20","7":"BUREAU OF BENEFITS","8":"19002000","9":"NA","10":"13752000","11":"8.686741e+06","12":"exp IOC 13.08.09","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"20","26":"00","27":"1","28":"904"},{"1":"2007","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"20","7":"BUREAU OF BENEFITS","8":"19002100","9":"NA","10":"158900","11":"1.557000e+05","12":"exp IOC 13.08.09","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"21","26":"00","27":"1","28":"904"},{"1":"2007","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"80","7":"EMPLOYEE HEALTH INSURANCE","8":"19000000","9":"NA","10":"1785234100","11":"1.742781e+09","12":"exp IOC 13.08.09","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"00","26":"00","27":"1","28":"904"},{"1":"2008","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"20","7":"BUREAU OF BENEFITS","8":"19002000","9":"NA","10":"13752000","11":"9.470247e+06","12":"exp IOC 13.08.09","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"20","26":"00","27":"1","28":"904"},{"1":"2008","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"20","7":"BUREAU OF BENEFITS","8":"19002100","9":"NA","10":"158900","11":"0.000000e+00","12":"exp IOC 13.08.09","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"21","26":"00","27":"1","28":"904"},{"1":"2008","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"80","7":"EMPLOYEE HEALTH INSURANCE","8":"19000000","9":"NA","10":"1877858400","11":"1.780198e+09","12":"exp IOC 13.08.09","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"00","26":"00","27":"1","28":"904"},{"1":"2009","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"20","7":"BUREAU OF BENEFITS","8":"19002000","9":"HEALTH CARE COVERAGE","10":"12752000","11":"9.059454e+06","12":"exp IOC 13.10.15","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"20","26":"00","27":"1","28":"904"},{"1":"2009","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"20","7":"BUREAU OF BENEFITS","8":"19002100","9":"COST CONTAINMENT PROGRAM","10":"158900","11":"3.380353e+04","12":"exp IOC 13.10.15","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"21","26":"00","27":"1","28":"904"},{"1":"2009","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"80","7":"EMPLOYEE HEALTH INSURANCE","8":"19000000","9":"LUMP SUMS AND OTHER PURPOSES","10":"1877540500","11":"1.760936e+09","12":"exp IOC 13.10.15","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"00","26":"00","27":"1","28":"904"},{"1":"2010","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"20","7":"BUREAU OF BENEFITS","8":"19002000","9":"HEALTH CARE COVERAGE","10":"22752000","11":"1.939374e+07","12":"exp IOC 13.08.09","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"20","26":"00","27":"1","28":"904"},{"1":"2010","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"20","7":"BUREAU OF BENEFITS","8":"19002100","9":"COST CONTAINMENT PROGRAM","10":"158900","11":"1.937955e+04","12":"exp IOC 13.08.09","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"21","26":"00","27":"1","28":"904"},{"1":"2010","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"80","7":"EMPLOYEE HEALTH INSURANCE","8":"19000000","9":"LUMP SUMS AND OTHER PURPOSES","10":"2044223800","11":"1.772797e+09","12":"exp IOC 13.08.09","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"00","26":"00","27":"1","28":"904"},{"1":"2011","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"20","7":"BUREAU OF BENEFITS","8":"19002000","9":"HEALTH CARE COVERAGE","10":"27752000","11":"2.430808e+07","12":"exp IOC 13.08.09","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"20","26":"00","27":"1","28":"904"},{"1":"2011","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"20","7":"BUREAU OF BENEFITS","8":"19002100","9":"COST CONTAINMENT PROGRAM","10":"158900","11":"5.097520e+03","12":"exp IOC 13.08.09","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"21","26":"00","27":"1","28":"904"},{"1":"2011","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"80","7":"EMPLOYEE HEALTH INSURANCE","8":"19000000","9":"LUMP SUMS AND OTHER PURPOSES","10":"2104902000","11":"1.860115e+09","12":"exp IOC 13.08.09","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"00","26":"00","27":"1","28":"904"},{"1":"2012","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"20","7":"BUREAU OF BENEFITS","8":"19002000","9":"PROVISIONS/HLTH CARE COVERAGE","10":"27752000","11":"2.600591e+07","12":"exp IOC 13.08.09","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"20","26":"00","27":"1","28":"904"},{"1":"2012","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"20","7":"BUREAU OF BENEFITS","8":"19002100","9":"COST CONTAINMENT PROGRAM","10":"158900","11":"1.767090e+04","12":"exp IOC 13.08.09","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"21","26":"00","27":"1","28":"904"},{"1":"2012","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"80","7":"EMPLOYEE HEALTH INSURANCE","8":"19000000","9":"HEALTH CARE COVERAGE","10":"2390682900","11":"2.327683e+09","12":"exp IOC 13.08.09","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"00","26":"00","27":"1","28":"904"},{"1":"2013","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"20","7":"BUREAU OF BENEFITS","8":"19000000","9":"PROVISION OF HLTHCARE COVERAGE","10":"2900114500","11":"2.174924e+09","12":"exp IOC 14.09.08","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"00","26":"00","27":"1","28":"904"},{"1":"2013","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"20","7":"BUREAU OF BENEFITS","8":"19002100","9":"COST CONTAINMENT PROGRAM","10":"158900","11":"2.227710e+03","12":"exp IOC 14.09.08","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"21","26":"00","27":"1","28":"904"},{"1":"2014","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"20","7":"BUREAU OF BENEFITS","8":"19000000","9":"PROVISION OF HLTHCARE COVERAGE","10":"2943000000","11":"2.625894e+09","12":"exp IOC 15.04.28","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"00","26":"00","27":"1","28":"904"},{"1":"2015","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"20","7":"BUREAU OF BENEFITS","8":"19000000","9":"PROVISION OF HLTHCARE COVERAGE","10":"3062546300","11":"2.454666e+09","12":"exp ioc 16.01.07","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"00","26":"00","27":"1","28":"904"},{"1":"2016","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"20","7":"BUREAU OF BENEFITS","8":"19000000","9":"PROVISION OF HLTHCARE COVERAGE","10":"3011000000","11":"4.786740e+08","12":"exp ioc 16.10.24","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"00","26":"00","27":"1","28":"904"},{"1":"2017","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"20","7":"BUREAU OF BENEFITS","8":"19000000","9":"PROVISION HLTHCARE COVERAGE","10":"6500000000","11":"3.320902e+09","12":"exp ioc 17.11.29","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"00","26":"00","27":"1","28":"904"},{"1":"2018","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"20","7":"BUREAU OF BENEFITS","8":"19000000","9":"PROVISION HLTHCARE COVERAGE","10":"6000000000","11":"5.851728e+09","12":"NA","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"00","26":"00","27":"1","28":"904"},{"1":"2019","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"20","7":"BUREAU OF BENEFITS","8":"19000000","9":"PROVISION HLTHCARE COVERAGE","10":"4000000000","11":"3.151879e+09","12":"exp ioc 12.11.2019","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"00","26":"00","27":"1","28":"904"},{"1":"2020","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"20","7":"BUREAU OF BENEFITS","8":"19000000","9":"PROVISION HLTHCARE COVERAGE","10":"5000000000","11":"2.981818e+09","12":"exp ioc 03.11.2020","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"00","26":"00","27":"1","28":"904"},{"1":"2021","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"20","7":"BUREAU OF BENEFITS","8":"19910000","9":"PROMPT PAYMENT INTEREST","10":"85000000","11":"0.000000e+00","12":"NA","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1991","25":"00","26":"00","27":"1","28":"904"},{"1":"2021","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"20","7":"BUREAU OF BENEFITS","8":"19000000","9":"PROVISION HLTHCARE COVERAGE","10":"4915000000","11":"2.881402e+09","12":"NA","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"00","26":"00","27":"1","28":"904"},{"1":"2022","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"20","7":"BUREAU OF BENEFITS","8":"19000000","9":"PROVISION HLTHCARE COVERAGE","10":"4915000000","11":"3.005209e+09","12":"exp_ioc_22.08.01","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"00","26":"00","27":"1","28":"904"},{"1":"2022","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"20","7":"BUREAU OF BENEFITS","8":"19910000","9":"PROMPT PAYMENT INTEREST","10":"85000000","11":"0.000000e+00","12":"exp_ioc_22.08.01","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1991","25":"00","26":"00","27":"1","28":"904"},{"1":"2023","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"20","7":"BUREAU OF BENEFITS","8":"19000099","9":"PROVISION HLTHCARE COVERAGE","10":"3695000000","11":"3.002363e+09","12":"exp IOC 011.14.2023","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1900","25":"00","26":"99","27":"1","28":"904"},{"1":"2023","2":"0907","3":"HEALTH INSURANCE RESERVE","4":"904","5":"STATE EMPLOYEE HEALTHCARE","6":"20","7":"BUREAU OF BENEFITS","8":"19910099","9":"PROMPT PAYMENT INTEREST","10":"5000000","11":"0.000000e+00","12":"exp IOC 011.14.2023","13":"0907","14":"907","15":"0","16":"NA","17":"1","18":"HEALTH INSURANCE RESERVE","19":"D","20":"Special State Fund","21":"0","22":"NA","23":"NA","24":"1991","25":"00","26":"99","27":"1","28":"904"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>exp_temp <span class="ot">&lt;-</span> exp_temp <span class="sc">%&gt;%</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">agency =</span> <span class="fu">case_when</span>(fund<span class="sc">==</span><span class="st">"0515"</span> <span class="sc">&amp;</span> object<span class="sc">==</span><span class="st">"4470"</span> <span class="sc">&amp;</span> type<span class="sc">==</span><span class="st">"08"</span> <span class="sc">~</span> <span class="st">"971"</span>, <span class="co"># income tax to local governments</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>                     fund<span class="sc">==</span><span class="st">"0515"</span> <span class="sc">&amp;</span> object<span class="sc">==</span><span class="st">"4491"</span> <span class="sc">&amp;</span> type<span class="sc">==</span><span class="st">"08"</span> <span class="sc">&amp;</span> sequence<span class="sc">==</span><span class="st">"00"</span> <span class="sc">~</span> <span class="st">"971"</span>, <span class="co"># object is shared revenue payments</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>                     fund<span class="sc">==</span><span class="st">"0802"</span> <span class="sc">&amp;</span> object<span class="sc">==</span><span class="st">"4491"</span> <span class="sc">~</span> <span class="st">"972"</span>, <span class="co">#pprt transfer</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>                     fund<span class="sc">==</span><span class="st">"0515"</span> <span class="sc">&amp;</span> object<span class="sc">==</span><span class="st">"4491"</span> <span class="sc">&amp;</span> type<span class="sc">==</span><span class="st">"08"</span> <span class="sc">&amp;</span> sequence<span class="sc">==</span><span class="st">"01"</span> <span class="sc">~</span> <span class="st">"976"</span>, <span class="co">#gst to local</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>                     fund<span class="sc">==</span><span class="st">"0627"</span> <span class="sc">&amp;</span> object<span class="sc">==</span><span class="st">"4472"</span><span class="sc">~</span> <span class="st">"976"</span> , <span class="co"># public transportation fund but no observations exist</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>                     fund<span class="sc">==</span><span class="st">"0648"</span> <span class="sc">&amp;</span> object<span class="sc">==</span><span class="st">"4472"</span> <span class="sc">~</span> <span class="st">"976"</span>, <span class="co"># downstate public transportation, but doesn't exist</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>                     fund<span class="sc">==</span><span class="st">"0515"</span> <span class="sc">&amp;</span> object<span class="sc">==</span><span class="st">"4470"</span> <span class="sc">&amp;</span> type<span class="sc">==</span><span class="st">"00"</span> <span class="sc">~</span> <span class="st">"976"</span>, <span class="co"># object 4470 is grants to local governments</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>                    object<span class="sc">==</span><span class="st">"4491"</span> <span class="sc">&amp;</span> (fund<span class="sc">==</span><span class="st">"0188"</span><span class="sc">|</span>fund<span class="sc">==</span><span class="st">"0189"</span>) <span class="sc">~</span> <span class="st">"976"</span>,</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>                     fund<span class="sc">==</span><span class="st">"0187"</span> <span class="sc">&amp;</span> object<span class="sc">==</span><span class="st">"4470"</span> <span class="sc">~</span> <span class="st">"976"</span>,</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>                     fund<span class="sc">==</span><span class="st">"0186"</span> <span class="sc">&amp;</span> object<span class="sc">==</span><span class="st">"4470"</span> <span class="sc">~</span> <span class="st">"976"</span>,</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>                    object<span class="sc">==</span><span class="st">"4491"</span> <span class="sc">&amp;</span> (fund<span class="sc">==</span><span class="st">"0413"</span><span class="sc">|</span>fund<span class="sc">==</span><span class="st">"0414"</span><span class="sc">|</span>fund<span class="sc">==</span><span class="st">"0415"</span>)  <span class="sc">~</span> <span class="st">"975"</span>, <span class="co">#mft to local</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>                  fund <span class="sc">==</span> <span class="st">"0952"</span><span class="sc">~</span> <span class="st">"975"</span>, <span class="co"># Added Sept 29 2022 AWM. Transportation Renewal MFT</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>                    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.character</span>(agency)),</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">agency_name =</span> <span class="fu">case_when</span>(agency <span class="sc">==</span> <span class="st">"971"</span><span class="sc">~</span> <span class="st">"INCOME TAX 1/10 TO LOCAL"</span>,</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>                          agency <span class="sc">==</span> <span class="st">"972"</span> <span class="sc">~</span> <span class="st">"PPRT TRANSFER TO LOCAL"</span>,</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>                          agency <span class="sc">==</span> <span class="st">"975"</span> <span class="sc">~</span> <span class="st">"MFT TO LOCAL"</span>,</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>                          agency <span class="sc">==</span> <span class="st">"976"</span> <span class="sc">~</span> <span class="st">"GST TO LOCAL"</span>,</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span><span class="sc">~</span><span class="fu">as.character</span>(agency_name)),</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">ifelse</span>(agency <span class="sc">&gt;</span> <span class="st">"970"</span> <span class="sc">&amp;</span> agency <span class="sc">&lt;</span> <span class="st">"977"</span>, <span class="fu">as.character</span>(agency), <span class="fu">as.character</span>(group)))</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>transfers_long <span class="ot">&lt;-</span> exp_temp <span class="sc">%&gt;%</span> </span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">"971"</span> <span class="sc">|</span> group <span class="sc">==</span> <span class="st">"972"</span> <span class="sc">|</span> group <span class="sc">==</span> <span class="st">"975"</span> <span class="sc">|</span> group <span class="sc">==</span> <span class="st">"976"</span>)</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>transfers_long <span class="sc">%&gt;%</span> </span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(agency_name, group, fy) <span class="sc">%&gt;%</span> </span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">expenditure =</span> <span class="fu">sum</span>(expenditure, <span class="at">na.rm=</span><span class="cn">TRUE</span>) )<span class="sc">%&gt;%</span> </span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>fy, <span class="at">y =</span> expenditure, <span class="at">color=</span>agency_name)) <span class="sc">+</span> </span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, <span class="at">legend.title=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Transfers to Local Governments"</span>, </span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Data Source: Illinois Office of the Comptroller"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="exclude_stateCURE_files/figure-html/transfers-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>transfers <span class="ot">&lt;-</span> transfers_long <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fy, group ) <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">sum_expenditure =</span> <span class="fu">sum</span>(expenditure)<span class="sc">/</span><span class="dv">1000000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"group"</span>, <span class="at">values_from =</span> <span class="st">"sum_expenditure"</span>, <span class="at">names_prefix =</span> <span class="st">"exp_"</span> )</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>debt_drop <span class="ot">&lt;-</span> exp_temp <span class="sc">%&gt;%</span> </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(object <span class="sc">==</span> <span class="st">"8841"</span> <span class="sc">|</span>  object <span class="sc">==</span> <span class="st">"8811"</span>)  </span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co"># escrow  OR  principle</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co">#debt_drop %&gt;% group_by(fy) %&gt;% summarize(sum = sum(expenditure)) %&gt;% arrange(-fy)</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>debt_keep <span class="ot">&lt;-</span> exp_temp <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">agency =</span> <span class="fu">as.character</span>(agency)) <span class="sc">%&gt;%</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(fund <span class="sc">!=</span> <span class="st">"0455"</span> <span class="sc">&amp;</span> (object <span class="sc">==</span> <span class="st">"8813"</span> <span class="sc">|</span> object <span class="sc">==</span> <span class="st">"8800"</span> )) </span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="co"># examine the debt costs we want to include</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="co">#debt_keep %&gt;% group_by(fy) %&gt;% summarize(sum = sum(expenditure)) %&gt;% arrange(-fy) </span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>exp_temp <span class="ot">&lt;-</span> <span class="fu">anti_join</span>(exp_temp, debt_drop) </span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>exp_temp <span class="ot">&lt;-</span> <span class="fu">anti_join</span>(exp_temp, debt_keep)</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>debt_keep <span class="ot">&lt;-</span> debt_keep <span class="sc">%&gt;%</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">agency =</span> <span class="fu">ifelse</span>(fund <span class="sc">!=</span> <span class="st">"0455"</span> <span class="sc">&amp;</span> (object <span class="sc">==</span> <span class="st">"8813"</span> <span class="sc">|</span> object <span class="sc">==</span> <span class="st">"8800"</span>), <span class="st">"903"</span>, <span class="fu">as.character</span>(agency)),</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="fu">ifelse</span>(fund <span class="sc">!=</span> <span class="st">"0455"</span> <span class="sc">&amp;</span> (object <span class="sc">==</span> <span class="st">"8813"</span> <span class="sc">|</span> object <span class="sc">==</span> <span class="st">"8800"</span>), <span class="st">"903"</span>, <span class="fu">as.character</span>(group)),</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">in_ff =</span> <span class="fu">ifelse</span>(group <span class="sc">==</span> <span class="st">"903"</span>, <span class="dv">1</span>, <span class="fu">as.character</span>(in_ff)))</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>debt_keep_yearly <span class="ot">&lt;-</span> debt_keep <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(fy, group) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">debt_cost =</span> <span class="fu">sum</span>(expenditure,<span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">1000000</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>group)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>exp_temp <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/all_expenditures_recoded.csv"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co">#exp_temp &lt;- read.csv("data/exp_fy23_recoded_02April2024.csv") %&gt;% </span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#exp_temp &lt;- read.csv("data/exp_temp.csv") %&gt;% </span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">agency =</span> <span class="fu">as.character</span>(agency),</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">object =</span> <span class="fu">as.character</span>(object),</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">object =</span> <span class="fu">str_pad</span>(object, <span class="at">side =</span> <span class="st">"left"</span>, <span class="dv">4</span>, <span class="at">pad =</span> <span class="st">"0"</span>),</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">sequence =</span> <span class="fu">as.character</span>(sequence),</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">sequence =</span> <span class="fu">str_pad</span>(sequence, <span class="at">side =</span> <span class="st">"left"</span>, <span class="dv">2</span>, <span class="at">pad =</span> <span class="st">"0"</span>),</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="fu">as.character</span>(type),</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="fu">str_pad</span>(type, <span class="at">side =</span> <span class="st">"left"</span>, <span class="dv">2</span>, <span class="at">pad =</span> <span class="st">"0"</span>),</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">appr_org =</span> <span class="fu">as.character</span>(appr_org),</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">appr_org =</span> <span class="fu">str_pad</span>(appr_org, <span class="at">side =</span> <span class="st">"left"</span>, <span class="dv">2</span>, <span class="at">pad =</span> <span class="st">"0"</span>),</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">fund =</span> <span class="fu">as.character</span>(fund),</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">fund =</span> <span class="fu">str_pad</span>(fund, <span class="at">side =</span> <span class="st">"left"</span>, <span class="dv">4</span>, <span class="at">pad =</span> <span class="st">"0"</span>))</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co"># rev_temp &lt;- read.csv("data/rev_temp.csv") %&gt;%</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a> <span class="co"># rev_temp &lt;- read.csv("data/rev_fy23_recoded_02April2024.csv") %&gt;%</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>rev_temp <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/all_revenue_recoded.csv"</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rev_type =</span> <span class="fu">as.character</span>(rev_type),</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">agency =</span> <span class="fu">as.character</span>(agency),</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">fund =</span> <span class="fu">str_pad</span>(fund, <span class="at">side =</span> <span class="st">"left"</span>, <span class="dv">4</span>, <span class="at">pad =</span> <span class="st">"0"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Dropping State CURE Revenue</strong></p>
<p>The Fiscal Futures model focuses on sustainable revenue sources. To understand our fiscal gap and outlook, we need to exclude these one time revenues. GOMB has emphasized that they have allocated COVID dollars to one time expenditures (unemployment trust fund, budget stabilization fund, etc.). The fiscal gap, graphs,and CAGRs have been recalculated in the [Drop COVID Dollars] section below.</p>
<blockquote class="blockquote">
<p>NOTE: The code chunk below only drops revenue sources with the source name of “Federal Stimulus Package” (which is the State and Local CURE revenue). Additional federal money went into other funds during the beginning of pandemic. Many departments saw increased grants and received other funds (e.g.&nbsp;funds)</p>
</blockquote>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>rev_temp <span class="ot">&lt;-</span> rev_temp <span class="sc">%&gt;%</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">covid_dollars =</span> <span class="fu">ifelse</span>(source_name_AWM <span class="sc">==</span> <span class="st">"FEDERAL STIMULUS PACKAGE"</span>,<span class="dv">1</span>,<span class="dv">0</span>))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># rev_temp %&gt;% filter(source_name_AWM == "FEDERAL STIMULUS PACKAGE") %&gt;%</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">#  group_by(fy) %&gt;% summarize(Received = sum(receipts))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="with-federal-stimulus-from-covid-response" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="with-federal-stimulus-from-covid-response"><span class="header-section-number">3.1</span> With Federal Stimulus from COVID Response</h2>
<p>If only sustainable revenues are included in the model, then the federal dollars from the pandemic response (CARES, CRSSA,&amp; ARPA) should be excluded from the calculation of the fiscal gap.</p>
<p>The Fiscal Futures model focuses on sustainable revenue sources. To understand our fiscal gap and outlook, we need to exclude these one time revenues. GOMB has emphasized that they have allocated COVID dollars to one time expenditures (unemployment trust fund, budget stabilization fund, etc.). The fiscal gap, graphs,and CAGRs have been recalculated in the [Drop COVID Dollars] section below.</p>
<blockquote class="blockquote">
<p>NOTE: I have only dropped revenue with a source name = <code>Federal Stimulus Package</code>. Federal money went into other funds during the beginning of pandemic. All additional money for medicaid reimbursements and healthcare provider funds were not considered “Federal Stimulus Package” in the data and were not dropped.</p>
</blockquote>
<ul>
<li><p>fund 0628 is essential government support services. Money in the fund is appropriated to cover COVID-19 related expenses. It should be included in our analytical frame based on criteria 2 and6 — the fund supports an important state function about public safety, which would have to be performed even the fund structure were not existed. Public safety is supported by a combination of departments and boards, including IL Emergency Management Agency, which is the administering agency of the fund.</p></li>
<li><p>Education Stabilization Fund<br>
</p></li>
<li><p>ESSER 1, 2, and 3<br>
</p></li>
<li><p>CSLFRF (State and Local CURE)<br>
</p></li>
<li><p>Provider Relief Fund<br>
</p></li>
<li><p>Coronavirus Relief Fund (CRF)<br>
</p></li>
<li><p>Consolidated Appropriations Act 2020<br>
</p></li>
<li><p>Families First Coronavirus Response Act<br>
</p></li>
<li><p>Paycheck Protection Program and Health Care Enhancement Act</p></li>
</ul>
<p>Need to recreate ff_exp and ff_rev totals without stimulus dollars.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>ff_rev <span class="ot">&lt;-</span> rev_temp <span class="sc">%&gt;%</span>   </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rev_type_new =</span> <span class="fu">str_pad</span>(rev_type_new, <span class="dv">2</span>, <span class="st">"left"</span>, <span class="at">pad =</span> <span class="st">"0"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(rev_type_new, fy) <span class="sc">%&gt;%</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">sum_receipts =</span> <span class="fu">round</span>(<span class="fu">sum</span>(receipts, <span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">1000000</span> )) <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"rev_type_new"</span>, <span class="at">values_from =</span> <span class="st">"sum_receipts"</span>, <span class="at">names_prefix =</span> <span class="st">"rev_"</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>ff_rev <span class="ot">&lt;-</span> <span class="fu">mutate_all</span>(ff_rev, <span class="sc">~</span><span class="fu">replace_na</span>(.,<span class="dv">0</span>))</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>rev_long <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(ff_rev, rev_02<span class="sc">:</span>rev_78, <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"type"</span>,<span class="st">"Category"</span>), <span class="at">values_to =</span> <span class="st">"Dollars"</span>, <span class="at">names_sep =</span> <span class="st">"_"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Year =</span> fy) <span class="sc">%&gt;%</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Category_name =</span> <span class="fu">case_when</span>(</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"02"</span> <span class="sc">~</span> <span class="st">"INDIVIDUAL INCOME TAX"</span> ,</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"03"</span> <span class="sc">~</span> <span class="st">"CORPORATE INCOME TAX"</span> ,</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"06"</span> <span class="sc">~</span> <span class="st">"SALES TAX"</span> ,</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"09"</span> <span class="sc">~</span> <span class="st">"MOTOR FUEL TAX"</span> ,</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"12"</span> <span class="sc">~</span> <span class="st">"PUBLIC UTILITY TAX"</span> ,</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"15"</span> <span class="sc">~</span> <span class="st">"CIGARETTE TAXES"</span> ,</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"18"</span> <span class="sc">~</span> <span class="st">"LIQUOR GALLONAGE TAXES"</span> ,</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"21"</span> <span class="sc">~</span> <span class="st">"INHERITANCE TAX"</span> ,</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"24"</span> <span class="sc">~</span> <span class="st">"INSURANCE TAXES&amp;FEES&amp;LICENSES"</span> ,</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"27"</span> <span class="sc">~</span> <span class="st">"CORP FRANCHISE TAXES &amp; FEES"</span> ,</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"30"</span> <span class="sc">~</span> <span class="st">"HORSE RACING TAXES &amp; FEES"</span>,  <span class="co"># in Other</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"31"</span> <span class="sc">~</span> <span class="st">"MEDICAL PROVIDER ASSESSMENTS"</span> ,</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"32"</span> <span class="sc">~</span> <span class="st">"GARNISHMENT-LEVIES"</span> , <span class="co"># dropped</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"33"</span> <span class="sc">~</span>  <span class="st">"LOTTERY RECEIPTS"</span> ,</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"35"</span> <span class="sc">~</span>  <span class="st">"OTHER TAXES"</span> ,</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"36"</span> <span class="sc">~</span>  <span class="st">"RECEIPTS FROM REVENUE PRODUCING"</span>, </span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"39"</span> <span class="sc">~</span>  <span class="st">"LICENSES, FEES &amp; REGISTRATIONS"</span> ,</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"42"</span> <span class="sc">~</span>  <span class="st">"MOTOR VEHICLE AND OPERATORS"</span> ,</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"45"</span> <span class="sc">~</span>  <span class="st">"STUDENT FEES-UNIVERSITIES"</span>,   <span class="co"># dropped</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"48"</span> <span class="sc">~</span>  <span class="st">"RIVERBOAT WAGERING TAXES"</span> ,</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"51"</span> <span class="sc">~</span>  <span class="st">"RETIREMENT CONTRIBUTIONS"</span> , <span class="co"># dropped</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"54"</span> <span class="sc">~</span> <span class="st">"GIFTS AND BEQUESTS"</span>, </span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"57"</span> <span class="sc">~</span>  <span class="st">"FEDERAL OTHER"</span> ,</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"58"</span> <span class="sc">~</span>  <span class="st">"FEDERAL MEDICAID"</span>, </span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"59"</span> <span class="sc">~</span>  <span class="st">"FEDERAL TRANSPORTATION"</span> ,</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"60"</span> <span class="sc">~</span>  <span class="st">"OTHER GRANTS AND CONTRACTS"</span>, <span class="co">#other</span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"63"</span> <span class="sc">~</span>  <span class="st">"INVESTMENT INCOME"</span>, <span class="co"># other</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"66"</span> <span class="sc">~</span> <span class="st">"PROCEEDS,INVESTMENT MATURITIES"</span> , <span class="co">#dropped</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"72"</span> <span class="sc">~</span> <span class="st">"BOND ISSUE PROCEEDS"</span>,  <span class="co">#dropped</span></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"75"</span> <span class="sc">~</span>  <span class="st">"INTER-AGENCY RECEIPTS "</span>,  <span class="co">#dropped</span></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"76"</span> <span class="sc">~</span>  <span class="st">"TRANSFER IN FROM OUT FUNDS"</span>,  <span class="co">#other</span></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"78"</span> <span class="sc">~</span>  <span class="st">"ALL OTHER SOURCES"</span> ,</span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"79"</span> <span class="sc">~</span>   <span class="st">"COOK COUNTY IGT"</span>, <span class="co">#dropped</span></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"98"</span> <span class="sc">~</span>  <span class="st">"PRIOR YEAR REFUNDS"</span>, <span class="co">#dropped</span></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>                 T <span class="sc">~</span> <span class="st">"Check Me!"</span></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>  ) )<span class="sc">%&gt;%</span> </span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Category_name =</span> <span class="fu">str_to_title</span>(Category_name))</span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>exp_temp <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/all_expenditures_recoded.csv"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a><span class="co">#exp_temp &lt;- read.csv("data/exp_fy23_recoded_02April2024.csv") %&gt;% </span></span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a><span class="co">#exp_temp &lt;- read.csv("data/exp_temp.csv") %&gt;% </span></span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">agency =</span> <span class="fu">as.character</span>(agency),</span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>         <span class="at">object =</span> <span class="fu">as.character</span>(object),</span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>         <span class="at">object =</span> <span class="fu">str_pad</span>(object, <span class="at">side =</span> <span class="st">"left"</span>, <span class="dv">4</span>, <span class="at">pad =</span> <span class="st">"0"</span>),</span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>         <span class="at">obj_seq_type =</span> <span class="fu">as.character</span>(obj_seq_type),</span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a>         <span class="at">sequence =</span> <span class="fu">as.character</span>(sequence),</span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>         <span class="at">sequence =</span> <span class="fu">str_pad</span>(sequence, <span class="at">side =</span> <span class="st">"left"</span>, <span class="dv">2</span>, <span class="at">pad =</span> <span class="st">"0"</span>),</span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="fu">as.character</span>(type),</span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="fu">str_pad</span>(type, <span class="at">side =</span> <span class="st">"left"</span>, <span class="dv">2</span>, <span class="at">pad =</span> <span class="st">"0"</span>),</span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a>         <span class="at">appr_org =</span> <span class="fu">as.character</span>(appr_org),</span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a>         <span class="at">appr_org =</span> <span class="fu">str_pad</span>(appr_org, <span class="at">side =</span> <span class="st">"left"</span>, <span class="dv">2</span>, <span class="at">pad =</span> <span class="st">"0"</span>),</span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a>         <span class="at">fund =</span> <span class="fu">as.character</span>(fund),</span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a>         <span class="at">fund =</span> <span class="fu">str_pad</span>(fund, <span class="at">side =</span> <span class="st">"left"</span>, <span class="dv">4</span>, <span class="at">pad =</span> <span class="st">"0"</span>),</span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a>         <span class="at">group =</span> <span class="fu">as.character</span>(group))</span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a>exp_temp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(group_name <span class="sc">==</span> <span class="st">"Check name"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["fy"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["fund"],"name":[2],"type":["chr"],"align":["left"]},{"label":["fund_name"],"name":[3],"type":["chr"],"align":["left"]},{"label":["agency"],"name":[4],"type":["chr"],"align":["left"]},{"label":["agency_name"],"name":[5],"type":["chr"],"align":["left"]},{"label":["appr_org"],"name":[6],"type":["chr"],"align":["left"]},{"label":["org_name"],"name":[7],"type":["chr"],"align":["left"]},{"label":["obj_seq_type"],"name":[8],"type":["chr"],"align":["left"]},{"label":["wh_approp_name"],"name":[9],"type":["chr"],"align":["left"]},{"label":["appn_net_xfer"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["expenditure"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["data_source"],"name":[12],"type":["chr"],"align":["left"]},{"label":["fund_ab"],"name":[13],"type":["chr"],"align":["left"]},{"label":["fund_ioc"],"name":[14],"type":["chr"],"align":["left"]},{"label":["fund_re"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["a_end"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["in_ff"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["fund_name_ab"],"name":[18],"type":["chr"],"align":["left"]},{"label":["fund_category"],"name":[19],"type":["chr"],"align":["left"]},{"label":["fund_cat_name"],"name":[20],"type":["chr"],"align":["left"]},{"label":["transfer"],"name":[21],"type":["dbl"],"align":["right"]},{"label":["trans_agency"],"name":[22],"type":["lgl"],"align":["right"]},{"label":["trans_type"],"name":[23],"type":["lgl"],"align":["right"]},{"label":["object"],"name":[24],"type":["chr"],"align":["left"]},{"label":["sequence"],"name":[25],"type":["chr"],"align":["left"]},{"label":["type"],"name":[26],"type":["chr"],"align":["left"]},{"label":["refund"],"name":[27],"type":["chr"],"align":["left"]},{"label":["pension"],"name":[28],"type":["dbl"],"align":["right"]},{"label":["eehc"],"name":[29],"type":["dbl"],"align":["right"]},{"label":["group"],"name":[30],"type":["chr"],"align":["left"]},{"label":["group_name"],"name":[31],"type":["chr"],"align":["left"]},{"label":["year"],"name":[32],"type":["dbl"],"align":["right"]}],"data":[],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>exp_temp <span class="ot">&lt;-</span> <span class="fu">anti_join</span>(exp_temp, transfers_long)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>ff_exp <span class="ot">&lt;-</span> exp_temp <span class="sc">%&gt;%</span> </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fy, group) <span class="sc">%&gt;%</span> </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">sum_expenditures =</span> <span class="fu">round</span>(<span class="fu">sum</span>(expenditure, <span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">1000000</span> )) <span class="sc">%&gt;%</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"group"</span>, <span class="at">values_from =</span> <span class="st">"sum_expenditures"</span>, <span class="at">names_prefix =</span> <span class="st">"exp_"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(debt_keep_yearly) <span class="sc">%&gt;%</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">exp_903 =</span> debt_cost) <span class="sc">%&gt;%</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(transfers)  <span class="sc">%&gt;%</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a> <span class="fu">mutate</span>(<span class="at">exp_970 =</span> exp_971 <span class="sc">+</span> exp_972  <span class="sc">+</span> exp_975 <span class="sc">+</span> exp_976)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>ff_exp<span class="ot">&lt;-</span> ff_exp <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(debt_cost, exp_971<span class="sc">:</span>exp_976)) <span class="co"># drop unwanted columns</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>exp_long <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(ff_exp, exp_402<span class="sc">:</span>exp_970 , <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"type"</span>, <span class="st">"Category"</span>), <span class="at">values_to =</span> <span class="st">"Dollars"</span>, <span class="at">names_sep =</span> <span class="st">"_"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Year =</span> fy ) <span class="sc">%&gt;%</span> </span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Category_name =</span> </span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>           <span class="fu">case_when</span>(</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"402"</span> <span class="sc">~</span> <span class="st">"AGING"</span> ,</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"406"</span> <span class="sc">~</span> <span class="st">"AGRICULTURE"</span>, </span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"416"</span> <span class="sc">~</span> <span class="st">"CENTRAL MANAGEMENT"</span>,</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"418"</span> <span class="sc">~</span> <span class="st">"CHILDREN AND FAMILY SERVICES"</span>, </span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"420"</span> <span class="sc">~</span> <span class="st">"COMMERCE AND ECONOMIC OPPORTUNITY"</span>,</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"422"</span> <span class="sc">~</span> <span class="st">"NATURAL RESOURCES"</span> ,</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"426"</span> <span class="sc">~</span> <span class="st">"CORRECTIONS"</span>,</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"427"</span> <span class="sc">~</span> <span class="st">"EMPLOYMENT SECURITY"</span> ,</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"444"</span> <span class="sc">~</span> <span class="st">"HUMAN SERVICES"</span> ,</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"448"</span> <span class="sc">~</span> <span class="st">"Innovation and Technology"</span>, <span class="co"># AWM added fy2022</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"478"</span> <span class="sc">~</span> <span class="st">"HEALTHCARE &amp; FAM SER NET OF MEDICAID"</span>, </span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"482"</span> <span class="sc">~</span> <span class="st">"PUBLIC HEALTH"</span>, </span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"492"</span> <span class="sc">~</span> <span class="st">"REVENUE"</span>, </span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"494"</span> <span class="sc">~</span> <span class="st">"TRANSPORTATION"</span> ,</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"532"</span> <span class="sc">~</span> <span class="st">"ENVIRONMENTAL PROTECT AGENCY"</span> ,</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"557"</span> <span class="sc">~</span> <span class="st">"IL STATE TOLL HIGHWAY AUTH"</span> ,</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"684"</span> <span class="sc">~</span> <span class="st">"IL COMMUNITY COLLEGE BOARD"</span>, </span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"691"</span> <span class="sc">~</span> <span class="st">"IL STUDENT ASSISTANCE COMM"</span> ,</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"900"</span> <span class="sc">~</span> <span class="st">"NOT IN FRAME"</span>,</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"901"</span> <span class="sc">~</span> <span class="st">"STATE PENSION CONTRIBUTION"</span>,</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"903"</span> <span class="sc">~</span> <span class="st">"DEBT SERVICE"</span>,</span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"904"</span> <span class="sc">~</span> <span class="st">"State Employee Healthcare"</span>,</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"910"</span> <span class="sc">~</span> <span class="st">"LEGISLATIVE"</span>  ,</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"920"</span> <span class="sc">~</span> <span class="st">"JUDICIAL"</span> ,</span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"930"</span> <span class="sc">~</span> <span class="st">"ELECTED OFFICERS"</span> , </span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"940"</span> <span class="sc">~</span> <span class="st">"OTHER HEALTH-RELATED"</span>, </span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"941"</span> <span class="sc">~</span> <span class="st">"PUBLIC SAFETY"</span> ,</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"942"</span> <span class="sc">~</span> <span class="st">"ECON DEVT &amp; INFRASTRUCTURE"</span> ,</span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"943"</span> <span class="sc">~</span> <span class="st">"CENTRAL SERVICES"</span>,</span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"944"</span> <span class="sc">~</span> <span class="st">"BUS &amp; PROFESSION REGULATION"</span> ,</span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"945"</span> <span class="sc">~</span> <span class="st">"MEDICAID"</span> ,</span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"946"</span> <span class="sc">~</span> <span class="st">"CAPITAL IMPROVEMENT"</span> , </span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"948"</span> <span class="sc">~</span> <span class="st">"OTHER DEPARTMENTS"</span> ,</span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"949"</span> <span class="sc">~</span> <span class="st">"OTHER BOARDS &amp; COMMISSIONS"</span> ,</span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"959"</span> <span class="sc">~</span> <span class="st">"K-12 EDUCATION"</span> ,</span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"960"</span> <span class="sc">~</span> <span class="st">"UNIVERSITY EDUCATION"</span>,</span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"970"</span> <span class="sc">~</span> <span class="st">"Local Govt Transfers"</span>,</span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a>             T <span class="sc">~</span> <span class="st">"CHECK ME!"</span>)</span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a>           ) <span class="sc">%&gt;%</span> </span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Category_name =</span> <span class="fu">str_to_title</span>(Category_name))</span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a><span class="co">#exp_long_nototals &lt;- exp_long %&gt;% filter(Category_name != "Totals")</span></span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a>aggregated_totals_long <span class="ot">&lt;-</span> <span class="fu">rbind</span>(rev_long, exp_long) </span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a>year_totals <span class="ot">&lt;-</span> aggregated_totals_long <span class="sc">%&gt;%</span> </span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(type, Year) <span class="sc">%&gt;%</span> </span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Dollars =</span> <span class="fu">sum</span>(Dollars, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-74"><a href="#cb8-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"type"</span>, <span class="at">values_from =</span> Dollars) <span class="sc">%&gt;%</span> </span>
<span id="cb8-75"><a href="#cb8-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-76"><a href="#cb8-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Expenditures =</span> exp,</span>
<span id="cb8-77"><a href="#cb8-77" aria-hidden="true" tabindex="-1"></a>         <span class="at">Revenue =</span> rev) <span class="sc">%&gt;%</span>  </span>
<span id="cb8-78"><a href="#cb8-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Fiscal Gap</span><span class="st">`</span> <span class="ot">=</span> Revenue <span class="sc">-</span> Expenditures)</span>
<span id="cb8-79"><a href="#cb8-79" aria-hidden="true" tabindex="-1"></a><span class="co"># %&gt;%  arrange(desc(Year))</span></span>
<span id="cb8-80"><a href="#cb8-80" aria-hidden="true" tabindex="-1"></a><span class="co"># creates variable for the Gap each year</span></span>
<span id="cb8-81"><a href="#cb8-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-82"><a href="#cb8-82" aria-hidden="true" tabindex="-1"></a>year_totals  <span class="sc">%&gt;%</span>  </span>
<span id="cb8-83"><a href="#cb8-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_all</span>(., <span class="sc">~</span><span class="fu">round</span>(., <span class="at">digits =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb8-84"><a href="#cb8-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Fiscal Gap for each Fiscal Year ($ Millions)"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb8-85"><a href="#cb8-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>))  <span class="sc">%&gt;%</span></span>
<span id="cb8-86"><a href="#cb8-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>() <span class="sc">%&gt;%</span>   </span>
<span id="cb8-87"><a href="#cb8-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_footnote</span>(<span class="fu">c</span>(<span class="st">"Values include State CURE dollars (SLFRF)"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<table class="table table-striped lightable-classic table-sm small" data-quarto-postprocess="true">
<caption>Fiscal Gap for each Fiscal Year ($ Millions)</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">Year</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Expenditures</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Revenue</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Fiscal Gap</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1998</td>
<td style="text-align: right;">31243</td>
<td style="text-align: right;">32029</td>
<td style="text-align: right;">786</td>
</tr>
<tr class="even">
<td style="text-align: right;">1999</td>
<td style="text-align: right;">33844</td>
<td style="text-align: right;">33966</td>
<td style="text-align: right;">122</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2000</td>
<td style="text-align: right;">37342</td>
<td style="text-align: right;">37049</td>
<td style="text-align: right;">-293</td>
</tr>
<tr class="even">
<td style="text-align: right;">2001</td>
<td style="text-align: right;">40358</td>
<td style="text-align: right;">38289</td>
<td style="text-align: right;">-2069</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2002</td>
<td style="text-align: right;">42067</td>
<td style="text-align: right;">37923</td>
<td style="text-align: right;">-4144</td>
</tr>
<tr class="even">
<td style="text-align: right;">2003</td>
<td style="text-align: right;">42616</td>
<td style="text-align: right;">38452</td>
<td style="text-align: right;">-4164</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2004</td>
<td style="text-align: right;">53025</td>
<td style="text-align: right;">42612</td>
<td style="text-align: right;">-10413</td>
</tr>
<tr class="even">
<td style="text-align: right;">2005</td>
<td style="text-align: right;">45362</td>
<td style="text-align: right;">44305</td>
<td style="text-align: right;">-1057</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2006</td>
<td style="text-align: right;">48062</td>
<td style="text-align: right;">46168</td>
<td style="text-align: right;">-1894</td>
</tr>
<tr class="even">
<td style="text-align: right;">2007</td>
<td style="text-align: right;">51130</td>
<td style="text-align: right;">49493</td>
<td style="text-align: right;">-1637</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2008</td>
<td style="text-align: right;">54173</td>
<td style="text-align: right;">51645</td>
<td style="text-align: right;">-2528</td>
</tr>
<tr class="even">
<td style="text-align: right;">2009</td>
<td style="text-align: right;">56751</td>
<td style="text-align: right;">51467</td>
<td style="text-align: right;">-5284</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2010</td>
<td style="text-align: right;">59271</td>
<td style="text-align: right;">51197</td>
<td style="text-align: right;">-8074</td>
</tr>
<tr class="even">
<td style="text-align: right;">2011</td>
<td style="text-align: right;">60425</td>
<td style="text-align: right;">56303</td>
<td style="text-align: right;">-4122</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2012</td>
<td style="text-align: right;">59865</td>
<td style="text-align: right;">58423</td>
<td style="text-align: right;">-1442</td>
</tr>
<tr class="even">
<td style="text-align: right;">2013</td>
<td style="text-align: right;">63288</td>
<td style="text-align: right;">63102</td>
<td style="text-align: right;">-186</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">66963</td>
<td style="text-align: right;">65266</td>
<td style="text-align: right;">-1697</td>
</tr>
<tr class="even">
<td style="text-align: right;">2015</td>
<td style="text-align: right;">69940</td>
<td style="text-align: right;">66586</td>
<td style="text-align: right;">-3354</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2016</td>
<td style="text-align: right;">63935</td>
<td style="text-align: right;">64157</td>
<td style="text-align: right;">222</td>
</tr>
<tr class="even">
<td style="text-align: right;">2017</td>
<td style="text-align: right;">71727</td>
<td style="text-align: right;">63659</td>
<td style="text-align: right;">-8068</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2018</td>
<td style="text-align: right;">74972</td>
<td style="text-align: right;">73016</td>
<td style="text-align: right;">-1956</td>
</tr>
<tr class="even">
<td style="text-align: right;">2019</td>
<td style="text-align: right;">74406</td>
<td style="text-align: right;">74638</td>
<td style="text-align: right;">232</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2020</td>
<td style="text-align: right;">82250</td>
<td style="text-align: right;">80590</td>
<td style="text-align: right;">-1660</td>
</tr>
<tr class="even">
<td style="text-align: right;">2021</td>
<td style="text-align: right;">93630</td>
<td style="text-align: right;">95207</td>
<td style="text-align: right;">1577</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2022</td>
<td style="text-align: right;">100884</td>
<td style="text-align: right;">116059</td>
<td style="text-align: right;">15175</td>
</tr>
<tr class="even">
<td style="text-align: right;">2023</td>
<td style="text-align: right;">112863</td>
<td style="text-align: right;">111772</td>
<td style="text-align: right;">-1091</td>
</tr>
</tbody><tfoot>
<tr class="odd">
<td style="text-align: right; padding: 0; border: 0;"><sup>a</sup> Values include State CURE dollars (SLFRF)</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tfoot>

</table>


</div>
</div>
</div>
</section>
<section id="drop-state-cure-federal-stimulus-funds" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="drop-state-cure-federal-stimulus-funds"><span class="header-section-number">3.2</span> Drop State CURE Federal Stimulus Funds</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># does not include rev_type == 58, medicaid dollars</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>covid_dollars_rev <span class="ot">&lt;-</span> rev_temp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(covid_dollars<span class="sc">==</span><span class="dv">1</span>) <span class="co"># check what was dropped</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>covid_dollars_rev <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(fy, agency_name) <span class="sc">%&gt;%</span> </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">receipts =</span> <span class="fu">sum</span>(receipts)) <span class="sc">%&gt;%</span> </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from=</span><span class="st">"agency_name"</span>, <span class="at">values_from =</span> <span class="st">"receipts"</span>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="sc">-</span>fy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["fy"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["NA"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["CENTRAL MANAGEMENT"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["CHILDREN AND FAMILY SERVICES"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["COMMERCE AND ECONOMIC OPPORTUN"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["HEALTHCARE & FAMILY SERVICES"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["HUMAN SERVICES"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["PUBLIC HEALTH"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["STATE BOARD OF EDUCATION"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["TRANSPORTATION"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["IL EMERGENCY MANAGEMENT AGCY"],"name":[11],"type":["dbl"],"align":["right"]}],"data":[{"1":"2023","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"289673036"},{"1":"2022","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"8484659730"},{"1":"2021","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"228414389"},{"1":"2020","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"3518945366"},{"1":"2018","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"208583944","11":"NA"},{"1":"2017","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"404020588","11":"NA"},{"1":"2016","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"5016212","8":"5304788.73","9":"685742.8","10":"168539473","11":"NA"},{"1":"2015","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"4276779","8":"4249123.89","9":"11131669.4","10":"211161309","11":"NA"},{"1":"2014","2":"NA","3":"22193766","4":"5275","5":"2275824","6":"8614612","7":"1533865","8":"72536.71","9":"37941978.9","10":"180003423","11":"NA"},{"1":"2013","2":"302015766","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA"},{"1":"2012","2":"795620401","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA"},{"1":"2011","2":"3012164007","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA"},{"1":"2010","2":"3779185467","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA"},{"1":"2009","2":"2036402481","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>covid_dollars_rev <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(fy, fund_name_ab) <span class="sc">%&gt;%</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">receipts =</span> <span class="fu">sum</span>(receipts)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>fy) <span class="sc">%&gt;%</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from=</span><span class="st">"fy"</span>, <span class="at">values_from =</span> <span class="st">"receipts"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["fund_name_ab"],"name":[1],"type":["chr"],"align":["left"]},{"label":["2023"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["2022"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["2021"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["2020"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["2018"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["2017"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["2016"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["2015"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["2014"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["2013"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["2012"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["2011"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["2010"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["2009"],"name":[15],"type":["dbl"],"align":["right"]}],"data":[{"1":"STATE CURE","2":"289673036","3":"8484659730","4":"228414389","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"NA","14":"NA","15":"NA"},{"1":"DISASTER RESPONSE AND RECOVERY","2":"NA","3":"NA","4":"NA","5":"3518945366","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"NA","14":"NA","15":"NA"},{"1":"FEDERAL HIGH SPEED RAIL TRUST","2":"NA","3":"NA","4":"NA","5":"NA","6":"208583944","7":"403127809.5","8":"163977371.7","9":"203485637","10":"148952038.91","11":"110522248.6","12":"125802323.0","13":"74394250.74","14":"NA","15":"NA"},{"1":"ROAD","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"892778.9","8":"3529227.3","9":"3918839","10":"30354397.43","11":"57161853.1","12":"113143682.9","13":"265073161.65","14":"506879561","15":"48123949"},{"1":"EMPLOYMENT & TRAINING","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"5016212.2","9":"4276779","10":"NA","11":"161551.0","12":"387348.0","13":"178515024.00","14":"16464963","15":"NA"},{"1":"FEDERAL MASS TRANSIT TRUST","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"1032874.0","9":"3756834","10":"696987.00","11":"2802236.0","12":"5056450.0","13":"5079161.00","14":"6073705","15":"NA"},{"1":"PUBLIC HEALTH SERVICES","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"5304788.7","9":"4249124","10":"72536.71","11":"943576.7","12":"2902239.8","13":"2567966.36","14":"2187702","15":"NA"},{"1":"SBE FEDERAL DEPT OF EDUCATION","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"685742.8","9":"11131669","10":"37941978.87","11":"49181310.0","12":"209690411.1","13":"399453146.75","14":"387334211","15":"1648953"},{"1":"COMMUNICATIONS REVOLVING","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"21427510.42","11":"25230530.8","12":"12491050.6","13":"1975847.36","14":"NA","15":"NA"},{"1":"DCFS CHILDREN'S SERVICES","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"5275.00","11":"915.0","12":"3608375.0","13":"21894439.00","14":"12612725","15":"9315490"},{"1":"DHS SPECIAL PURPOSE TRUST","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"18357.00","11":"2750364.0","12":"1076977.0","13":"55594471.00","14":"33728887","15":"NA"},{"1":"ENERGY ADMINISTRATION","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"1257526.39","11":"17042166.8","12":"50696997.6","13":"127847944.02","14":"52312004","15":"NA"},{"1":"FEDERAL ENERGY","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"165432.48","11":"3419538.0","12":"56399936.7","13":"59660909.46","14":"17736718","15":"NA"},{"1":"FEDERAL WORKFORCE TRAINING","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"852865.03","11":"3444480.0","12":"20148626.3","13":"45964085.88","14":"91049216","15":"4296117"},{"1":"HEALTH INSURANCE RESERVE","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"766255.76","11":"NA","12":"NA","13":"819502.09","14":"NA","15":"NA"},{"1":"MEDICAL SPECIAL PURPOSE TRUST","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"8614612.00","11":"3281017.0","12":"1960821.0","13":"946311.00","14":"153594","15":"NA"},{"1":"USDA WOMEN  INFANTS & CHILDREN","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"1515508.00","11":"2371113.0","12":"286908.0","13":"191207.00","14":"128859","15":"421431"},{"1":"COM DEV&SMALL CITY BLK GRANT","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"309345.6","12":"5736559.4","13":"15117248.65","14":"7147382","15":"NA"},{"1":"CRIMINAL JUSTICE TRUST","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"316502.4","12":"1898975.4","13":"2552602.27","14":"2060151","15":"50198081"},{"1":"DEPT OF CORRECTIONS REIMBURSEM","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"1470269.6","12":"2433094.6","13":"1304204.86","14":"4993701","15":"396"},{"1":"US DPT OF ED JOBS PRG FED TRST","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"21606748.0","12":"114856717.0","13":"285058795.00","14":"NA","15":"NA"},{"1":"BROWNFIELDS REDEVELOPMENT","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"3655479.0","13":"1904184.00","14":"1842337","15":"NA"},{"1":"COMMUNITY DD SRVCS MEDICAID TR","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"197314.0","13":"9035961.00","14":"8766781","15":"508921"},{"1":"COMMUNITY MENTAL HEALTH MEDICA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"607271.0","13":"14155166.00","14":"23487666","15":"6677397"},{"1":"DRUG REBATE FUND","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"213.0","13":"48273296.00","14":"52738594","15":"27884398"},{"1":"EARLY INTERVENTION SERVICE REV","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"316915.0","13":"8960715.00","14":"17333074","15":"11793066"},{"1":"FEDERAL TITLE III SS & EMPLOY","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"172960.5","13":"14401368.17","14":"19999299","15":"3187913"},{"1":"FEDERAL&LOCAL AIRPORT","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"415754.0","13":"13515740.16","14":"17175150","15":"NA"},{"1":"GENERAL REVENUE","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"39890136.0","13":"581410451.00","14":"1606696745","15":"1565690437"},{"1":"HEALTH&HUMAN SERV MEDICAID TR","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"386.0","13":"4595092.00","14":"NA","15":"NA"},{"1":"HEALTHCARE PROVIDER RELIEF","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"7741489.0","13":"197311779.00","14":"187647884","15":"NA"},{"1":"PUBLIC AID RECOVERIES TRUST","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"9088.0","13":"3695608.00","14":"NA","15":"8425"},{"1":"SPECIAL ED MEDICAID MATCHING","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"1593891.0","13":"14129228.00","14":"NA","15":"4495426"},{"1":"U S ENVIRONMENTAL PROTECTION","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"331864.0","13":"4262253.00","14":"2999656","15":"NA"},{"1":"UNIVERSITY OF IL HOSPITAL SERV","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"506465.0","13":"24199518.00","14":"40429924","15":"NA"},{"1":"VOCATIONAL REHABILITATION","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"11519034.0","13":"8850535.00","14":"1692141","15":"NA"},{"1":"WATER REVOLVING","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"84648.0","13":"115707915.00","14":"140988537","15":"NA"},{"1":"CARE PROV FOR PERSONS WITH DD","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"3421470.00","14":"6419061","15":"3770362"},{"1":"CHILD SUPPORT ADMINISTRATIVE","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"22674927.00","14":"36071720","15":"3139983"},{"1":"COMMUNITY SERVICES BLOCK GRANT","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"18072656.97","14":"27985959","15":"NA"},{"1":"COUNTY PROVIDER TRUST","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"25771097.00","14":"57792998","15":"221724"},{"1":"FEDERAL NATNL COMM SERVICES","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"479884.00","14":"2217411","15":"NA"},{"1":"HOSPITAL PROVIDER","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"221129358.00","14":"223161028","15":"161245945"},{"1":"INDEPENDENT ACADEMIC MEDICAL C","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"234200.00","14":"468400","15":"NA"},{"1":"LONG TERM CARE PROVIDER","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"65991557.00","14":"88523957","15":"58293794"},{"1":"MEDICAL RESEARCH & DEVELOPMENT","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"1498879.00","14":"1504320","15":"995840"},{"1":"POST-TERTIARY CLINICAL SERVICE","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"1498880.00","14":"1504320","15":"995840"},{"1":"SBE FEDERAL DEPT OF AGRI","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"23328.71","14":"3630633","15":"NA"},{"1":"SERVICES FOR OLDER AMERICANS","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"521506.95","14":"4172646","15":"NA"},{"1":"TOBACCO SETTLEMENT RECOVERY","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"41384219.00","14":"61529241","15":"72626001"},{"1":"TRAUMA CENTER","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"1042956.00","14":"1103852","15":"833428"},{"1":"AGRICULTURE FEDERAL PROJECTS","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"NA","14":"77155","15":"NA"},{"1":"IL ARTS COUNCIL FEDERAL GRANT","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"NA","14":"361600","15":"NA"},{"1":"JUVENILE REHAB SERV MEDICAID","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"NA","14":"NA","15":"29164"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>K12_ESSER_words <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"CRRSA"</span>,<span class="st">"ESSER"</span>,<span class="st">"EMER R"</span>, <span class="st">"EMR R"</span>, <span class="st">"CARES"</span>, <span class="st">"AMER R"</span>, <span class="st">"EMER ED"</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>ESSER_exp <span class="ot">&lt;-</span> exp_temp <span class="sc">%&gt;%</span> </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(agency_name <span class="sc">==</span> <span class="st">"STATE BOARD OF EDUCATION"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ESSERfunds =</span> <span class="fu">case_when</span>(</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(wh_approp_name, <span class="st">"CRRSA"</span>) <span class="sc">~</span> <span class="st">"ESSER"</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(wh_approp_name, <span class="st">"ESSER"</span>) <span class="sc">~</span> <span class="st">"ESSER"</span>,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(wh_approp_name, <span class="st">"EMER R"</span>) <span class="sc">~</span> <span class="st">"ESSER"</span>,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(wh_approp_name, <span class="st">"EMR R"</span>) <span class="sc">~</span> <span class="st">"ESSER"</span>,</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(wh_approp_name, <span class="st">"CARES"</span>) <span class="sc">~</span> <span class="st">"ESSER"</span>,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(wh_approp_name, <span class="st">"AMER R"</span>) <span class="sc">~</span> <span class="st">"ESSER"</span>,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(wh_approp_name, <span class="st">"EMER ED"</span>) <span class="sc">~</span> <span class="st">"ESSER"</span>,</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">'not_esser'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ESSERfunds <span class="sc">==</span> <span class="st">"ESSER"</span>)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>ESSER_exp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["fy"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["fund"],"name":[2],"type":["chr"],"align":["left"]},{"label":["fund_name"],"name":[3],"type":["chr"],"align":["left"]},{"label":["agency"],"name":[4],"type":["chr"],"align":["left"]},{"label":["agency_name"],"name":[5],"type":["chr"],"align":["left"]},{"label":["appr_org"],"name":[6],"type":["chr"],"align":["left"]},{"label":["org_name"],"name":[7],"type":["chr"],"align":["left"]},{"label":["obj_seq_type"],"name":[8],"type":["chr"],"align":["left"]},{"label":["wh_approp_name"],"name":[9],"type":["chr"],"align":["left"]},{"label":["appn_net_xfer"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["expenditure"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["data_source"],"name":[12],"type":["chr"],"align":["left"]},{"label":["fund_ab"],"name":[13],"type":["chr"],"align":["left"]},{"label":["fund_ioc"],"name":[14],"type":["chr"],"align":["left"]},{"label":["fund_re"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["a_end"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["in_ff"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["fund_name_ab"],"name":[18],"type":["chr"],"align":["left"]},{"label":["fund_category"],"name":[19],"type":["chr"],"align":["left"]},{"label":["fund_cat_name"],"name":[20],"type":["chr"],"align":["left"]},{"label":["transfer"],"name":[21],"type":["dbl"],"align":["right"]},{"label":["trans_agency"],"name":[22],"type":["lgl"],"align":["right"]},{"label":["trans_type"],"name":[23],"type":["lgl"],"align":["right"]},{"label":["object"],"name":[24],"type":["chr"],"align":["left"]},{"label":["sequence"],"name":[25],"type":["chr"],"align":["left"]},{"label":["type"],"name":[26],"type":["chr"],"align":["left"]},{"label":["refund"],"name":[27],"type":["chr"],"align":["left"]},{"label":["pension"],"name":[28],"type":["dbl"],"align":["right"]},{"label":["eehc"],"name":[29],"type":["dbl"],"align":["right"]},{"label":["group"],"name":[30],"type":["chr"],"align":["left"]},{"label":["group_name"],"name":[31],"type":["chr"],"align":["left"]},{"label":["year"],"name":[32],"type":["dbl"],"align":["right"]},{"label":["ESSERfunds"],"name":[33],"type":["chr"],"align":["left"]}],"data":[{"1":"2020","2":"0561","3":"SBE FEDERAL DEPT OF EDUCATION","4":"586","5":"STATE BOARD OF EDUCATION","6":"14","7":"GRANTS","8":"49000005","9":"ELEM & SCNDRY SCHOOL EMER RELF","10":"569500000","11":"0","12":"exp ioc 03.11.2020","13":"0561","14":"0561","15":"0","16":"NA","17":"1","18":"SBE FEDERAL DEPT OF EDUCATION","19":"G","20":"Federal Trust Funds","21":"0","22":"NA","23":"NA","24":"4900","25":"00","26":"05","27":"not refund","28":"0","29":"1","30":"959","31":"K-12 EDUCATION","32":"2020","33":"ESSER"},{"1":"2020","2":"0561","3":"SBE FEDERAL DEPT OF EDUCATION","4":"586","5":"STATE BOARD OF EDUCATION","6":"14","7":"GRANTS","8":"49000055","9":"ELEM & SECND EDU EMER RELIEF","10":"569500000","11":"127697867","12":"exp ioc 03.11.2020","13":"0561","14":"0561","15":"0","16":"NA","17":"1","18":"SBE FEDERAL DEPT OF EDUCATION","19":"G","20":"Federal Trust Funds","21":"0","22":"NA","23":"NA","24":"4900","25":"00","26":"55","27":"not refund","28":"0","29":"1","30":"959","31":"K-12 EDUCATION","32":"2020","33":"ESSER"},{"1":"2021","2":"0561","3":"SBE FEDERAL DEPT OF EDUCATION","4":"586","5":"STATE BOARD OF EDUCATION","6":"14","7":"GRANTS","8":"49000655","9":"AMER RESC ACT HOMELESS CHILDRN","10":"8278217","11":"0","12":"NA","13":"0561","14":"0561","15":"0","16":"NA","17":"1","18":"SBE FEDERAL DEPT OF EDUCATION","19":"G","20":"Federal Trust Funds","21":"0","22":"NA","23":"NA","24":"4900","25":"06","26":"55","27":"not refund","28":"0","29":"1","30":"959","31":"K-12 EDUCATION","32":"2021","33":"ESSER"},{"1":"2021","2":"0561","3":"SBE FEDERAL DEPT OF EDUCATION","4":"586","5":"STATE BOARD OF EDUCATION","6":"14","7":"GRANTS","8":"49000020","9":"ELEM & SECNDRY EMER RLF FND","10":"569500000","11":"375936024","12":"NA","13":"0561","14":"0561","15":"0","16":"NA","17":"1","18":"SBE FEDERAL DEPT OF EDUCATION","19":"G","20":"Federal Trust Funds","21":"0","22":"NA","23":"NA","24":"4900","25":"00","26":"20","27":"not refund","28":"0","29":"1","30":"959","31":"K-12 EDUCATION","32":"2021","33":"ESSER"},{"1":"2021","2":"0561","3":"SBE FEDERAL DEPT OF EDUCATION","4":"586","5":"STATE BOARD OF EDUCATION","6":"14","7":"GRANTS","8":"49000205","9":"FED CRRSA 2021 GRANTS","10":"2250805000","11":"0","12":"NA","13":"0561","14":"0561","15":"0","16":"NA","17":"1","18":"SBE FEDERAL DEPT OF EDUCATION","19":"G","20":"Federal Trust Funds","21":"0","22":"NA","23":"NA","24":"4900","25":"02","26":"05","27":"not refund","28":"0","29":"1","30":"959","31":"K-12 EDUCATION","32":"2021","33":"ESSER"},{"1":"2021","2":"0561","3":"SBE FEDERAL DEPT OF EDUCATION","4":"586","5":"STATE BOARD OF EDUCATION","6":"14","7":"GRANTS","8":"49000555","9":"AMER RESCUE ELEM & SEC RELIEF","10":"3370000000","11":"0","12":"NA","13":"0561","14":"0561","15":"0","16":"NA","17":"1","18":"SBE FEDERAL DEPT OF EDUCATION","19":"G","20":"Federal Trust Funds","21":"0","22":"NA","23":"NA","24":"4900","25":"05","26":"55","27":"not refund","28":"0","29":"1","30":"959","31":"K-12 EDUCATION","32":"2021","33":"ESSER"},{"1":"2021","2":"0561","3":"SBE FEDERAL DEPT OF EDUCATION","4":"586","5":"STATE BOARD OF EDUCATION","6":"14","7":"GRANTS","8":"49000455","9":"CRRSA ACT","10":"84490000","11":"0","12":"NA","13":"0561","14":"0561","15":"0","16":"NA","17":"1","18":"SBE FEDERAL DEPT OF EDUCATION","19":"G","20":"Federal Trust Funds","21":"0","22":"NA","23":"NA","24":"4900","25":"04","26":"55","27":"not refund","28":"0","29":"1","30":"959","31":"K-12 EDUCATION","32":"2021","33":"ESSER"},{"1":"2021","2":"0561","3":"SBE FEDERAL DEPT OF EDUCATION","4":"586","5":"STATE BOARD OF EDUCATION","6":"14","7":"GRANTS","8":"49000305","9":"FED CRRSA 2021 GRANTS","10":"132400000","11":"0","12":"NA","13":"0561","14":"0561","15":"0","16":"NA","17":"1","18":"SBE FEDERAL DEPT OF EDUCATION","19":"G","20":"Federal Trust Funds","21":"0","22":"NA","23":"NA","24":"4900","25":"03","26":"05","27":"not refund","28":"0","29":"1","30":"959","31":"K-12 EDUCATION","32":"2021","33":"ESSER"},{"1":"2021","2":"0561","3":"SBE FEDERAL DEPT OF EDUCATION","4":"586","5":"STATE BOARD OF EDUCATION","6":"14","7":"GRANTS","8":"49000255","9":"ELEM & SECNDRY EMER RLF FND II","10":"2250805000","11":"583562393","12":"NA","13":"0561","14":"0561","15":"0","16":"NA","17":"1","18":"SBE FEDERAL DEPT OF EDUCATION","19":"G","20":"Federal Trust Funds","21":"0","22":"NA","23":"NA","24":"4900","25":"02","26":"55","27":"not refund","28":"0","29":"1","30":"959","31":"K-12 EDUCATION","32":"2021","33":"ESSER"},{"1":"2021","2":"0561","3":"SBE FEDERAL DEPT OF EDUCATION","4":"586","5":"STATE BOARD OF EDUCATION","6":"14","7":"GRANTS","8":"49000120","9":"GOV EMER ED RLF FND","10":"108500000","11":"41796237","12":"NA","13":"0561","14":"0561","15":"0","16":"NA","17":"1","18":"SBE FEDERAL DEPT OF EDUCATION","19":"G","20":"Federal Trust Funds","21":"0","22":"NA","23":"NA","24":"4900","25":"01","26":"20","27":"not refund","28":"0","29":"1","30":"959","31":"K-12 EDUCATION","32":"2021","33":"ESSER"},{"1":"2021","2":"0561","3":"SBE FEDERAL DEPT OF EDUCATION","4":"586","5":"STATE BOARD OF EDUCATION","6":"14","7":"GRANTS","8":"49000505","9":"FED ESSER GRANTS","10":"5054990000","11":"0","12":"NA","13":"0561","14":"0561","15":"0","16":"NA","17":"1","18":"SBE FEDERAL DEPT OF EDUCATION","19":"G","20":"Federal Trust Funds","21":"0","22":"NA","23":"NA","24":"4900","25":"05","26":"05","27":"not refund","28":"0","29":"1","30":"959","31":"K-12 EDUCATION","32":"2021","33":"ESSER"},{"1":"2021","2":"0561","3":"SBE FEDERAL DEPT OF EDUCATION","4":"586","5":"STATE BOARD OF EDUCATION","6":"14","7":"GRANTS","8":"49000355","9":"CRRSA ACT","10":"47905000","11":"0","12":"NA","13":"0561","14":"0561","15":"0","16":"NA","17":"1","18":"SBE FEDERAL DEPT OF EDUCATION","19":"G","20":"Federal Trust Funds","21":"0","22":"NA","23":"NA","24":"4900","25":"03","26":"55","27":"not refund","28":"0","29":"1","30":"959","31":"K-12 EDUCATION","32":"2021","33":"ESSER"},{"1":"2021","2":"0561","3":"SBE FEDERAL DEPT OF EDUCATION","4":"586","5":"STATE BOARD OF EDUCATION","6":"14","7":"GRANTS","8":"49000405","9":"FED CRRSA 2021 GRANTS","10":"84490000","11":"0","12":"NA","13":"0561","14":"0561","15":"0","16":"NA","17":"1","18":"SBE FEDERAL DEPT OF EDUCATION","19":"G","20":"Federal Trust Funds","21":"0","22":"NA","23":"NA","24":"4900","25":"04","26":"05","27":"not refund","28":"0","29":"1","30":"959","31":"K-12 EDUCATION","32":"2021","33":"ESSER"},{"1":"2022","2":"0561","3":"SBE FEDERAL DEPT OF EDUCATION","4":"586","5":"STATE BOARD OF EDUCATION","6":"14","7":"GRANTS","8":"4.9e+07","9":"CARES ACT EXPENSES","10":"475411400","11":"48893460","12":"exp_ioc_22.08.01","13":"0561","14":"0561","15":"0","16":"NA","17":"1","18":"SBE FEDERAL DEPT OF EDUCATION","19":"G","20":"Federal Trust Funds","21":"0","22":"NA","23":"NA","24":"4900","25":"00","26":"00","27":"not refund","28":"0","29":"1","30":"959","31":"K-12 EDUCATION","32":"2022","33":"ESSER"},{"1":"2022","2":"0561","3":"SBE FEDERAL DEPT OF EDUCATION","4":"586","5":"STATE BOARD OF EDUCATION","6":"14","7":"GRANTS","8":"49000100","9":"CARES ACT EXPENSES","10":"107508400","11":"8276348","12":"exp_ioc_22.08.01","13":"0561","14":"0561","15":"0","16":"NA","17":"1","18":"SBE FEDERAL DEPT OF EDUCATION","19":"G","20":"Federal Trust Funds","21":"0","22":"NA","23":"NA","24":"4900","25":"01","26":"00","27":"not refund","28":"0","29":"1","30":"959","31":"K-12 EDUCATION","32":"2022","33":"ESSER"},{"1":"2022","2":"0561","3":"SBE FEDERAL DEPT OF EDUCATION","4":"586","5":"STATE BOARD OF EDUCATION","6":"14","7":"GRANTS","8":"49000200","9":"CRRSA SCHOOL EMER RELIEF","10":"2250805000","11":"991849882","12":"exp_ioc_22.08.01","13":"0561","14":"0561","15":"0","16":"NA","17":"1","18":"SBE FEDERAL DEPT OF EDUCATION","19":"G","20":"Federal Trust Funds","21":"0","22":"NA","23":"NA","24":"4900","25":"02","26":"00","27":"not refund","28":"0","29":"1","30":"959","31":"K-12 EDUCATION","32":"2022","33":"ESSER"},{"1":"2022","2":"0561","3":"SBE FEDERAL DEPT OF EDUCATION","4":"586","5":"STATE BOARD OF EDUCATION","6":"14","7":"GRANTS","8":"49000300","9":"CRRSA GOVNR EMER EDUCTN RELIEF","10":"47905000","11":"8504268","12":"exp_ioc_22.08.01","13":"0561","14":"0561","15":"0","16":"NA","17":"1","18":"SBE FEDERAL DEPT OF EDUCATION","19":"G","20":"Federal Trust Funds","21":"0","22":"NA","23":"NA","24":"4900","25":"03","26":"00","27":"not refund","28":"0","29":"1","30":"959","31":"K-12 EDUCATION","32":"2022","33":"ESSER"},{"1":"2022","2":"0561","3":"SBE FEDERAL DEPT OF EDUCATION","4":"586","5":"STATE BOARD OF EDUCATION","6":"14","7":"GRANTS","8":"49000400","9":"CRRSA EMERGENCY ASSISTANCE","10":"84490000","11":"27131359","12":"exp_ioc_22.08.01","13":"0561","14":"0561","15":"0","16":"NA","17":"1","18":"SBE FEDERAL DEPT OF EDUCATION","19":"G","20":"Federal Trust Funds","21":"0","22":"NA","23":"NA","24":"4900","25":"04","26":"00","27":"not refund","28":"0","29":"1","30":"959","31":"K-12 EDUCATION","32":"2022","33":"ESSER"},{"1":"2022","2":"0561","3":"SBE FEDERAL DEPT OF EDUCATION","4":"586","5":"STATE BOARD OF EDUCATION","6":"14","7":"GRANTS","8":"49000500","9":"AMER RESCUE PLAN EMER RELIEF","10":"5054990000","11":"645259538","12":"exp_ioc_22.08.01","13":"0561","14":"0561","15":"0","16":"NA","17":"1","18":"SBE FEDERAL DEPT OF EDUCATION","19":"G","20":"Federal Trust Funds","21":"0","22":"NA","23":"NA","24":"4900","25":"05","26":"00","27":"not refund","28":"0","29":"1","30":"959","31":"K-12 EDUCATION","32":"2022","33":"ESSER"},{"1":"2022","2":"0561","3":"SBE FEDERAL DEPT OF EDUCATION","4":"586","5":"STATE BOARD OF EDUCATION","6":"14","7":"GRANTS","8":"49000600","9":"AMER RSCUE PLN HOMELESS YOUTH","10":"33115000","11":"2757402","12":"exp_ioc_22.08.01","13":"0561","14":"0561","15":"0","16":"NA","17":"1","18":"SBE FEDERAL DEPT OF EDUCATION","19":"G","20":"Federal Trust Funds","21":"0","22":"NA","23":"NA","24":"4900","25":"06","26":"00","27":"not refund","28":"0","29":"1","30":"959","31":"K-12 EDUCATION","32":"2022","33":"ESSER"},{"1":"2022","2":"0561","3":"SBE FEDERAL DEPT OF EDUCATION","4":"586","5":"STATE BOARD OF EDUCATION","6":"14","7":"GRANTS","8":"49000700","9":"AMER RSCUE PLN NON-PUBLIC SCHL","10":"83246400","11":"0","12":"exp_ioc_22.08.01","13":"0561","14":"0561","15":"0","16":"NA","17":"1","18":"SBE FEDERAL DEPT OF EDUCATION","19":"G","20":"Federal Trust Funds","21":"0","22":"NA","23":"NA","24":"4900","25":"07","26":"00","27":"not refund","28":"0","29":"1","30":"959","31":"K-12 EDUCATION","32":"2022","33":"ESSER"},{"1":"2023","2":"0561","3":"SBE FEDERAL DEPT OF EDUCATION","4":"586","5":"STATE BOARD OF EDUCATION","6":"14","7":"GRANTS","8":"4.9e+07","9":"CARES ACT EXPENSES","10":"41543000","11":"12748984","12":"exp IOC 011.14.2023","13":"0561","14":"0561","15":"0","16":"NA","17":"1","18":"SBE FEDERAL DEPT OF EDUCATION","19":"G","20":"Federal Trust Funds","21":"0","22":"NA","23":"NA","24":"4900","25":"00","26":"00","27":"not refund","28":"0","29":"1","30":"959","31":"K-12 EDUCATION","32":"2023","33":"ESSER"},{"1":"2023","2":"0561","3":"SBE FEDERAL DEPT OF EDUCATION","4":"586","5":"STATE BOARD OF EDUCATION","6":"14","7":"GRANTS","8":"49000100","9":"CARES ACT EXPENSES","10":"24120500","11":"1293522","12":"exp IOC 011.14.2023","13":"0561","14":"0561","15":"0","16":"NA","17":"1","18":"SBE FEDERAL DEPT OF EDUCATION","19":"G","20":"Federal Trust Funds","21":"0","22":"NA","23":"NA","24":"4900","25":"01","26":"00","27":"not refund","28":"0","29":"1","30":"959","31":"K-12 EDUCATION","32":"2023","33":"ESSER"},{"1":"2023","2":"0561","3":"SBE FEDERAL DEPT OF EDUCATION","4":"586","5":"STATE BOARD OF EDUCATION","6":"14","7":"GRANTS","8":"49000200","9":"CRRSA SCHOOL EMER RELIEF","10":"1162038900","11":"419495444","12":"exp IOC 011.14.2023","13":"0561","14":"0561","15":"0","16":"NA","17":"1","18":"SBE FEDERAL DEPT OF EDUCATION","19":"G","20":"Federal Trust Funds","21":"0","22":"NA","23":"NA","24":"4900","25":"02","26":"00","27":"not refund","28":"0","29":"1","30":"959","31":"K-12 EDUCATION","32":"2023","33":"ESSER"},{"1":"2023","2":"0561","3":"SBE FEDERAL DEPT OF EDUCATION","4":"586","5":"STATE BOARD OF EDUCATION","6":"14","7":"GRANTS","8":"49000300","9":"CRRSA GOVNR EMER EDUCTN RELIEF","10":"46365500","11":"10635709","12":"exp IOC 011.14.2023","13":"0561","14":"0561","15":"0","16":"NA","17":"1","18":"SBE FEDERAL DEPT OF EDUCATION","19":"G","20":"Federal Trust Funds","21":"0","22":"NA","23":"NA","24":"4900","25":"03","26":"00","27":"not refund","28":"0","29":"1","30":"959","31":"K-12 EDUCATION","32":"2023","33":"ESSER"},{"1":"2023","2":"0561","3":"SBE FEDERAL DEPT OF EDUCATION","4":"586","5":"STATE BOARD OF EDUCATION","6":"14","7":"GRANTS","8":"49000400","9":"CRRSA EMERGENCY ASSISTANCE","10":"73414900","11":"43276831","12":"exp IOC 011.14.2023","13":"0561","14":"0561","15":"0","16":"NA","17":"1","18":"SBE FEDERAL DEPT OF EDUCATION","19":"G","20":"Federal Trust Funds","21":"0","22":"NA","23":"NA","24":"4900","25":"04","26":"00","27":"not refund","28":"0","29":"1","30":"959","31":"K-12 EDUCATION","32":"2023","33":"ESSER"},{"1":"2023","2":"0561","3":"SBE FEDERAL DEPT OF EDUCATION","4":"586","5":"STATE BOARD OF EDUCATION","6":"14","7":"GRANTS","8":"49000500","9":"AMER RESCUE PLAN EMER RELIEF","10":"5011807800","11":"1694197637","12":"exp IOC 011.14.2023","13":"0561","14":"0561","15":"0","16":"NA","17":"1","18":"SBE FEDERAL DEPT OF EDUCATION","19":"G","20":"Federal Trust Funds","21":"0","22":"NA","23":"NA","24":"4900","25":"05","26":"00","27":"not refund","28":"0","29":"1","30":"959","31":"K-12 EDUCATION","32":"2023","33":"ESSER"},{"1":"2023","2":"0561","3":"SBE FEDERAL DEPT OF EDUCATION","4":"586","5":"STATE BOARD OF EDUCATION","6":"14","7":"GRANTS","8":"49000600","9":"AMER RSCUE PLN HOMELESS YOUTH","10":"33118500","11":"12573739","12":"exp IOC 011.14.2023","13":"0561","14":"0561","15":"0","16":"NA","17":"1","18":"SBE FEDERAL DEPT OF EDUCATION","19":"G","20":"Federal Trust Funds","21":"0","22":"NA","23":"NA","24":"4900","25":"06","26":"00","27":"not refund","28":"0","29":"1","30":"959","31":"K-12 EDUCATION","32":"2023","33":"ESSER"},{"1":"2023","2":"0561","3":"SBE FEDERAL DEPT OF EDUCATION","4":"586","5":"STATE BOARD OF EDUCATION","6":"14","7":"GRANTS","8":"49000700","9":"AMER RSCUE PLN NON-PUBLIC SCHL","10":"83246400","11":"10543841","12":"exp IOC 011.14.2023","13":"0561","14":"0561","15":"0","16":"NA","17":"1","18":"SBE FEDERAL DEPT OF EDUCATION","19":"G","20":"Federal Trust Funds","21":"0","22":"NA","23":"NA","24":"4900","25":"07","26":"00","27":"not refund","28":"0","29":"1","30":"959","31":"K-12 EDUCATION","32":"2023","33":"ESSER"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#dropped_inff_0 &lt;- exp_temp %&gt;% filter(in_ff == 0)</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co">#exp_temp &lt;- exp_temp %&gt;% filter(in_ff == 1) # drops in_ff = 0 funds AFTER dealing with net-revenue above</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>rev_temp <span class="ot">&lt;-</span> rev_temp <span class="sc">%&gt;%</span>  <span class="fu">filter</span>(covid_dollars<span class="sc">==</span><span class="dv">0</span>) <span class="co"># keeps observations that were not coded as COVID federal funds</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>ff_rev <span class="ot">&lt;-</span> rev_temp <span class="sc">%&gt;%</span>   </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rev_type_new =</span> <span class="fu">str_pad</span>(rev_type_new, <span class="dv">2</span>, <span class="st">"left"</span>, <span class="at">pad =</span> <span class="st">"0"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(rev_type_new, fy) <span class="sc">%&gt;%</span> </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">sum_receipts =</span> <span class="fu">round</span>(<span class="fu">sum</span>(receipts, <span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">1000000</span> )) <span class="sc">%&gt;%</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"rev_type_new"</span>, <span class="at">values_from =</span> <span class="st">"sum_receipts"</span>, <span class="at">names_prefix =</span> <span class="st">"rev_"</span>)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co"># ff_rev&lt;- left_join(ff_rev, tax_refund)</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>ff_rev <span class="ot">&lt;-</span> <span class="fu">mutate_all</span>(ff_rev, <span class="sc">~</span><span class="fu">replace_na</span>(.,<span class="dv">0</span>))</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="co"># ff_rev &lt;- ff_rev %&gt;%</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-c(# ref_02:ref_35, </span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="co">#           ref_CHECK</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="co">#             ))</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>rev_long <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(ff_rev, rev_02<span class="sc">:</span>rev_78, <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"type"</span>,<span class="st">"Category"</span>), <span class="at">values_to =</span> <span class="st">"Dollars"</span>, <span class="at">names_sep =</span> <span class="st">"_"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Year =</span> fy) <span class="sc">%&gt;%</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Category_name =</span> <span class="fu">case_when</span>(</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"02"</span> <span class="sc">~</span> <span class="st">"INDIVIDUAL INCOME TAX"</span> ,</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"03"</span> <span class="sc">~</span> <span class="st">"CORPORATE INCOME TAX"</span> ,</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"06"</span> <span class="sc">~</span> <span class="st">"SALES TAX"</span> ,</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"09"</span> <span class="sc">~</span> <span class="st">"MOTOR FUEL TAX"</span> ,</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"12"</span> <span class="sc">~</span> <span class="st">"PUBLIC UTILITY TAX"</span> ,</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"15"</span> <span class="sc">~</span> <span class="st">"CIGARETTE TAXES"</span> ,</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"18"</span> <span class="sc">~</span> <span class="st">"LIQUOR GALLONAGE TAXES"</span> ,</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"21"</span> <span class="sc">~</span> <span class="st">"INHERITANCE TAX"</span> ,</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"24"</span> <span class="sc">~</span> <span class="st">"INSURANCE TAXES&amp;FEES&amp;LICENSES"</span> ,</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"27"</span> <span class="sc">~</span> <span class="st">"CORP FRANCHISE TAXES &amp; FEES"</span> ,</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"30"</span> <span class="sc">~</span> <span class="st">"HORSE RACING TAXES &amp; FEES"</span>,  <span class="co"># in Other</span></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"31"</span> <span class="sc">~</span> <span class="st">"MEDICAL PROVIDER ASSESSMENTS"</span> ,</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"32"</span> <span class="sc">~</span> <span class="st">"GARNISHMENT-LEVIES"</span> , <span class="co"># dropped</span></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"33"</span> <span class="sc">~</span>  <span class="st">"LOTTERY RECEIPTS"</span> ,</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"35"</span> <span class="sc">~</span>  <span class="st">"OTHER TAXES"</span> ,</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"36"</span> <span class="sc">~</span>  <span class="st">"RECEIPTS FROM REVENUE PRODUCING"</span>, </span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"39"</span> <span class="sc">~</span>  <span class="st">"LICENSES, FEES &amp; REGISTRATIONS"</span> ,</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"42"</span> <span class="sc">~</span>  <span class="st">"MOTOR VEHICLE AND OPERATORS"</span> ,</span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"45"</span> <span class="sc">~</span>  <span class="st">"STUDENT FEES-UNIVERSITIES"</span>,   <span class="co"># dropped</span></span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"48"</span> <span class="sc">~</span>  <span class="st">"RIVERBOAT WAGERING TAXES"</span> ,</span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"51"</span> <span class="sc">~</span>  <span class="st">"RETIREMENT CONTRIBUTIONS"</span> , <span class="co"># dropped</span></span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"54"</span> <span class="sc">~</span> <span class="st">"GIFTS AND BEQUESTS"</span>, </span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"57"</span> <span class="sc">~</span>  <span class="st">"FEDERAL OTHER"</span> ,</span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"58"</span> <span class="sc">~</span>  <span class="st">"FEDERAL MEDICAID"</span>, </span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"59"</span> <span class="sc">~</span>  <span class="st">"FEDERAL TRANSPORTATION"</span> ,</span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"60"</span> <span class="sc">~</span>  <span class="st">"OTHER GRANTS AND CONTRACTS"</span>, <span class="co">#other</span></span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"63"</span> <span class="sc">~</span>  <span class="st">"INVESTMENT INCOME"</span>, <span class="co"># other</span></span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"66"</span> <span class="sc">~</span> <span class="st">"PROCEEDS,INVESTMENT MATURITIES"</span> , <span class="co">#dropped</span></span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"72"</span> <span class="sc">~</span> <span class="st">"BOND ISSUE PROCEEDS"</span>,  <span class="co">#dropped</span></span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"75"</span> <span class="sc">~</span>  <span class="st">"INTER-AGENCY RECEIPTS "</span>,  <span class="co">#dropped</span></span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"76"</span> <span class="sc">~</span>  <span class="st">"TRANSFER IN FROM OUT FUNDS"</span>,  <span class="co">#other</span></span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"78"</span> <span class="sc">~</span>  <span class="st">"ALL OTHER SOURCES"</span> ,</span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"79"</span> <span class="sc">~</span>   <span class="st">"COOK COUNTY IGT"</span>, <span class="co">#dropped</span></span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"98"</span> <span class="sc">~</span>  <span class="st">"PRIOR YEAR REFUNDS"</span>, <span class="co">#dropped</span></span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a>                 T <span class="sc">~</span> <span class="st">"Check Me!"</span></span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a>  ) )<span class="sc">%&gt;%</span> </span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Category_name =</span> <span class="fu">str_to_title</span>(Category_name))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>exp_temp <span class="ot">&lt;-</span> exp_temp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(in_ff <span class="sc">==</span> <span class="dv">1</span>) <span class="co"># drops in_ff = 0 funds AFTER dealing with net-revenue above</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>exp_temp <span class="ot">&lt;-</span> exp_temp <span class="sc">%&gt;%</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#mutate(agency = as.numeric(agency) ) %&gt;%</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># arrange(agency)%&gt;%</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="fu">case_when</span>(</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>      agency<span class="sc">&gt;</span><span class="st">"100"</span><span class="sc">&amp;</span> agency<span class="sc">&lt;</span><span class="st">"200"</span> <span class="sc">~</span> <span class="st">"910"</span>, <span class="co"># legislative</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>      agency <span class="sc">==</span> <span class="st">"528"</span>  <span class="sc">|</span> (agency<span class="sc">&gt;</span><span class="st">"200"</span> <span class="sc">&amp;</span> agency<span class="sc">&lt;</span><span class="st">"300"</span>) <span class="sc">~</span> <span class="st">"920"</span>, <span class="co"># judicial</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>      pension<span class="sc">&gt;</span><span class="dv">0</span>  <span class="sc">~</span> <span class="st">"901"</span>, <span class="co"># pensions</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>      (agency<span class="sc">&gt;</span><span class="st">"309"</span> <span class="sc">&amp;</span> agency<span class="sc">&lt;</span><span class="st">"400"</span>) <span class="sc">~</span> <span class="st">"930"</span>,    <span class="co"># elected officers</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>      agency <span class="sc">==</span> <span class="st">"586"</span> <span class="sc">~</span> <span class="st">"959"</span>, <span class="co"># create new K-12 group</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>      agency<span class="sc">==</span><span class="st">"402"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"418"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"478"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"444"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"482"</span> <span class="sc">~</span> <span class="fu">as.character</span>(agency), <span class="co"># aging, Children and Family Services (DCFS), Healthcare and Family Services (DHFS), human services (DHS), public health (DPH)</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>      T <span class="sc">~</span> <span class="fu">as.character</span>(group))</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span>      </span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">case_when</span>(</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>    agency<span class="sc">==</span><span class="st">"478"</span> <span class="sc">&amp;</span> (appr_org<span class="sc">==</span><span class="st">"01"</span> <span class="sc">|</span> appr_org <span class="sc">==</span> <span class="st">"65"</span> <span class="sc">|</span> appr_org<span class="sc">==</span><span class="st">"88"</span>) <span class="sc">&amp;</span> (object<span class="sc">==</span><span class="st">"4900"</span> <span class="sc">|</span> object<span class="sc">==</span><span class="st">"4400"</span>) <span class="sc">~</span> <span class="st">"945"</span>, <span class="co"># separates CHIP from health and human services and saves it as Medicaid</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>    agency <span class="sc">==</span> <span class="st">"586"</span> <span class="sc">&amp;</span> fund <span class="sc">==</span> <span class="st">"0355"</span> <span class="sc">~</span> <span class="st">"945"</span>,  <span class="co"># 586 (Board of Edu) has special education which is part of medicaid</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># OLD CODE: agency == "586" &amp; appr_org == "18" ~ "945", # Spec. Edu Medicaid Matching</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>    agency<span class="sc">==</span><span class="st">"425"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"466"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"546"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"569"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"578"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"583"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"591"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"592"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"493"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"588"</span> <span class="sc">~</span> <span class="st">"941"</span>, <span class="co"># public safety &amp; Corrections</span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>     agency<span class="sc">==</span><span class="st">"406"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"420"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"494"</span> <span class="sc">|</span>  agency<span class="sc">==</span><span class="st">"557"</span> <span class="sc">~</span> <span class="fu">as.character</span>(agency), <span class="co"># econ devt &amp; infra, tollway</span></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>    agency<span class="sc">==</span><span class="st">"511"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"554"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"574"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"598"</span> <span class="sc">~</span> <span class="st">"946"</span>,  <span class="co"># Capital improvement</span></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>    agency<span class="sc">==</span><span class="st">"422"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"532"</span> <span class="sc">~</span> <span class="fu">as.character</span>(agency), <span class="co"># environment &amp; nat. resources</span></span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>    agency<span class="sc">==</span><span class="st">"440"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"446"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"524"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"563"</span>  <span class="sc">~</span> <span class="st">"944"</span>, <span class="co"># business regulation</span></span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>    agency<span class="sc">==</span><span class="st">"492"</span> <span class="sc">~</span> <span class="st">"492"</span>, <span class="co"># revenue</span></span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>    agency <span class="sc">==</span> <span class="st">"416"</span> <span class="sc">~</span> <span class="st">"416"</span>, <span class="co"># central management services</span></span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>    agency<span class="sc">==</span><span class="st">"448"</span> <span class="sc">&amp;</span> fy <span class="sc">&gt;</span> <span class="dv">2016</span> <span class="sc">~</span> <span class="st">"416"</span>, <span class="co">#add DoIT to central management </span></span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>    T <span class="sc">~</span> <span class="fu">as.character</span>(group))) <span class="sc">%&gt;%</span></span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">case_when</span>(</span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a>    <span class="co"># agency=="684" | agency=="691"  ~ as.character(agency), # moved under higher education in next line. 11/28/2022 AWM</span></span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a>    agency<span class="sc">==</span><span class="st">"692"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"695"</span> <span class="sc">|</span> agency <span class="sc">==</span> <span class="st">"684"</span> <span class="sc">|</span>agency <span class="sc">==</span> <span class="st">"691"</span> <span class="sc">|</span> (agency<span class="sc">&gt;</span><span class="st">"599"</span> <span class="sc">&amp;</span> agency<span class="sc">&lt;</span><span class="st">"677"</span>) <span class="sc">~</span> <span class="st">"960"</span>, <span class="co"># higher education</span></span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a>    agency<span class="sc">==</span><span class="st">"427"</span>  <span class="sc">~</span> <span class="fu">as.character</span>(agency), <span class="co"># employment security</span></span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a>    agency<span class="sc">==</span><span class="st">"507"</span><span class="sc">|</span>  agency<span class="sc">==</span><span class="st">"442"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"445"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"452"</span> <span class="sc">|</span>agency<span class="sc">==</span><span class="st">"458"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"497"</span> <span class="sc">~</span> <span class="st">"948"</span>, <span class="co"># other departments</span></span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a>    <span class="co"># other boards &amp; Commissions</span></span>
<span id="cb14-57"><a href="#cb14-57" aria-hidden="true" tabindex="-1"></a>    agency<span class="sc">==</span><span class="st">"503"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"509"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"510"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"565"</span> <span class="sc">|</span>agency<span class="sc">==</span><span class="st">"517"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"525"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"526"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"529"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"537"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"541"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"542"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"548"</span> <span class="sc">|</span>  agency<span class="sc">==</span><span class="st">"555"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"558"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"559"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"562"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"564"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"568"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"579"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"580"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"587"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"590"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"527"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"585"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"567"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"571"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"575"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"540"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"576"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"564"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"534"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"520"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"506"</span> <span class="sc">|</span> agency <span class="sc">==</span> <span class="st">"533"</span> <span class="sc">~</span> <span class="st">"949"</span>, </span>
<span id="cb14-58"><a href="#cb14-58" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-59"><a href="#cb14-59" aria-hidden="true" tabindex="-1"></a>    <span class="co"># non-pension expenditures of retirement funds moved to "Other Departments"</span></span>
<span id="cb14-60"><a href="#cb14-60" aria-hidden="true" tabindex="-1"></a>    <span class="co"># should have removed pension expenditures already from exp_temp in Pensions step above</span></span>
<span id="cb14-61"><a href="#cb14-61" aria-hidden="true" tabindex="-1"></a>    agency<span class="sc">==</span><span class="st">"131"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"275"</span> <span class="sc">|</span> agency<span class="sc">==</span><span class="st">"589"</span> <span class="sc">|</span>agency<span class="sc">==</span><span class="st">"593"</span><span class="sc">|</span>agency<span class="sc">==</span><span class="st">"594"</span><span class="sc">|</span>agency<span class="sc">==</span><span class="st">"693"</span> <span class="sc">~</span> <span class="st">"948"</span>,</span>
<span id="cb14-62"><a href="#cb14-62" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-63"><a href="#cb14-63" aria-hidden="true" tabindex="-1"></a>    T <span class="sc">~</span> <span class="fu">as.character</span>(group))) <span class="sc">%&gt;%</span></span>
<span id="cb14-64"><a href="#cb14-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-65"><a href="#cb14-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group_name =</span> </span>
<span id="cb14-66"><a href="#cb14-66" aria-hidden="true" tabindex="-1"></a>           <span class="fu">case_when</span>(</span>
<span id="cb14-67"><a href="#cb14-67" aria-hidden="true" tabindex="-1"></a>             group <span class="sc">==</span> <span class="st">"416"</span> <span class="sc">~</span> <span class="st">"Central Management"</span>,</span>
<span id="cb14-68"><a href="#cb14-68" aria-hidden="true" tabindex="-1"></a>             group <span class="sc">==</span> <span class="st">"478"</span> <span class="sc">~</span> <span class="st">"Healthcare and Family Services"</span>,</span>
<span id="cb14-69"><a href="#cb14-69" aria-hidden="true" tabindex="-1"></a>             group <span class="sc">==</span> <span class="st">"482"</span> <span class="sc">~</span> <span class="st">"Public Health"</span>,</span>
<span id="cb14-70"><a href="#cb14-70" aria-hidden="true" tabindex="-1"></a>             group <span class="sc">==</span> <span class="st">"900"</span> <span class="sc">~</span> <span class="st">"NOT IN FRAME"</span>,</span>
<span id="cb14-71"><a href="#cb14-71" aria-hidden="true" tabindex="-1"></a>             group <span class="sc">==</span> <span class="st">"901"</span> <span class="sc">~</span> <span class="st">"STATE PENSION CONTRIBUTION"</span>,</span>
<span id="cb14-72"><a href="#cb14-72" aria-hidden="true" tabindex="-1"></a>             group <span class="sc">==</span> <span class="st">"903"</span> <span class="sc">~</span> <span class="st">"DEBT SERVICE"</span>,</span>
<span id="cb14-73"><a href="#cb14-73" aria-hidden="true" tabindex="-1"></a>             group <span class="sc">==</span> <span class="st">"910"</span> <span class="sc">~</span> <span class="st">"LEGISLATIVE"</span>  ,</span>
<span id="cb14-74"><a href="#cb14-74" aria-hidden="true" tabindex="-1"></a>             group <span class="sc">==</span> <span class="st">"920"</span> <span class="sc">~</span> <span class="st">"JUDICIAL"</span> ,</span>
<span id="cb14-75"><a href="#cb14-75" aria-hidden="true" tabindex="-1"></a>             group <span class="sc">==</span> <span class="st">"930"</span> <span class="sc">~</span> <span class="st">"ELECTED OFFICERS"</span> , </span>
<span id="cb14-76"><a href="#cb14-76" aria-hidden="true" tabindex="-1"></a>             group <span class="sc">==</span> <span class="st">"940"</span> <span class="sc">~</span> <span class="st">"OTHER HEALTH-RELATED"</span>, </span>
<span id="cb14-77"><a href="#cb14-77" aria-hidden="true" tabindex="-1"></a>             group <span class="sc">==</span> <span class="st">"941"</span> <span class="sc">~</span> <span class="st">"PUBLIC SAFETY"</span> ,</span>
<span id="cb14-78"><a href="#cb14-78" aria-hidden="true" tabindex="-1"></a>             group <span class="sc">==</span> <span class="st">"942"</span> <span class="sc">~</span> <span class="st">"ECON DEVT &amp; INFRASTRUCTURE"</span> ,</span>
<span id="cb14-79"><a href="#cb14-79" aria-hidden="true" tabindex="-1"></a>             group <span class="sc">==</span> <span class="st">"943"</span> <span class="sc">~</span> <span class="st">"CENTRAL SERVICES"</span>,</span>
<span id="cb14-80"><a href="#cb14-80" aria-hidden="true" tabindex="-1"></a>             group <span class="sc">==</span> <span class="st">"944"</span> <span class="sc">~</span> <span class="st">"BUS &amp; PROFESSION REGULATION"</span> ,</span>
<span id="cb14-81"><a href="#cb14-81" aria-hidden="true" tabindex="-1"></a>             group <span class="sc">==</span> <span class="st">"945"</span> <span class="sc">~</span> <span class="st">"MEDICAID"</span> ,</span>
<span id="cb14-82"><a href="#cb14-82" aria-hidden="true" tabindex="-1"></a>             group <span class="sc">==</span> <span class="st">"946"</span> <span class="sc">~</span> <span class="st">"CAPITAL IMPROVEMENT"</span> , </span>
<span id="cb14-83"><a href="#cb14-83" aria-hidden="true" tabindex="-1"></a>             group <span class="sc">==</span> <span class="st">"948"</span> <span class="sc">~</span> <span class="st">"OTHER DEPARTMENTS"</span> ,</span>
<span id="cb14-84"><a href="#cb14-84" aria-hidden="true" tabindex="-1"></a>             group <span class="sc">==</span> <span class="st">"949"</span> <span class="sc">~</span> <span class="st">"OTHER BOARDS &amp; COMMISSIONS"</span> ,</span>
<span id="cb14-85"><a href="#cb14-85" aria-hidden="true" tabindex="-1"></a>             group <span class="sc">==</span> <span class="st">"959"</span> <span class="sc">~</span> <span class="st">"K-12 EDUCATION"</span> ,</span>
<span id="cb14-86"><a href="#cb14-86" aria-hidden="true" tabindex="-1"></a>             group <span class="sc">==</span> <span class="st">"960"</span> <span class="sc">~</span> <span class="st">"UNIVERSITY EDUCATION"</span> ,</span>
<span id="cb14-87"><a href="#cb14-87" aria-hidden="true" tabindex="-1"></a>             group <span class="sc">==</span> agency <span class="sc">~</span> <span class="fu">as.character</span>(group),</span>
<span id="cb14-88"><a href="#cb14-88" aria-hidden="true" tabindex="-1"></a>             <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Check name"</span>),</span>
<span id="cb14-89"><a href="#cb14-89" aria-hidden="true" tabindex="-1"></a>         <span class="at">year =</span> fy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>exp_temp <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/all_expenditures_recoded.csv"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co">#exp_temp &lt;- read.csv("data/exp_fy23_recoded_02April2024.csv") %&gt;% </span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co">#exp_temp &lt;- read.csv("data/exp_temp.csv") %&gt;% </span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">agency =</span> <span class="fu">as.character</span>(agency),</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">object =</span> <span class="fu">as.character</span>(object),</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">object =</span> <span class="fu">str_pad</span>(object, <span class="at">side =</span> <span class="st">"left"</span>, <span class="dv">4</span>, <span class="at">pad =</span> <span class="st">"0"</span>),</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">sequence =</span> <span class="fu">as.character</span>(sequence),</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">sequence =</span> <span class="fu">str_pad</span>(sequence, <span class="at">side =</span> <span class="st">"left"</span>, <span class="dv">2</span>, <span class="at">pad =</span> <span class="st">"0"</span>),</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="fu">as.character</span>(type),</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="fu">str_pad</span>(type, <span class="at">side =</span> <span class="st">"left"</span>, <span class="dv">2</span>, <span class="at">pad =</span> <span class="st">"0"</span>),</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">appr_org =</span> <span class="fu">as.character</span>(appr_org),</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">appr_org =</span> <span class="fu">str_pad</span>(appr_org, <span class="at">side =</span> <span class="st">"left"</span>, <span class="dv">2</span>, <span class="at">pad =</span> <span class="st">"0"</span>),</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">fund =</span> <span class="fu">as.character</span>(fund),</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">fund =</span> <span class="fu">str_pad</span>(fund, <span class="at">side =</span> <span class="st">"left"</span>, <span class="dv">4</span>, <span class="at">pad =</span> <span class="st">"0"</span>))</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>ff_exp <span class="ot">&lt;-</span> exp_temp <span class="sc">%&gt;%</span> </span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fy, group) <span class="sc">%&gt;%</span> </span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">sum_expenditures =</span> <span class="fu">round</span>(<span class="fu">sum</span>(expenditure, <span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">1000000</span> )) <span class="sc">%&gt;%</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"group"</span>, <span class="at">values_from =</span> <span class="st">"sum_expenditures"</span>, <span class="at">names_prefix =</span> <span class="st">"exp_"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(debt_keep_yearly) <span class="sc">%&gt;%</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">exp_903 =</span> debt_cost) <span class="sc">%&gt;%</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(transfers)  <span class="sc">%&gt;%</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a> <span class="fu">mutate</span>(<span class="at">exp_970 =</span> exp_971 <span class="sc">+</span> exp_972  <span class="sc">+</span> exp_975 <span class="sc">+</span> exp_976)</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a><span class="co">#ff_exp&lt;- ff_exp %&gt;% select(-c(debt_cost, exp_971:exp_976)) # drop unwanted columns</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>exp_long <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(ff_exp, exp_402<span class="sc">:</span>exp_970 , <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"type"</span>, <span class="st">"Category"</span>), <span class="at">values_to =</span> <span class="st">"Dollars"</span>, <span class="at">names_sep =</span> <span class="st">"_"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Year =</span> fy ) <span class="sc">%&gt;%</span> </span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Category_name =</span> </span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>           <span class="fu">case_when</span>(</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"402"</span> <span class="sc">~</span> <span class="st">"AGING"</span> ,</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"406"</span> <span class="sc">~</span> <span class="st">"AGRICULTURE"</span>, </span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"416"</span> <span class="sc">~</span> <span class="st">"CENTRAL MANAGEMENT"</span>,</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"418"</span> <span class="sc">~</span> <span class="st">"CHILDREN AND FAMILY SERVICES"</span>, </span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"420"</span> <span class="sc">~</span> <span class="st">"COMMERCE AND ECONOMIC OPPORTUNITY"</span>,</span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"422"</span> <span class="sc">~</span> <span class="st">"NATURAL RESOURCES"</span> ,</span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"426"</span> <span class="sc">~</span> <span class="st">"CORRECTIONS"</span>,</span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"427"</span> <span class="sc">~</span> <span class="st">"EMPLOYMENT SECURITY"</span> ,</span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"444"</span> <span class="sc">~</span> <span class="st">"HUMAN SERVICES"</span> ,</span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"448"</span> <span class="sc">~</span> <span class="st">"Innovation and Technology"</span>, <span class="co"># AWM added fy2022</span></span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"478"</span> <span class="sc">~</span> <span class="st">"HEALTHCARE &amp; FAM SER NET OF MEDICAID"</span>, </span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"482"</span> <span class="sc">~</span> <span class="st">"PUBLIC HEALTH"</span>, </span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"492"</span> <span class="sc">~</span> <span class="st">"REVENUE"</span>, </span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"494"</span> <span class="sc">~</span> <span class="st">"TRANSPORTATION"</span> ,</span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"532"</span> <span class="sc">~</span> <span class="st">"ENVIRONMENTAL PROTECT AGENCY"</span> ,</span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"557"</span> <span class="sc">~</span> <span class="st">"IL STATE TOLL HIGHWAY AUTH"</span> ,</span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"684"</span> <span class="sc">~</span> <span class="st">"IL COMMUNITY COLLEGE BOARD"</span>, </span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"691"</span> <span class="sc">~</span> <span class="st">"IL STUDENT ASSISTANCE COMM"</span> ,</span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"900"</span> <span class="sc">~</span> <span class="st">"NOT IN FRAME"</span>,</span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"901"</span> <span class="sc">~</span> <span class="st">"STATE PENSION CONTRIBUTION"</span>,</span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"903"</span> <span class="sc">~</span> <span class="st">"DEBT SERVICE"</span>,</span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"904"</span> <span class="sc">~</span> <span class="st">"State Employee Healthcare"</span>,</span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"910"</span> <span class="sc">~</span> <span class="st">"LEGISLATIVE"</span>  ,</span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"920"</span> <span class="sc">~</span> <span class="st">"JUDICIAL"</span> ,</span>
<span id="cb15-57"><a href="#cb15-57" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"930"</span> <span class="sc">~</span> <span class="st">"ELECTED OFFICERS"</span> , </span>
<span id="cb15-58"><a href="#cb15-58" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"940"</span> <span class="sc">~</span> <span class="st">"OTHER HEALTH-RELATED"</span>, </span>
<span id="cb15-59"><a href="#cb15-59" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"941"</span> <span class="sc">~</span> <span class="st">"PUBLIC SAFETY"</span> ,</span>
<span id="cb15-60"><a href="#cb15-60" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"942"</span> <span class="sc">~</span> <span class="st">"ECON DEVT &amp; INFRASTRUCTURE"</span> ,</span>
<span id="cb15-61"><a href="#cb15-61" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"943"</span> <span class="sc">~</span> <span class="st">"CENTRAL SERVICES"</span>,</span>
<span id="cb15-62"><a href="#cb15-62" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"944"</span> <span class="sc">~</span> <span class="st">"BUS &amp; PROFESSION REGULATION"</span> ,</span>
<span id="cb15-63"><a href="#cb15-63" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"945"</span> <span class="sc">~</span> <span class="st">"MEDICAID"</span> ,</span>
<span id="cb15-64"><a href="#cb15-64" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"946"</span> <span class="sc">~</span> <span class="st">"CAPITAL IMPROVEMENT"</span> , </span>
<span id="cb15-65"><a href="#cb15-65" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"948"</span> <span class="sc">~</span> <span class="st">"OTHER DEPARTMENTS"</span> ,</span>
<span id="cb15-66"><a href="#cb15-66" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"949"</span> <span class="sc">~</span> <span class="st">"OTHER BOARDS &amp; COMMISSIONS"</span> ,</span>
<span id="cb15-67"><a href="#cb15-67" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"959"</span> <span class="sc">~</span> <span class="st">"K-12 EDUCATION"</span> ,</span>
<span id="cb15-68"><a href="#cb15-68" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"960"</span> <span class="sc">~</span> <span class="st">"UNIVERSITY EDUCATION"</span>,</span>
<span id="cb15-69"><a href="#cb15-69" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"970"</span> <span class="sc">~</span> <span class="st">"Local Govt Transfers"</span>,</span>
<span id="cb15-70"><a href="#cb15-70" aria-hidden="true" tabindex="-1"></a>             T <span class="sc">~</span> <span class="st">"CHECK ME!"</span>)</span>
<span id="cb15-71"><a href="#cb15-71" aria-hidden="true" tabindex="-1"></a>           ) <span class="sc">%&gt;%</span> </span>
<span id="cb15-72"><a href="#cb15-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Category_name =</span> <span class="fu">str_to_title</span>(Category_name))</span>
<span id="cb15-73"><a href="#cb15-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-74"><a href="#cb15-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-75"><a href="#cb15-75" aria-hidden="true" tabindex="-1"></a><span class="co">#exp_long_nototals &lt;- exp_long %&gt;% filter(Category_name != "Totals")</span></span>
<span id="cb15-76"><a href="#cb15-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-77"><a href="#cb15-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-78"><a href="#cb15-78" aria-hidden="true" tabindex="-1"></a>aggregated_totals_long <span class="ot">&lt;-</span> <span class="fu">rbind</span>(rev_long, exp_long) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Change plots:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>year_totals2 <span class="ot">&lt;-</span> aggregated_totals_long <span class="sc">%&gt;%</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(type, Year) <span class="sc">%&gt;%</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Dollars =</span> <span class="fu">sum</span>(Dollars, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"type"</span>, <span class="at">values_from =</span> Dollars) <span class="sc">%&gt;%</span> </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Expenditures =</span> exp,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">Revenue =</span> rev) <span class="sc">%&gt;%</span>  </span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Fiscal Gap</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(Revenue <span class="sc">-</span> Expenditures)) <span class="sc">%&gt;%</span> </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Year))</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co"># creates variable for the Gap each year</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>year_totals2 <span class="co"># gap for FY22 changed to 2.3 billion</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Year"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["debt"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Expenditures"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Revenue"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Fiscal Gap"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"2023","2":"1951.4367","3":"124654.05","4":"111482","5":"-13172"},{"1":"2022","2":"2009.4535","3":"112046.75","4":"107574","5":"-4473"},{"1":"2021","2":"2026.2605","3":"101552.26","4":"94978","5":"-6574"},{"1":"2020","2":"1947.2277","3":"89351.64","4":"77071","5":"-12281"},{"1":"2019","2":"2052.3408","3":"80925.71","4":"74638","5":"-6288"},{"1":"2018","2":"1970.6946","3":"81152.53","4":"72808","5":"-8345"},{"1":"2017","2":"1851.6359","3":"78187.12","4":"63255","5":"-14932"},{"1":"2016","2":"1906.0034","3":"70166.48","4":"63978","5":"-6188"},{"1":"2015","2":"2014.5557","3":"76223.51","4":"66356","5":"-9868"},{"1":"2014","2":"1920.0166","3":"72993.18","4":"65013","5":"-7980"},{"1":"2013","2":"1802.8567","3":"69117.02","4":"62800","5":"-6317"},{"1":"2012","2":"1784.8646","3":"65433.85","4":"57627","5":"-7807"},{"1":"2011","2":"1640.8520","3":"65953.96","4":"53291","5":"-12663"},{"1":"2010","2":"1387.9202","3":"64465.31","4":"47418","5":"-17047"},{"1":"2009","2":"1421.0780","3":"62271.20","4":"49431","5":"-12840"},{"1":"2008","2":"1414.2337","3":"60046.76","4":"51645","5":"-8402"},{"1":"2007","2":"1417.2083","3":"56708.45","4":"49493","5":"-7215"},{"1":"2006","2":"1415.4533","3":"53266.01","4":"46168","5":"-7098"},{"1":"2005","2":"1351.8173","3":"50036.17","4":"44305","5":"-5731"},{"1":"2004","2":"1288.5843","3":"57281.80","4":"42612","5":"-14670"},{"1":"2003","2":"731.2022","3":"46735.18","4":"38452","5":"-8283"},{"1":"2002","2":"640.2570","3":"46367.46","4":"37923","5":"-8444"},{"1":"2001","2":"590.0442","3":"44829.91","4":"38289","5":"-6541"},{"1":"2000","2":"543.8405","3":"41708.12","4":"37049","5":"-4659"},{"1":"1999","2":"507.5276","3":"37875.56","4":"33966","5":"-3910"},{"1":"1998","2":"484.5338","3":"34719.48","4":"32029","5":"-2690"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>annotation_billions <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">2004</span>, <span class="dv">2017</span>, <span class="dv">2019</span>),</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">50</span>, <span class="dv">10</span>),  </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"Expenditures"</span>,<span class="st">"Revenue"</span>, <span class="st">"Fiscal Gap"</span>))</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>fiscal_gap1 <span class="ot">&lt;-</span> year_totals <span class="sc">%&gt;%</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Revenue<span class="sc">/</span><span class="dv">1000</span>), <span class="at">color =</span> <span class="st">"Black"</span>, <span class="at">lwd=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Expenditures<span class="sc">/</span><span class="dv">1000</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">lwd=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> <span class="st">`</span><span class="at">Fiscal Gap</span><span class="st">`</span><span class="sc">/</span><span class="dv">1000</span>), <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> annotation_billions, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">label=</span>label))<span class="sc">+</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>, <span class="co">#axis.text.y = element_blank(),  </span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>        <span class="co">#axis.ticks.y = element_blank(),</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"dashed"</span>, <span class="st">"dashed"</span>)) <span class="sc">+</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>, <span class="dv">120</span>), <span class="at">labels =</span> comma)<span class="sc">+</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">1998</span>,<span class="dv">2023</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) </span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>fiscal_gap1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="exclude_stateCURE_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>fiscal_gap_droppedCURE <span class="ot">&lt;-</span> year_totals2 <span class="sc">%&gt;%</span>  </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Revenue<span class="sc">/</span><span class="dv">1000</span>), <span class="at">color =</span> <span class="st">"Black"</span>, <span class="at">lwd=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Expenditures<span class="sc">/</span><span class="dv">1000</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">lwd=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> <span class="st">`</span><span class="at">Fiscal Gap</span><span class="st">`</span><span class="sc">/</span><span class="dv">1000</span>), <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> annotation_billions, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">label=</span>label))<span class="sc">+</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,<span class="co"># axis.text.y = element_blank(),</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">#axis.ticks.y = element_blank(),</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>() )<span class="sc">+</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"dashed"</span>, <span class="st">"dashed"</span>)) <span class="sc">+</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">120</span>), <span class="at">labels =</span> comma)<span class="sc">+</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">1998</span>, <span class="dv">2023</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) </span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># # geom_smooth adds regression line, graphed first so it appears behind line graph</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_smooth(aes(x = Year, y = Revenue), color = "gray", method = "lm", se = FALSE) + </span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_smooth(aes(x = Year, y = Expenditures), color = "rosybrown2", method = "lm", se = FALSE) +</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># # line graph of revenue and expenditures</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_line(aes(x = Year, y = Revenue), color = "black", size=1) +</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_line(aes(x = Year, y = Expenditures), color = "red", size=1) +</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_line(aes(x=Year, y = `Fiscal Gap`), color="gray") +</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_text(data= annotation, aes(x=x, y = y, label=label))+</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># # labels</span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   theme_bw() +</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_y_continuous(labels = comma)+</span></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># xlab("Year") + </span></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ylab("Millions of Dollars")  +</span></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ggtitle("Illinois Expenditures and Revenue Totals, 1998-2022")</span></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>fiscal_gap_droppedCURE</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="exclude_stateCURE_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Compare with and without federal COVID dollars:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(fiscal_gap1,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>                   fiscal_gap_droppedCURE, <span class="at">nrow=</span><span class="dv">1</span>, </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"With ARPA State CURE Funds"</span>, <span class="st">"Without ARPA State Cure Funds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="exclude_stateCURE_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Revenue amounts in millions of dollars:</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>rev_long <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="dv">2023</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#mutate(`Total Expenditures`= sum(Dollars, na.rm = TRUE)) %&gt;%</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a> <span class="co"># select(-c(Year, `Total Expenditures`)) %&gt;%</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="st">`</span><span class="at">Dollars</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_reorder</span>(Category_name, <span class="st">`</span><span class="at">Dollars</span><span class="st">`</span>), <span class="at">y =</span> <span class="st">`</span><span class="at">Dollars</span><span class="st">`</span>))<span class="sc">+</span> </span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Revenues for FY2023"</span>)<span class="sc">+</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Revenue Categories"</span>) <span class="sc">+</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Millions of Dollars"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="exclude_stateCURE_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="forecasting-attempt" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="forecasting-attempt"><span class="header-section-number">3.2.1</span> Forecasting attempt</h3>
<p>First images use revenue that includes all federal stimulus packages. Revenue projections are skewed heavily due to the large amount of covid money flowing in the past 2 years.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Revenues</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>year_totals2 <span class="ot">&lt;-</span> year_totals2 <span class="sc">%&gt;%</span> </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Year)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co">#ts_rev &lt;- year_totals %&gt;% select(Year, Revenue ) %&gt;% arrange(Year)</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>tsrev <span class="ot">&lt;-</span> <span class="fu">ts</span>(year_totals2<span class="sc">$</span>Revenue, <span class="at">start =</span><span class="st">"1998"</span>, <span class="at">frequency =</span> <span class="dv">1</span>) <span class="co"># yearly data</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co"># start(tsrev) # 1998, January</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co"># end(tsrev)  ## 2022 </span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(tsrev)</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(tsrev)</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="co"># abline(reg=lm(tsrev~time(tsrev)))</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="do">#### ARIMAs</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>mymodel <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(tsrev, <span class="at">seasonal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="co"># mymodel          # ARIMA (0, 1, 0) with drift</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>myforecastrev <span class="ot">&lt;-</span> <span class="fu">forecast</span>(mymodel, <span class="at">h =</span> <span class="dv">20</span>)</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(myforecastrev,  xlab ="", ylab ="Total Revenue", main ="Chicago Revenue")</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a><span class="do">#### revenue chart</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>model_rev <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(tsrev, <span class="at">seasonal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>forecast_rev <span class="ot">&lt;-</span> <span class="fu">forecast</span>(model_rev, <span class="at">h =</span> <span class="dv">20</span>)</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>q <span class="ot">&lt;-</span> <span class="fu">forecast</span>(forecast_rev,  <span class="at">h =</span> <span class="dv">20</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Dollars (Millions)"</span>) <span class="sc">+</span></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Forecasted Revenue"</span>) <span class="sc">+</span></span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> dollar )</span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(forecast_rev)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Forecast method: ARIMA(0,1,1) with drift

Model Information:
Series: tsrev 
ARIMA(0,1,1) with drift 

Coefficients:
         ma1     drift
      0.8419  3148.990
s.e.  0.1666  1346.163

sigma^2 = 15033493:  log likelihood = -241.62
AIC=489.24   AICc=490.38   BIC=492.9

Error measures:
                 ME    RMSE      MAE        MPE     MAPE      MASE       ACF1
Training set 36.283 3646.76 2655.534 -0.5337082 4.391722 0.6999963 -0.1585794

Forecasts:
     Point Forecast    Lo 80    Hi 80     Lo 95    Hi 95
2024       115441.6 110472.6 120410.7 107842.10 123041.1
2025       118590.6 108176.3 129004.9 102663.30 134517.9
2026       121739.6 107875.1 135604.1 100535.69 142943.5
2027       124888.6 108275.6 141501.6  99481.26 150295.9
2028       128037.6 109070.3 147004.8  99029.67 157045.5
2029       131186.6 110126.6 152246.6  98978.10 163395.0
2030       134335.6 111372.8 157298.3  99217.02 169454.1
2031       137484.6 112765.0 162204.1  99679.28 175289.8
2032       140633.5 114274.1 166993.0 100320.20 180946.9
2033       143782.5 115879.3 171685.7 101108.28 186456.8
2034       146931.5 117565.6 176297.4 102020.29 191842.7
2035       150080.5 119321.4 180839.6 103038.56 197122.5
2036       153229.5 121137.6 185321.4 104149.24 202309.8
2037       156378.5 123007.0 189749.9 105341.27 207415.7
2038       159527.5 124923.7 194131.2 106605.61 212449.4
2039       162676.5 126882.8 198470.1 107934.79 217418.1
2040       165825.5 128880.2 202770.7 109322.56 222328.4
2041       168974.4 130912.4 207036.5 110763.59 227185.3
2042       172123.4 132976.5 211270.4 112253.32 231993.6
2043       175272.4 135069.8 215475.1 113787.82 236757.0</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># annotation &lt;- data.frame(</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   x = c(2027, 2032),</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   y = c(200000, 300000),  </span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   label = c("$120 billion in 2027","$135 billion in 2032")</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>annotation <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">2020</span>, <span class="dv">2032</span>),</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">150000</span>, <span class="dv">200000</span>),  </span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"$125 billion in 2027"</span>,<span class="st">"$141 billion in 2032"</span>)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>q<span class="sc">+</span> <span class="fu">geom_label</span>(<span class="at">data =</span> annotation, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">label=</span>label), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">caption =</span> <span class="st">"after dropping federal covid dollars"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="exclude_stateCURE_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Expenditures</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>tsexp <span class="ot">&lt;-</span> <span class="fu">ts</span>(year_totals2<span class="sc">$</span>Expenditures, <span class="at">start =</span> <span class="st">"1998"</span>, <span class="at">frequency =</span> <span class="dv">1</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>model_exp<span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(tsexp, <span class="at">seasonal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># model_exp            # ARIMA (0,1,1) with drift</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>forecast_exp <span class="ot">&lt;-</span> <span class="fu">forecast</span>(model_exp, <span class="at">h =</span> <span class="dv">20</span>) </span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(forecast_exp, xlab ="",  ylab ="Total Expenditures", main ="Chicago Expenditures")</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">forecast</span>(model_exp,  <span class="at">h =</span> <span class="dv">20</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Dollars (Millions)"</span>) <span class="sc">+</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Forecasted Expenditures"</span>) <span class="sc">+</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> dollar )</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(forecast_exp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Forecast method: ARIMA(0,1,0) with drift

Model Information:
Series: tsexp 
ARIMA(0,1,0) with drift 

Coefficients:
          drift
      3597.3827
s.e.   947.0728

sigma^2 = 23357929:  log likelihood = -247.04
AIC=498.09   AICc=498.63   BIC=500.53

Error measures:
                   ME   RMSE     MAE        MPE     MAPE      MASE       ACF1
Training set 1.197003 4643.4 3178.97 -0.9251133 4.479552 0.6733181 0.05745899

Forecasts:
     Point Forecast    Lo 80    Hi 80    Lo 95    Hi 95
2024       128251.4 122057.7 134445.2 118778.9 137723.9
2025       131848.8 123089.5 140608.1 118452.7 145245.0
2026       135446.2 124718.3 146174.1 119039.3 151853.1
2027       139043.6 126656.1 151431.1 120098.5 157988.6
2028       142641.0 128791.3 156490.6 121459.8 163822.1
2029       146238.3 131066.8 161409.9 123035.5 169441.2
2030       149835.7 133448.6 166222.8 124773.8 174897.6
2031       153433.1 135914.6 170951.7 126640.8 180225.4
2032       157030.5 138449.3 175611.7 128612.9 185448.0
2033       160627.9 141041.5 180214.2 130673.2 190582.6
2034       164225.3 143682.9 184767.6 132808.5 195642.0
2035       167822.6 146366.9 189278.4 135008.9 200636.4
2036       171420.0 149088.2 193751.9 137266.4 205573.7
2037       175017.4 151842.5 198192.3 139574.5 210460.3
2038       178614.8 154626.5 202603.1 141927.9 215301.7
2039       182212.2 157437.2 206987.1 144322.1 220102.2
2040       185809.6 160272.1 211347.0 146753.4 224865.7
2041       189406.9 163129.1 215684.8 149218.5 229595.4
2042       193004.3 166006.4 220002.2 151714.6 234294.0
2043       196601.7 168902.4 224301.0 154239.3 238964.1</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>annotation <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">2027</span>, <span class="dv">2032</span>),</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">139000</span>, <span class="dv">100000</span>),  <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"$117 ± 20 Billion in 2027"</span>,<span class="st">"$161 ± 20 Billion in 2032 "</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> </span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> annotation, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">label=</span>label), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Forecasted Expenditures"</span>, </span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Projected values at 95% confidence interval. </span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="st">  Dark blue represents 80% liklihood of falling with that range, </span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="st">  light blue represents 95% liklihood of being in projected range."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="exclude_stateCURE_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Exp and Rev together</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(tsexp) <span class="sc">+</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_line(tsexp)+</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_line(aes(model_rev))+</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(forecast_rev, <span class="at">series =</span> <span class="st">"Revenue"</span>) <span class="sc">+</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(forecast_exp, <span class="at">series =</span> <span class="st">"Expenditure)"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(year_totals, <span class="at">mapping=</span> <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Revenue))  <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="st">"Forecast"</span>)) <span class="sc">+</span> </span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Forecasted Revenue and Expenditures"</span>, <span class="at">caption =</span> <span class="st">"Revenue includes State and Local CURE Dollars"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="exclude_stateCURE_files/figure-html/unnamed-chunk-7-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Revenue forecasting using precovid trends:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># revenue using precovid trends</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>tsrev <span class="ot">&lt;-</span> <span class="fu">ts</span>(year_totals<span class="sc">$</span>Revenue, <span class="at">start =</span><span class="st">"1998"</span>, <span class="at">end =</span> <span class="st">"2020"</span>, <span class="at">frequency =</span> <span class="dv">1</span>) <span class="co"># yearly data</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>tsexp2019 <span class="ot">&lt;-</span> <span class="fu">ts</span>(year_totals<span class="sc">$</span>Expenditures, <span class="at">start =</span><span class="st">"1998"</span>, <span class="at">end =</span> <span class="st">"2020"</span>, <span class="at">frequency =</span> <span class="dv">1</span>) <span class="co"># yearly data</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="do">#### revenue chart</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>model_rev <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(tsrev, <span class="at">seasonal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>forecast_rev <span class="ot">&lt;-</span> <span class="fu">forecast</span>(model_rev, <span class="at">h =</span> <span class="dv">23</span>)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">forecast</span>(forecast_rev,  <span class="at">h =</span> <span class="dv">22</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Dollars (Millions)"</span>) <span class="sc">+</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Forecasted Revenue"</span>) <span class="sc">+</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> dollar )</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(forecast_rev)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Forecast method: ARIMA(0,1,0) with drift

Model Information:
Series: tsrev 
ARIMA(0,1,0) with drift 

Coefficients:
          drift
      2207.3182
s.e.   534.1556

sigma^2 = 6576007:  log likelihood = -203.39
AIC=410.79   AICc=411.42   BIC=412.97

Error measures:
                   ME     RMSE      MAE        MPE     MAPE      MASE
Training set 1.296594 2450.343 1758.755 -0.3029288 3.155213 0.6904094
                    ACF1
Training set -0.06929682

Forecasts:
     Point Forecast     Lo 80     Hi 80     Lo 95     Hi 95
2021       82797.32  79510.94  86083.69  77771.24  87823.40
2022       85004.64  80357.00  89652.27  77896.69  92112.58
2023       87211.95  81519.78  92904.12  78506.53  95917.38
2024       89419.27  82846.52  95992.02  79367.12  99471.43
2025       91626.59  84278.03  98975.15  80387.94 102865.24
2026       93833.91  85783.97 101883.85  81522.58 106145.24
2027       96041.23  87346.29 104736.16  82743.47 109338.98
2028       98248.55  88953.27 107543.82  84032.65 112464.44
2029      100455.86  90596.74 110314.99  85377.63 115534.10
2030      102663.18  92270.75 113055.61  86769.33 118557.04
2031      104870.50  93970.82 115770.18  88200.88 121540.12
2032      107077.82  95693.48 118462.16  89666.97 124488.66
2033      109285.14  97435.94 121134.33  91163.35 127406.92
2034      111492.45  99195.96 123788.95  92686.59 130298.32
2035      113699.77 100971.69 126427.85  94233.86 133165.69
2036      115907.09 102761.59 129052.59  95802.78 136011.40
2037      118114.41 104564.33 131664.48  97391.36 138837.46
2038      120321.73 106378.82 134264.64  98997.88 141645.57
2039      122529.05 108204.07 136854.03 100620.88 144437.21
2040      124736.36 110039.24 139433.48 102259.06 147213.67
2041      126943.68 111883.62 142003.75 103911.30 149976.07
2042      129151.00 113736.53 144565.47 105576.60 152725.40
2043      131358.32 115597.41 147119.22 107254.09 155462.54</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>annotation <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">2020</span>, <span class="dv">2032</span>),</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">90000</span>, <span class="dv">100000</span>),  </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"$96 Billion in 2027"</span>,<span class="st">"$107 Billion in 2032"</span>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>c<span class="sc">+</span> <span class="fu">geom_label</span>(<span class="at">data =</span> annotation, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">label=</span>label), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">"Revenue Forecasted using Pre-Covid Data"</span>, </span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Own Source and Federal Revenues Combined"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="exclude_stateCURE_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(tsexp2019) <span class="sc">+</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_line(tsexp)+</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_line(aes(model_rev))+</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(forecast_rev, <span class="at">series =</span> <span class="st">"Revenue"</span>) <span class="sc">+</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(forecast_exp, <span class="at">series =</span> <span class="st">"Expenditure)"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(year_totals, <span class="at">mapping=</span> <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Revenue))  <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="st">"Forecast"</span>)) <span class="sc">+</span> </span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Forecasted Revenue and Expenditures"</span>, <span class="at">subtitle =</span> <span class="st">"Using Pre-Covid revenue data (ending in FY2020) with Actual 2022 expenditures"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="exclude_stateCURE_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Federal Revenue</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>fed_rev <span class="ot">&lt;-</span> ff_rev <span class="sc">%&gt;%</span> <span class="fu">select</span>(fy, rev_57, rev_58, rev_59) <span class="sc">%&gt;%</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fed_total =</span> rev_57<span class="sc">+</span>rev_58<span class="sc">+</span>rev_59)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>fed_ts57 <span class="ot">&lt;-</span> <span class="fu">ts</span>(fed_rev<span class="sc">$</span>rev_57, <span class="at">start =</span><span class="st">"1998"</span>, <span class="at">frequency =</span> <span class="dv">1</span>) <span class="co"># yearly data</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>model_fed <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(fed_ts57, <span class="at">seasonal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>forecast_fed <span class="ot">&lt;-</span> <span class="fu">forecast</span>(model_fed, <span class="at">h =</span> <span class="dv">23</span>)</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>fed57 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(forecast_fed,  <span class="at">h =</span> <span class="dv">20</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Nominal Dollars (Millions)"</span>) <span class="sc">+</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Forecasted Federal Other Revenue"</span>) <span class="sc">+</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> dollar )</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>fed57</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="exclude_stateCURE_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>fed_ts58 <span class="ot">&lt;-</span> <span class="fu">ts</span>(fed_rev<span class="sc">$</span>rev_58, <span class="at">start =</span><span class="st">"1998"</span>, <span class="at">frequency =</span> <span class="dv">1</span>) <span class="co"># yearly data</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>model_fed <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(fed_ts58, <span class="at">seasonal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>forecast_fed <span class="ot">&lt;-</span> <span class="fu">forecast</span>(model_fed, <span class="at">h =</span> <span class="dv">23</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>fed58 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(forecast_fed,  <span class="at">h =</span> <span class="dv">20</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Nominal Dollars (Millions)"</span>) <span class="sc">+</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Forecasted Federal Transfers for Transportation"</span>) <span class="sc">+</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> dollar )</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>fed58</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="exclude_stateCURE_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>fed_ts59 <span class="ot">&lt;-</span> <span class="fu">ts</span>(fed_rev<span class="sc">$</span>rev_59, <span class="at">start =</span><span class="st">"1998"</span>, <span class="at">frequency =</span> <span class="dv">1</span>) <span class="co"># yearly data</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>model_fed <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(fed_ts59, <span class="at">seasonal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>forecast_fed <span class="ot">&lt;-</span> <span class="fu">forecast</span>(model_fed, <span class="at">h =</span> <span class="dv">23</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>fed59 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(forecast_fed,  <span class="at">h =</span> <span class="dv">20</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Nominal Dollars (Millions)"</span>) <span class="sc">+</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Forecasted Federal Medicaid Reimbursements"</span>) <span class="sc">+</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> dollar )</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>fed59</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="exclude_stateCURE_files/figure-html/unnamed-chunk-9-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>fed_rev <span class="ot">&lt;-</span> ff_rev <span class="sc">%&gt;%</span> <span class="fu">select</span>(fy, rev_57, rev_58, rev_59) <span class="sc">%&gt;%</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fed_total =</span> rev_57<span class="sc">+</span>rev_58<span class="sc">+</span>rev_59)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>fed_tstotal <span class="ot">&lt;-</span> <span class="fu">ts</span>(fed_rev<span class="sc">$</span>fed_total, <span class="at">start =</span><span class="st">"1998"</span>, <span class="at">frequency =</span> <span class="dv">1</span>) <span class="co"># yearly data</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>model_fed <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(fed_tstotal, <span class="at">seasonal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>forecast_fed <span class="ot">&lt;-</span> <span class="fu">forecast</span>(model_fed, <span class="at">h =</span> <span class="dv">23</span>)</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>fedtotal <span class="ot">&lt;-</span> <span class="fu">forecast</span>(forecast_fed,  <span class="at">h =</span> <span class="dv">20</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Nominal Dollars (Millions)"</span>) <span class="sc">+</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Forecasted Federal Revenue WITHOUT Federal COVID Dollars"</span>, <span class="at">subtitle =</span> <span class="st">"Sum of Transportation, Medicaid, and Other Federal Revenue"</span>) <span class="sc">+</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> dollar ) </span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>fedtotal</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="exclude_stateCURE_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">#fed_tstotal &lt;- ts(fed_rev$fed_total, start ="1998", end = "2020", frequency = 1) # yearly data</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="co">#model_fed2 &lt;- auto.arima(fed_tstotal, seasonal = FALSE)</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co">#forecast_fed2 &lt;- forecast(model_fed2, h = 23)</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="co"># fedtotal2 &lt;- forecast(forecast_fed2,  h = 20) %&gt;% </span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   autoplot() +</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     ylab("Nominal Dollars (Millions)") +</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   xlab("Year") +</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggtitle("Forecasted Federal Revenue -- pre-COVID trends", subtitle = "Sum of Transportation, Medicaid, and Other Federal Revenue") +</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_classic() +</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_y_continuous(labels = dollar ) </span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a><span class="co"># fedtotal2</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(tsexp2019) <span class="sc">+</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_line(tsexp)+</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_line(aes(model_rev))+</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(forecast_fed, <span class="at">series =</span> <span class="st">"No Fed Stim Packages"</span>) <span class="sc">+</span></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">#autolayer(forecast_fed2, series = "Pre-Covid Fed Rev)", alpha = 0.5) +</span></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(year_totals2, <span class="at">mapping=</span> <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Revenue))  <span class="sc">+</span> </span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="st">"Forecast"</span>)) <span class="sc">+</span> </span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Comparison of Combined Federal Revenue without Stimulus Packages and </span><span class="sc">\n</span><span class="st">Pre-COVID revenue trend"</span> , </span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Using Pre-Covid revenue data (ending in FY2020)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="exclude_stateCURE_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Graphing the 3 federal revenue types together may be the most reliable since some COVID funding is still recorded in Federal Other and some are in other categories (like Disaster Response in FY2021). Need to look at more before using.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># does not include rev_type == 58, medicaid dollars</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="co"># covid_dollars &lt;- rev_temp %&gt;% filter(covid_dollars==1) # check what was dropped</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co">#covid_dollars %&gt;% group_by(fy,rev_type) %&gt;% summarize(receipts = sum(receipts)) %&gt;% pivot_wider(names_from="rev_type", values_from = "receipts")</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>rev_temp <span class="ot">&lt;-</span> rev_temp <span class="sc">%&gt;%</span>  <span class="fu">filter</span>(covid_dollars<span class="sc">==</span><span class="dv">0</span>) <span class="co"># keeps observations that were not coded as COVID federal funds</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>ff_rev <span class="ot">&lt;-</span> rev_temp <span class="sc">%&gt;%</span> </span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(rev_type_new, fy) <span class="sc">%&gt;%</span> </span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">sum_receipts =</span> <span class="fu">sum</span>(receipts, <span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">1000000</span> ) <span class="sc">%&gt;%</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"rev_type_new"</span>, <span class="at">values_from =</span> <span class="st">"sum_receipts"</span>, <span class="at">names_prefix =</span> <span class="st">"rev_"</span>)</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>ff_rev <span class="ot">&lt;-</span> <span class="fu">mutate_all</span>(ff_rev, <span class="sc">~</span><span class="fu">replace_na</span>(.,<span class="dv">0</span>))</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>rev_long <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(ff_rev, rev_02<span class="sc">:</span>rev_78, <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"type"</span>,<span class="st">"Category"</span>), <span class="at">values_to =</span> <span class="st">"Dollars"</span>, <span class="at">names_sep =</span> <span class="st">"_"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Year =</span> fy) <span class="sc">%&gt;%</span></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Category_name =</span> <span class="fu">case_when</span>(</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"02"</span> <span class="sc">~</span> <span class="st">"INDIVIDUAL INCOME TAX"</span> ,</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"03"</span> <span class="sc">~</span> <span class="st">"CORPORATE INCOME TAX"</span> ,</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"06"</span> <span class="sc">~</span> <span class="st">"SALES TAX"</span> ,</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"09"</span> <span class="sc">~</span> <span class="st">"MOTOR FUEL TAX"</span> ,</span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"12"</span> <span class="sc">~</span> <span class="st">"PUBLIC UTILITY TAX"</span> ,</span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"15"</span> <span class="sc">~</span> <span class="st">"CIGARETTE TAXES"</span> ,</span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"18"</span> <span class="sc">~</span> <span class="st">"LIQUOR GALLONAGE TAXES"</span> ,</span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"21"</span> <span class="sc">~</span> <span class="st">"INHERITANCE TAX"</span> ,</span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"24"</span> <span class="sc">~</span> <span class="st">"INSURANCE TAXES&amp;FEES&amp;LICENSES"</span> ,</span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"27"</span> <span class="sc">~</span> <span class="st">"CORP FRANCHISE TAXES &amp; FEES"</span> ,</span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"30"</span> <span class="sc">~</span> <span class="st">"HORSE RACING TAXES &amp; FEES"</span>,  <span class="co"># in Other</span></span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"31"</span> <span class="sc">~</span> <span class="st">"MEDICAL PROVIDER ASSESSMENTS"</span> ,</span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"32"</span> <span class="sc">~</span> <span class="st">"GARNISHMENT-LEVIES"</span> , <span class="co"># dropped</span></span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"33"</span> <span class="sc">~</span>  <span class="st">"LOTTERY RECEIPTS"</span> ,</span>
<span id="cb37-37"><a href="#cb37-37" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"35"</span> <span class="sc">~</span>  <span class="st">"OTHER TAXES"</span> ,</span>
<span id="cb37-38"><a href="#cb37-38" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"36"</span> <span class="sc">~</span>  <span class="st">"RECEIPTS FROM REVENUE PRODUCING"</span>, </span>
<span id="cb37-39"><a href="#cb37-39" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"39"</span> <span class="sc">~</span>  <span class="st">"LICENSES, FEES &amp; REGISTRATIONS"</span> ,</span>
<span id="cb37-40"><a href="#cb37-40" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"42"</span> <span class="sc">~</span>  <span class="st">"MOTOR VEHICLE AND OPERATORS"</span> ,</span>
<span id="cb37-41"><a href="#cb37-41" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"45"</span> <span class="sc">~</span>  <span class="st">"STUDENT FEES-UNIVERSITIES"</span>,   <span class="co"># dropped</span></span>
<span id="cb37-42"><a href="#cb37-42" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"48"</span> <span class="sc">~</span>  <span class="st">"RIVERBOAT WAGERING TAXES"</span> ,</span>
<span id="cb37-43"><a href="#cb37-43" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"51"</span> <span class="sc">~</span>  <span class="st">"RETIREMENT CONTRIBUTIONS"</span> , <span class="co"># dropped</span></span>
<span id="cb37-44"><a href="#cb37-44" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"54"</span> <span class="sc">~</span> <span class="st">"GIFTS AND BEQUESTS"</span>, </span>
<span id="cb37-45"><a href="#cb37-45" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"57"</span> <span class="sc">~</span>  <span class="st">"FEDERAL OTHER"</span> ,</span>
<span id="cb37-46"><a href="#cb37-46" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"58"</span> <span class="sc">~</span>  <span class="st">"FEDERAL MEDICAID"</span>, </span>
<span id="cb37-47"><a href="#cb37-47" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"59"</span> <span class="sc">~</span>  <span class="st">"FEDERAL TRANSPORTATION"</span> ,</span>
<span id="cb37-48"><a href="#cb37-48" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"60"</span> <span class="sc">~</span>  <span class="st">"OTHER GRANTS AND CONTRACTS"</span>, <span class="co">#other</span></span>
<span id="cb37-49"><a href="#cb37-49" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"63"</span> <span class="sc">~</span>  <span class="st">"INVESTMENT INCOME"</span>, <span class="co"># other</span></span>
<span id="cb37-50"><a href="#cb37-50" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"66"</span> <span class="sc">~</span> <span class="st">"PROCEEDS,INVESTMENT MATURITIES"</span> , <span class="co">#dropped</span></span>
<span id="cb37-51"><a href="#cb37-51" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"72"</span> <span class="sc">~</span> <span class="st">"BOND ISSUE PROCEEDS"</span>,  <span class="co">#dropped</span></span>
<span id="cb37-52"><a href="#cb37-52" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"75"</span> <span class="sc">~</span>  <span class="st">"INTER-AGENCY RECEIPTS "</span>,  <span class="co">#dropped</span></span>
<span id="cb37-53"><a href="#cb37-53" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"76"</span> <span class="sc">~</span>  <span class="st">"TRANSFER IN FROM OUT FUNDS"</span>,  <span class="co">#other</span></span>
<span id="cb37-54"><a href="#cb37-54" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"78"</span> <span class="sc">~</span>  <span class="st">"ALL OTHER SOURCES"</span> ,</span>
<span id="cb37-55"><a href="#cb37-55" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"79"</span> <span class="sc">~</span>   <span class="st">"COOK COUNTY IGT"</span>, <span class="co">#dropped</span></span>
<span id="cb37-56"><a href="#cb37-56" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"98"</span> <span class="sc">~</span>  <span class="st">"PRIOR YEAR REFUNDS"</span>, <span class="co">#dropped</span></span>
<span id="cb37-57"><a href="#cb37-57" aria-hidden="true" tabindex="-1"></a>                 T <span class="sc">~</span> <span class="st">"Check Me!"</span></span>
<span id="cb37-58"><a href="#cb37-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-59"><a href="#cb37-59" aria-hidden="true" tabindex="-1"></a>  ) )<span class="sc">%&gt;%</span> </span>
<span id="cb37-60"><a href="#cb37-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Category_name =</span> <span class="fu">str_to_title</span>(Category_name))</span>
<span id="cb37-61"><a href="#cb37-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-62"><a href="#cb37-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-63"><a href="#cb37-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-64"><a href="#cb37-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-65"><a href="#cb37-65" aria-hidden="true" tabindex="-1"></a>exp_long <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(ff_exp, exp_402<span class="sc">:</span>exp_970 , <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"type"</span>, <span class="st">"Category"</span>), <span class="at">values_to =</span> <span class="st">"Dollars"</span>, <span class="at">names_sep =</span> <span class="st">"_"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb37-66"><a href="#cb37-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Year =</span> fy ) <span class="sc">%&gt;%</span> </span>
<span id="cb37-67"><a href="#cb37-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Category_name =</span> </span>
<span id="cb37-68"><a href="#cb37-68" aria-hidden="true" tabindex="-1"></a>           <span class="fu">case_when</span>(</span>
<span id="cb37-69"><a href="#cb37-69" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"402"</span> <span class="sc">~</span> <span class="st">"AGING"</span> ,</span>
<span id="cb37-70"><a href="#cb37-70" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"406"</span> <span class="sc">~</span> <span class="st">"AGRICULTURE"</span>, </span>
<span id="cb37-71"><a href="#cb37-71" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"416"</span> <span class="sc">~</span> <span class="st">"CENTRAL MANAGEMENT"</span>,</span>
<span id="cb37-72"><a href="#cb37-72" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"418"</span> <span class="sc">~</span> <span class="st">"CHILDREN AND FAMILY SERVICES"</span>, </span>
<span id="cb37-73"><a href="#cb37-73" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"420"</span> <span class="sc">~</span> <span class="st">"COMMERCE AND ECONOMIC OPPORTUNITY"</span>,</span>
<span id="cb37-74"><a href="#cb37-74" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"422"</span> <span class="sc">~</span> <span class="st">"NATURAL RESOURCES"</span> ,</span>
<span id="cb37-75"><a href="#cb37-75" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"426"</span> <span class="sc">~</span> <span class="st">"CORRECTIONS"</span>,</span>
<span id="cb37-76"><a href="#cb37-76" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"427"</span> <span class="sc">~</span> <span class="st">"EMPLOYMENT SECURITY"</span> ,</span>
<span id="cb37-77"><a href="#cb37-77" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"444"</span> <span class="sc">~</span> <span class="st">"HUMAN SERVICES"</span> ,</span>
<span id="cb37-78"><a href="#cb37-78" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"448"</span> <span class="sc">~</span> <span class="st">"Innovation and Technology"</span>, <span class="co"># AWM added fy2022</span></span>
<span id="cb37-79"><a href="#cb37-79" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"478"</span> <span class="sc">~</span> <span class="st">"HEALTHCARE &amp; FAM SER NET OF MEDICAID"</span>, </span>
<span id="cb37-80"><a href="#cb37-80" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"482"</span> <span class="sc">~</span> <span class="st">"PUBLIC HEALTH"</span>, </span>
<span id="cb37-81"><a href="#cb37-81" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"492"</span> <span class="sc">~</span> <span class="st">"REVENUE"</span>, </span>
<span id="cb37-82"><a href="#cb37-82" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"494"</span> <span class="sc">~</span> <span class="st">"TRANSPORTATION"</span> ,</span>
<span id="cb37-83"><a href="#cb37-83" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"532"</span> <span class="sc">~</span> <span class="st">"ENVIRONMENTAL PROTECT AGENCY"</span> ,</span>
<span id="cb37-84"><a href="#cb37-84" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"557"</span> <span class="sc">~</span> <span class="st">"IL STATE TOLL HIGHWAY AUTH"</span> ,</span>
<span id="cb37-85"><a href="#cb37-85" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"684"</span> <span class="sc">~</span> <span class="st">"IL COMMUNITY COLLEGE BOARD"</span>, </span>
<span id="cb37-86"><a href="#cb37-86" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"691"</span> <span class="sc">~</span> <span class="st">"IL STUDENT ASSISTANCE COMM"</span> ,</span>
<span id="cb37-87"><a href="#cb37-87" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"900"</span> <span class="sc">~</span> <span class="st">"NOT IN FRAME"</span>,</span>
<span id="cb37-88"><a href="#cb37-88" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"901"</span> <span class="sc">~</span> <span class="st">"STATE PENSION CONTRIBUTION"</span>,</span>
<span id="cb37-89"><a href="#cb37-89" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"903"</span> <span class="sc">~</span> <span class="st">"DEBT SERVICE"</span>,</span>
<span id="cb37-90"><a href="#cb37-90" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"904"</span> <span class="sc">~</span> <span class="st">"State Employee Healthcare"</span>,</span>
<span id="cb37-91"><a href="#cb37-91" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"910"</span> <span class="sc">~</span> <span class="st">"LEGISLATIVE"</span>  ,</span>
<span id="cb37-92"><a href="#cb37-92" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"920"</span> <span class="sc">~</span> <span class="st">"JUDICIAL"</span> ,</span>
<span id="cb37-93"><a href="#cb37-93" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"930"</span> <span class="sc">~</span> <span class="st">"ELECTED OFFICERS"</span> , </span>
<span id="cb37-94"><a href="#cb37-94" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"940"</span> <span class="sc">~</span> <span class="st">"OTHER HEALTH-RELATED"</span>, </span>
<span id="cb37-95"><a href="#cb37-95" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"941"</span> <span class="sc">~</span> <span class="st">"PUBLIC SAFETY"</span> ,</span>
<span id="cb37-96"><a href="#cb37-96" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"942"</span> <span class="sc">~</span> <span class="st">"ECON DEVT &amp; INFRASTRUCTURE"</span> ,</span>
<span id="cb37-97"><a href="#cb37-97" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"943"</span> <span class="sc">~</span> <span class="st">"CENTRAL SERVICES"</span>,</span>
<span id="cb37-98"><a href="#cb37-98" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"944"</span> <span class="sc">~</span> <span class="st">"BUS &amp; PROFESSION REGULATION"</span> ,</span>
<span id="cb37-99"><a href="#cb37-99" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"945"</span> <span class="sc">~</span> <span class="st">"MEDICAID"</span> ,</span>
<span id="cb37-100"><a href="#cb37-100" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"946"</span> <span class="sc">~</span> <span class="st">"CAPITAL IMPROVEMENT"</span> , </span>
<span id="cb37-101"><a href="#cb37-101" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"948"</span> <span class="sc">~</span> <span class="st">"OTHER DEPARTMENTS"</span> ,</span>
<span id="cb37-102"><a href="#cb37-102" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"949"</span> <span class="sc">~</span> <span class="st">"OTHER BOARDS &amp; COMMISSIONS"</span> ,</span>
<span id="cb37-103"><a href="#cb37-103" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"959"</span> <span class="sc">~</span> <span class="st">"K-12 EDUCATION"</span> ,</span>
<span id="cb37-104"><a href="#cb37-104" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"960"</span> <span class="sc">~</span> <span class="st">"UNIVERSITY EDUCATION"</span>,</span>
<span id="cb37-105"><a href="#cb37-105" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"970"</span> <span class="sc">~</span> <span class="st">"Local Govt Transfers"</span>,</span>
<span id="cb37-106"><a href="#cb37-106" aria-hidden="true" tabindex="-1"></a>             T <span class="sc">~</span> <span class="st">"CHECK ME!"</span>)</span>
<span id="cb37-107"><a href="#cb37-107" aria-hidden="true" tabindex="-1"></a>           ) <span class="sc">%&gt;%</span> </span>
<span id="cb37-108"><a href="#cb37-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Category_name =</span> <span class="fu">str_to_title</span>(Category_name))</span>
<span id="cb37-109"><a href="#cb37-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-110"><a href="#cb37-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-111"><a href="#cb37-111" aria-hidden="true" tabindex="-1"></a><span class="co">#exp_long_nototals &lt;- exp_long %&gt;% filter(Category_name != "Totals")</span></span>
<span id="cb37-112"><a href="#cb37-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-113"><a href="#cb37-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-114"><a href="#cb37-114" aria-hidden="true" tabindex="-1"></a>aggregated_totals_long <span class="ot">&lt;-</span> <span class="fu">rbind</span>(rev_long, exp_long) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Change plots:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>year_totals2 <span class="ot">&lt;-</span> aggregated_totals_long <span class="sc">%&gt;%</span> </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(type, Year) <span class="sc">%&gt;%</span> </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Dollars =</span> <span class="fu">sum</span>(Dollars, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"type"</span>, <span class="at">values_from =</span> Dollars) <span class="sc">%&gt;%</span> </span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Expenditures =</span> exp,</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">Revenue =</span> rev) <span class="sc">%&gt;%</span>  </span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Fiscal Gap</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(Revenue <span class="sc">-</span> Expenditures)) <span class="sc">%&gt;%</span> </span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Year))</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="co"># creates variable for the Gap each year</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>year_totals2 <span class="co"># gap for FY22 changed to ~2 or 3 billion</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-totals-without-FederalStimulus" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-totals-without-FederalStimulus-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3.1: Fiscal Gap without State CURE Federal Revenue
</figcaption>
<div aria-describedby="tbl-totals-without-FederalStimulus-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Year"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["debt"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Expenditures"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Revenue"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Fiscal Gap"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"2023","2":"1951.4367","3":"124654.05","4":"111484.65","5":"-13169"},{"1":"2022","2":"2009.4535","3":"112046.75","4":"107576.69","5":"-4470"},{"1":"2021","2":"2026.2605","3":"101552.26","4":"94977.85","5":"-6574"},{"1":"2020","2":"1947.2277","3":"89351.64","4":"77069.80","5":"-12282"},{"1":"2019","2":"2052.3408","3":"80925.71","4":"74637.67","5":"-6288"},{"1":"2018","2":"1970.6946","3":"81152.53","4":"72805.98","5":"-8347"},{"1":"2017","2":"1851.6359","3":"78187.12","4":"63256.05","5":"-14931"},{"1":"2016","2":"1906.0034","3":"70166.48","4":"63975.04","5":"-6191"},{"1":"2015","2":"2014.5557","3":"76223.51","4":"66358.98","5":"-9865"},{"1":"2014","2":"1920.0166","3":"72993.18","4":"65016.41","5":"-7977"},{"1":"2013","2":"1802.8567","3":"69117.02","4":"62799.74","5":"-6317"},{"1":"2012","2":"1784.8646","3":"65433.85","4":"57626.63","5":"-7807"},{"1":"2011","2":"1640.8520","3":"65953.96","4":"53291.05","5":"-12663"},{"1":"2010","2":"1387.9202","3":"64465.31","4":"47417.82","5":"-17047"},{"1":"2009","2":"1421.0780","3":"62271.20","4":"49429.86","5":"-12841"},{"1":"2008","2":"1414.2337","3":"60046.76","4":"51642.53","5":"-8404"},{"1":"2007","2":"1417.2083","3":"56708.45","4":"49494.35","5":"-7214"},{"1":"2006","2":"1415.4533","3":"53266.01","4":"46169.68","5":"-7096"},{"1":"2005","2":"1351.8173","3":"50036.17","4":"44306.21","5":"-5730"},{"1":"2004","2":"1288.5843","3":"57281.80","4":"42611.88","5":"-14670"},{"1":"2003","2":"731.2022","3":"46735.18","4":"38452.77","5":"-8282"},{"1":"2002","2":"640.2570","3":"46367.46","4":"37922.36","5":"-8445"},{"1":"2001","2":"590.0442","3":"44829.91","4":"38286.47","5":"-6543"},{"1":"2000","2":"543.8405","3":"41708.12","4":"37051.45","5":"-4657"},{"1":"1999","2":"507.5276","3":"37875.56","4":"33965.66","5":"-3910"},{"1":"1998","2":"484.5338","3":"34719.48","4":"32030.45","5":"-2689"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</figure>
</div>
</div>
<div class="cell" data-fig-cap-location="top">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>annotation_billions <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">2004</span>, <span class="dv">2017</span>, <span class="dv">2019</span>),</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">50</span>, <span class="dv">10</span>),</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"Expenditures"</span>,<span class="st">"Revenue"</span>, <span class="st">"Fiscal Gap"</span>))</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>fiscal_gap1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> year_totals, <span class="fu">aes</span>(<span class="at">x=</span>Year, <span class="at">y =</span> Revenue<span class="sc">/</span><span class="dv">1000</span>)) <span class="sc">+</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_recessions</span>(<span class="at">text =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Revenue<span class="sc">/</span><span class="dv">1000</span>), <span class="at">color =</span> <span class="st">"Black"</span>, <span class="at">lwd=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Expenditures<span class="sc">/</span><span class="dv">1000</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">lwd=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> <span class="st">`</span><span class="at">Fiscal Gap</span><span class="st">`</span><span class="sc">/</span><span class="dv">1000</span>), <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> annotation_billions, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">label=</span>label))<span class="sc">+</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>, <span class="co">#axis.text.y = element_blank(),</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>        <span class="co">#axis.ticks.y = element_blank(),</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"dashed"</span>, <span class="st">"dashed"</span>)) <span class="sc">+</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">16</span>, <span class="dv">120</span>), <span class="at">labels =</span> comma)<span class="sc">+</span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">1998</span>,<span class="dv">2023</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>fiscal_gap1</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave(fiscal_gap1, file = "Figure7a-WithCURE.eps")</span></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>fiscal_gap_droppedCURE <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> year_totals2, <span class="fu">aes</span>(<span class="at">x=</span>Year, <span class="at">y =</span> Revenue<span class="sc">/</span><span class="dv">1000</span>)) <span class="sc">+</span></span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_recessions</span>(<span class="at">text =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Revenue<span class="sc">/</span><span class="dv">1000</span>), <span class="at">color =</span> <span class="st">"Black"</span>, <span class="at">lwd=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Expenditures<span class="sc">/</span><span class="dv">1000</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">lwd=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> <span class="st">`</span><span class="at">Fiscal Gap</span><span class="st">`</span><span class="sc">/</span><span class="dv">1000</span>), <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> annotation_billions, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">label=</span>label))<span class="sc">+</span></span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,<span class="co"># axis.text.y = element_blank(),</span></span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a>                                    <span class="co">#axis.ticks.y = element_blank(),</span></span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>() )<span class="sc">+</span></span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"dashed"</span>, <span class="st">"dashed"</span>)) <span class="sc">+</span></span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">16</span>,<span class="dv">120</span>), <span class="at">labels =</span> comma)<span class="sc">+</span></span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">1998</span>,<span class="dv">2023</span>),<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-45"><a href="#cb39-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-46"><a href="#cb39-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># # geom_smooth adds regression line, graphed first so it appears behind line graph</span></span>
<span id="cb39-47"><a href="#cb39-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_smooth(aes(x = Year, y = Revenue), color = "gray", method = "lm", se = FALSE) + </span></span>
<span id="cb39-48"><a href="#cb39-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_smooth(aes(x = Year, y = Expenditures), color = "rosybrown2", method = "lm", se = FALSE) +</span></span>
<span id="cb39-49"><a href="#cb39-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb39-50"><a href="#cb39-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># # line graph of revenue and expenditures</span></span>
<span id="cb39-51"><a href="#cb39-51" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_line(aes(x = Year, y = Revenue), color = "black", size=1) +</span></span>
<span id="cb39-52"><a href="#cb39-52" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_line(aes(x = Year, y = Expenditures), color = "red", size=1) +</span></span>
<span id="cb39-53"><a href="#cb39-53" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_line(aes(x=Year, y = `Fiscal Gap`), color="gray") +</span></span>
<span id="cb39-54"><a href="#cb39-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb39-55"><a href="#cb39-55" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_text(data= annotation, aes(x=x, y = y, label=label))+</span></span>
<span id="cb39-56"><a href="#cb39-56" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb39-57"><a href="#cb39-57" aria-hidden="true" tabindex="-1"></a>  <span class="co"># # labels</span></span>
<span id="cb39-58"><a href="#cb39-58" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   theme_bw() +</span></span>
<span id="cb39-59"><a href="#cb39-59" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_y_continuous(labels = comma)+</span></span>
<span id="cb39-60"><a href="#cb39-60" aria-hidden="true" tabindex="-1"></a>  <span class="co"># xlab("Year") + </span></span>
<span id="cb39-61"><a href="#cb39-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ylab("Millions of Dollars")  +</span></span>
<span id="cb39-62"><a href="#cb39-62" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ggtitle("Illinois Expenditures and Revenue Totals, 1998-2022")</span></span>
<span id="cb39-63"><a href="#cb39-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-64"><a href="#cb39-64" aria-hidden="true" tabindex="-1"></a>  fiscal_gap_droppedCURE</span>
<span id="cb39-65"><a href="#cb39-65" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-66"><a href="#cb39-66" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave(fiscal_gap_droppedCURE, file = "Figure7b-WithoutCURE.eps")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-withandwithout-stateCURE" class="cell quarto-figure quarto-figure-center quarto-float anchored" data-fig-cap-location="top">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-withandwithout-stateCURE-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.1: Illinois Revenue Trend
</figcaption>
<div aria-describedby="fig-withandwithout-stateCURE-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="fig-withandwithout-stateCURE-1" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<figcaption class="quarto-float-caption-top quarto-subfloat-caption quarto-subfloat-fig" id="fig-withandwithout-stateCURE-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) With State CURE
</figcaption>
<div aria-describedby="fig-withandwithout-stateCURE-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="exclude_stateCURE_files/figure-html/fig-withandwithout-stateCURE-1.png" class="img-fluid figure-img" data-ref-parent="fig-withandwithout-stateCURE" width="672">
</div>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-withandwithout-stateCURE-2" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<figcaption class="quarto-float-caption-top quarto-subfloat-caption quarto-subfloat-fig" id="fig-withandwithout-stateCURE-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Without State CURE
</figcaption>
<div aria-describedby="fig-withandwithout-stateCURE-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="exclude_stateCURE_files/figure-html/fig-withandwithout-stateCURE-2.png" class="img-fluid figure-img" data-ref-parent="fig-withandwithout-stateCURE" width="672">
</div>
</figure>
</div>
</div>
</div>
</figure>
</div>
</div>
<p>Compare with and without federal COVID dollars:</p>
<p><strong>Revenue amounts in millions of dollars:</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>rev_long <span class="sc">%&gt;%</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="dv">2023</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#mutate(`Total Expenditures`= sum(Dollars, na.rm = TRUE)) %&gt;%</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a> <span class="co"># select(-c(Year, `Total Expenditures`)) %&gt;%</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="st">`</span><span class="at">Dollars</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_reorder</span>(Category_name, <span class="st">`</span><span class="at">Dollars</span><span class="st">`</span>), <span class="at">y =</span> <span class="st">`</span><span class="at">Dollars</span><span class="st">`</span>))<span class="sc">+</span> </span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Revenues for FY2023"</span>)<span class="sc">+</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Revenue Categories"</span>) <span class="sc">+</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Millions of Dollars"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-revlong-bargraphs" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-revlong-bargraphs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.2: Comparison of revenue with and without federal State CURE funds.
</figcaption>
<div aria-describedby="fig-revlong-bargraphs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="exclude_stateCURE_files/figure-html/fig-revlong-bargraphs-1.png" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
</div>
</section>
<section id="all-categories-with-totals" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="all-categories-with-totals"><span class="header-section-number">3.2.2</span> All Categories with Totals</h3>
<div id="tbl-rev-tables-droppedCURE" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-rev-tables-droppedCURE-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3.2: Revenue without State CURE
</figcaption>
<div aria-describedby="tbl-rev-tables-droppedCURE-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>exp_totals <span class="ot">&lt;-</span> ff_exp <span class="sc">%&gt;%</span> <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">exp_TOTALS =</span> <span class="fu">sum</span>(<span class="fu">across</span>(exp_402<span class="sc">:</span>exp_970)))</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>rev_totals <span class="ot">&lt;-</span> ff_rev <span class="sc">%&gt;%</span>    <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rev_TOTALS =</span> <span class="fu">sum</span>(<span class="fu">across</span>(rev_02<span class="sc">:</span>rev_78)))</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>rev_long <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(rev_totals, rev_02<span class="sc">:</span>rev_TOTALS, <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"type"</span>,<span class="st">"Category"</span>), <span class="at">values_to =</span> <span class="st">"Dollars"</span>, <span class="at">names_sep =</span> <span class="st">"_"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Year =</span> fy) <span class="sc">%&gt;%</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Category_name =</span> <span class="fu">case_when</span>(</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"02"</span> <span class="sc">~</span> <span class="st">"INDIVIDUAL INCOME TAXES"</span> ,</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"03"</span> <span class="sc">~</span> <span class="st">"CORPORATE INCOME TAXES"</span> ,</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"06"</span> <span class="sc">~</span> <span class="st">"SALES TAXES"</span> ,</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"09"</span> <span class="sc">~</span> <span class="st">"MOTOR FUEL TAX"</span> ,</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"12"</span> <span class="sc">~</span> <span class="st">"PUBLIC UTILITY TAXES"</span> ,</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"15"</span> <span class="sc">~</span> <span class="st">"CIGARETTE TAXES"</span> ,</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"18"</span> <span class="sc">~</span> <span class="st">"LIQUOR GALLONAGE TAXES"</span> ,</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"21"</span> <span class="sc">~</span> <span class="st">"INHERITANCE TAX"</span> ,</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"24"</span> <span class="sc">~</span> <span class="st">"INSURANCE TAXES&amp;FEES&amp;LICENSES"</span> ,</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"27"</span> <span class="sc">~</span> <span class="st">"CORP FRANCHISE TAXES &amp; FEES"</span> ,</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"30"</span> <span class="sc">~</span> <span class="st">"HORSE RACING TAXES &amp; FEES"</span>,  <span class="co"># in Other</span></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"31"</span> <span class="sc">~</span> <span class="st">"MEDICAL PROVIDER ASSESSMENTS"</span> ,</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"32"</span> <span class="sc">~</span> <span class="st">"GARNISHMENT-LEVIES"</span> , <span class="co"># dropped</span></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"33"</span> <span class="sc">~</span>  <span class="st">"LOTTERY RECEIPTS"</span> ,</span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"35"</span> <span class="sc">~</span>  <span class="st">"OTHER TAXES"</span> ,</span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"36"</span> <span class="sc">~</span>  <span class="st">"RECEIPTS FROM REVENUE PRODUCING"</span>, </span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"39"</span> <span class="sc">~</span>  <span class="st">"LICENSES, FEES &amp; REGISTRATIONS"</span> ,</span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"42"</span> <span class="sc">~</span>  <span class="st">"MOTOR VEHICLE AND OPERATORS"</span> ,</span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"45"</span> <span class="sc">~</span>  <span class="st">"STUDENT FEES-UNIVERSITIES"</span>,   <span class="co"># dropped</span></span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"48"</span> <span class="sc">~</span>  <span class="st">"RIVERBOAT WAGERING TAXES"</span> ,</span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"51"</span> <span class="sc">~</span>  <span class="st">"RETIREMENT CONTRIBUTIONS"</span> , <span class="co"># dropped</span></span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"54"</span> <span class="sc">~</span> <span class="st">"GIFTS AND BEQUESTS"</span>, </span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"57"</span> <span class="sc">~</span>  <span class="st">"FEDERAL OTHER"</span> ,</span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"58"</span> <span class="sc">~</span>  <span class="st">"FEDERAL MEDICAID"</span>, </span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"59"</span> <span class="sc">~</span>  <span class="st">"FEDERAL TRANSPORTATION"</span> ,</span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"60"</span> <span class="sc">~</span>  <span class="st">"OTHER GRANTS AND CONTRACTS"</span>, <span class="co">#other</span></span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"63"</span> <span class="sc">~</span>  <span class="st">"INVESTMENT INCOME"</span>, <span class="co"># other</span></span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"66"</span> <span class="sc">~</span> <span class="st">"PROCEEDS,INVESTMENT MATURITIES"</span> , <span class="co">#dropped</span></span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"72"</span> <span class="sc">~</span> <span class="st">"BOND ISSUE PROCEEDS"</span>,  <span class="co">#dropped</span></span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"75"</span> <span class="sc">~</span>  <span class="st">"INTER-AGENCY RECEIPTS "</span>,  <span class="co">#dropped</span></span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"76"</span> <span class="sc">~</span>  <span class="st">"TRANSFER IN FROM OUT FUNDS"</span>,  <span class="co">#other</span></span>
<span id="cb41-39"><a href="#cb41-39" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"78"</span> <span class="sc">~</span>  <span class="st">"ALL OTHER SOURCES"</span> ,</span>
<span id="cb41-40"><a href="#cb41-40" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"79"</span> <span class="sc">~</span>   <span class="st">"COOK COUNTY IGT"</span>, <span class="co">#dropped</span></span>
<span id="cb41-41"><a href="#cb41-41" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"98"</span> <span class="sc">~</span>  <span class="st">"PRIOR YEAR REFUNDS"</span>, <span class="co">#dropped</span></span>
<span id="cb41-42"><a href="#cb41-42" aria-hidden="true" tabindex="-1"></a>Category <span class="sc">==</span> <span class="st">"TOTALS"</span> <span class="sc">~</span> <span class="st">"Total"</span></span>
<span id="cb41-43"><a href="#cb41-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-44"><a href="#cb41-44" aria-hidden="true" tabindex="-1"></a>  ) ) <span class="sc">%&gt;%</span> </span>
<span id="cb41-45"><a href="#cb41-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>type, <span class="sc">-</span>Category) <span class="sc">%&gt;%</span>  <span class="co"># drop extra columns type and Category number</span></span>
<span id="cb41-46"><a href="#cb41-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, Category_name) <span class="sc">%&gt;%</span></span>
<span id="cb41-47"><a href="#cb41-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Dollars=</span> <span class="fu">round</span>(<span class="fu">sum</span>(Dollars),<span class="at">digits=</span><span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-48"><a href="#cb41-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Category_name =</span> <span class="fu">str_to_title</span>(Category_name))</span>
<span id="cb41-49"><a href="#cb41-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-50"><a href="#cb41-50" aria-hidden="true" tabindex="-1"></a><span class="co"># creates wide version of table where each revenue source is a column</span></span>
<span id="cb41-51"><a href="#cb41-51" aria-hidden="true" tabindex="-1"></a>revenue_wide2 <span class="ot">&lt;-</span> rev_long <span class="sc">%&gt;%</span> <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Category_name, </span>
<span id="cb41-52"><a href="#cb41-52" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> Dollars) <span class="sc">%&gt;%</span></span>
<span id="cb41-53"><a href="#cb41-53" aria-hidden="true" tabindex="-1"></a><span class="co">#  relocate("Other Revenue Sources **", .after = last_col()) %&gt;%</span></span>
<span id="cb41-54"><a href="#cb41-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(<span class="st">"Total"</span>, <span class="at">.after =</span>  <span class="fu">last_col</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</figure>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>exp_long <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(exp_totals, exp_402<span class="sc">:</span>exp_TOTALS , <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"type"</span>, <span class="st">"Category"</span>), <span class="at">values_to =</span> <span class="st">"Dollars"</span>, <span class="at">names_sep =</span> <span class="st">"_"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Year =</span> fy ) <span class="sc">%&gt;%</span> </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Category_name =</span> </span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>           <span class="fu">case_when</span>(</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>            Category <span class="sc">==</span> <span class="st">"402"</span> <span class="sc">~</span> <span class="st">"AGING"</span> ,</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>            Category <span class="sc">==</span> <span class="st">"406"</span> <span class="sc">~</span> <span class="st">"AGRICULTURE"</span>, </span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"416"</span> <span class="sc">~</span> <span class="st">"Central Management"</span>,</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>            Category <span class="sc">==</span> <span class="st">"418"</span> <span class="sc">~</span> <span class="st">"CHILDREN AND FAMILY SERVICES"</span>, </span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"420"</span> <span class="sc">~</span> <span class="st">"Community Development"</span>,</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>            Category <span class="sc">==</span> <span class="st">"422"</span> <span class="sc">~</span> <span class="st">"NATURAL RESOURCES"</span> ,</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"426"</span> <span class="sc">~</span> <span class="st">"CORRECTIONS"</span>,</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>            Category <span class="sc">==</span> <span class="st">"427"</span> <span class="sc">~</span> <span class="st">"EMPLOYMENT SECURITY"</span> ,</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"444"</span> <span class="sc">~</span> <span class="st">"Human Services"</span> ,</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>           Category <span class="sc">==</span> <span class="st">"478"</span> <span class="sc">~</span> <span class="st">"HEALTHCARE &amp; FAM SER NET OF MEDICAID"</span>, </span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>            Category <span class="sc">==</span> <span class="st">"482"</span> <span class="sc">~</span> <span class="st">"PUBLIC HEALTH"</span>, </span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>            Category <span class="sc">==</span> <span class="st">"492"</span> <span class="sc">~</span> <span class="st">"REVENUE"</span>, </span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"494"</span> <span class="sc">~</span> <span class="st">"Transportation"</span> ,</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"532"</span> <span class="sc">~</span> <span class="st">"ENVIRONMENTAL PROTECT AGENCY"</span> ,</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"557"</span> <span class="sc">~</span> <span class="st">"Tollway"</span> ,</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"684"</span> <span class="sc">~</span> <span class="st">"IL COMMUNITY COLLEGE BOARD"</span>, </span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"691"</span> <span class="sc">~</span> <span class="st">"IL STUDENT ASSISTANCE COMM"</span> ,</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"900"</span> <span class="sc">~</span> <span class="st">"NOT IN FRAME"</span>,</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"901"</span> <span class="sc">~</span> <span class="st">"State Pension Contribution"</span>,</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"903"</span> <span class="sc">~</span> <span class="st">"Debt Service"</span>,</span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"904"</span> <span class="sc">~</span> <span class="st">"State Employee Healthcare"</span>,</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"910"</span> <span class="sc">~</span> <span class="st">"LEGISLATIVE"</span>  ,</span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"920"</span> <span class="sc">~</span> <span class="st">"JUDICIAL"</span> ,</span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"930"</span> <span class="sc">~</span> <span class="st">"ELECTED OFFICERS"</span> , </span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"940"</span> <span class="sc">~</span> <span class="st">"OTHER HEALTH-RELATED"</span>, </span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"941"</span> <span class="sc">~</span> <span class="st">"Public Safety"</span> ,</span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"942"</span> <span class="sc">~</span> <span class="st">"ECON DEVT &amp; INFRASTRUCTURE"</span> ,</span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"943"</span> <span class="sc">~</span> <span class="st">"CENTRAL SERVICES"</span>,</span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"944"</span> <span class="sc">~</span> <span class="st">"BUS &amp; PROFESSION REGULATION"</span> ,</span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"945"</span> <span class="sc">~</span> <span class="st">"Medicaid"</span> ,</span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"946"</span> <span class="sc">~</span> <span class="st">"Capital Improvement"</span> , </span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"948"</span> <span class="sc">~</span> <span class="st">"OTHER DEPARTMENTS"</span> ,</span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"949"</span> <span class="sc">~</span> <span class="st">"OTHER BOARDS &amp; COMMISSIONS"</span> ,</span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"959"</span> <span class="sc">~</span> <span class="st">"K-12 Education"</span> ,</span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"960"</span> <span class="sc">~</span> <span class="st">"UNIVERSITY EDUCATION"</span>,</span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a>             Category <span class="sc">==</span> <span class="st">"970"</span> <span class="sc">~</span> <span class="st">"Local Govt Revenue Sharing"</span>,</span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a>          Category <span class="sc">==</span> <span class="st">"TOTALS"</span> <span class="sc">~</span> <span class="st">"Total"</span>) <span class="co">#,T ~ "All Other Expenditures **")</span></span>
<span id="cb42-42"><a href="#cb42-42" aria-hidden="true" tabindex="-1"></a>           ) <span class="sc">%&gt;%</span> </span>
<span id="cb42-43"><a href="#cb42-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>type, <span class="sc">-</span>Category) <span class="sc">%&gt;%</span> </span>
<span id="cb42-44"><a href="#cb42-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, Category_name) <span class="sc">%&gt;%</span> </span>
<span id="cb42-45"><a href="#cb42-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Dollars=</span> <span class="fu">round</span>(<span class="fu">sum</span>(Dollars),<span class="at">digits=</span><span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb42-46"><a href="#cb42-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Category_name =</span> <span class="fu">str_to_title</span>(Category_name))</span>
<span id="cb42-47"><a href="#cb42-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-48"><a href="#cb42-48" aria-hidden="true" tabindex="-1"></a>expenditure_wide2 <span class="ot">&lt;-</span> exp_long<span class="sc">%&gt;%</span> </span>
<span id="cb42-49"><a href="#cb42-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Category_name, </span>
<span id="cb42-50"><a href="#cb42-50" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> Dollars) <span class="sc">%&gt;%</span></span>
<span id="cb42-51"><a href="#cb42-51" aria-hidden="true" tabindex="-1"></a>  <span class="co">#relocate("All Other Expenditures **", .after = last_col()) %&gt;%</span></span>
<span id="cb42-52"><a href="#cb42-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(<span class="st">"Total"</span>, <span class="at">.after =</span>  <span class="fu">last_col</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Everything.html" class="pagination-link" aria-label="Calculating the Fiscal Gap">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Calculating the Fiscal Gap</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb43" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Alternate Analysis: Dropping State CURE Funds"</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Not correct yet. </span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Moved from the Calculating the Fiscal Gap quarto doc and it became more of an ordeal than I thought it would be. </span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup, warning = FALSE, message = FALSE}</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyverse)</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a><span class="in">library(kableExtra)</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a><span class="in">library(scales)</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a><span class="in">library(forecast)</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a><span class="in">library(cmapplot)</span></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::opts_chunk$set(warning = FALSE, message = FALSE)</span></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a><span class="in">theme_set(theme_classic() )</span></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a><span class="in">```{r transfers}</span></span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a><span class="in">exp_temp &lt;- read.csv("data/exp_temp.csv") %&gt;% </span></span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(agency = as.character(agency),</span></span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a><span class="in">         object = as.character(object),</span></span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a><span class="in">         object = str_pad(object, side = "left", 4, pad = "0"),</span></span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a><span class="in">         sequence = as.character(sequence),</span></span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a><span class="in">         sequence = str_pad(sequence, side = "left", 2, pad = "0"),</span></span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a><span class="in">         type = as.character(type),</span></span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a><span class="in">         type = str_pad(type, side = "left", 2, pad = "0"),</span></span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a><span class="in">         appr_org = as.character(appr_org),</span></span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a><span class="in">         appr_org = str_pad(appr_org, side = "left", 2, pad = "0"),</span></span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a><span class="in">         fund = as.character(fund),</span></span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a><span class="in">         fund = str_pad(fund, side = "left", 4, pad = "0"),</span></span>
<span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a><span class="in">         fund_ioc = as.character(fund_ioc))</span></span>
<span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a><span class="in">exp_temp &lt;- exp_temp %&gt;% </span></span>
<span id="cb43-38"><a href="#cb43-38" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(eehc = ifelse(</span></span>
<span id="cb43-39"><a href="#cb43-39" aria-hidden="true" tabindex="-1"></a><span class="in">    # group insurance contributions for 1998-2005 and 2013-present</span></span>
<span id="cb43-40"><a href="#cb43-40" aria-hidden="true" tabindex="-1"></a><span class="in">   fund == "0001" &amp; (object == "1180" | object =="1900") &amp; agency == "416" &amp; appr_org=="20", 0, 1) )%&gt;% </span></span>
<span id="cb43-41"><a href="#cb43-41" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb43-42"><a href="#cb43-42" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(eehc = ifelse(</span></span>
<span id="cb43-43"><a href="#cb43-43" aria-hidden="true" tabindex="-1"></a><span class="in">    # group insurance contributions for 2006-2012</span></span>
<span id="cb43-44"><a href="#cb43-44" aria-hidden="true" tabindex="-1"></a><span class="in">    fund == "0001" &amp; object == "1180" &amp; agency == "478" </span></span>
<span id="cb43-45"><a href="#cb43-45" aria-hidden="true" tabindex="-1"></a><span class="in">    &amp; appr_org=="80", 0, eehc) )%&gt;%</span></span>
<span id="cb43-46"><a href="#cb43-46" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb43-47"><a href="#cb43-47" aria-hidden="true" tabindex="-1"></a><span class="in">   # group insurance contributions from road fund</span></span>
<span id="cb43-48"><a href="#cb43-48" aria-hidden="true" tabindex="-1"></a><span class="in">  # coded with 1900 for some reason??</span></span>
<span id="cb43-49"><a href="#cb43-49" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(eehc = ifelse(</span></span>
<span id="cb43-50"><a href="#cb43-50" aria-hidden="true" tabindex="-1"></a><span class="in">      fund == "0011" &amp; object == "1900" &amp; </span></span>
<span id="cb43-51"><a href="#cb43-51" aria-hidden="true" tabindex="-1"></a><span class="in">        agency == "416" &amp; appr_org=="20", 0, eehc) ) %&gt;%</span></span>
<span id="cb43-52"><a href="#cb43-52" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb43-53"><a href="#cb43-53" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(expenditure = ifelse(eehc=="0", 0, expenditure)) %&gt;%</span></span>
<span id="cb43-54"><a href="#cb43-54" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb43-55"><a href="#cb43-55" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(agency = case_when(   # turns specific items into State Employee Healthcare (agency=904)</span></span>
<span id="cb43-56"><a href="#cb43-56" aria-hidden="true" tabindex="-1"></a><span class="in">      fund=="0907" &amp; (agency=="416" &amp; appr_org=="20") ~ "904",   # central management Bureau of benefits using health insurance reserve </span></span>
<span id="cb43-57"><a href="#cb43-57" aria-hidden="true" tabindex="-1"></a><span class="in">      fund=="0907" &amp; (agency=="478" &amp; appr_org=="80") ~ "904",   # agency = 478: healthcare &amp; family services using health insurance reserve - stopped using this in 2012</span></span>
<span id="cb43-58"><a href="#cb43-58" aria-hidden="true" tabindex="-1"></a><span class="in">      TRUE ~ as.character(agency))) %&gt;%</span></span>
<span id="cb43-59"><a href="#cb43-59" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(agency_name = ifelse(</span></span>
<span id="cb43-60"><a href="#cb43-60" aria-hidden="true" tabindex="-1"></a><span class="in">    agency == "904", "STATE EMPLOYEE HEALTHCARE", as.character(agency_name)),</span></span>
<span id="cb43-61"><a href="#cb43-61" aria-hidden="true" tabindex="-1"></a><span class="in">         in_ff = ifelse( agency == "904", 1, in_ff),</span></span>
<span id="cb43-62"><a href="#cb43-62" aria-hidden="true" tabindex="-1"></a><span class="in">         group = ifelse(agency == "904", "904", as.character(agency)))  </span></span>
<span id="cb43-63"><a href="#cb43-63" aria-hidden="true" tabindex="-1"></a><span class="in"># creates group variable</span></span>
<span id="cb43-64"><a href="#cb43-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-65"><a href="#cb43-65" aria-hidden="true" tabindex="-1"></a><span class="in"># Default group = agency number</span></span>
<span id="cb43-66"><a href="#cb43-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-67"><a href="#cb43-67" aria-hidden="true" tabindex="-1"></a><span class="in">healthcare_costs &lt;- exp_temp %&gt;% filter(group == "904")</span></span>
<span id="cb43-68"><a href="#cb43-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-69"><a href="#cb43-69" aria-hidden="true" tabindex="-1"></a><span class="in">healthcare_costs</span></span>
<span id="cb43-70"><a href="#cb43-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-71"><a href="#cb43-71" aria-hidden="true" tabindex="-1"></a><span class="in">exp_temp &lt;- exp_temp %&gt;% </span></span>
<span id="cb43-72"><a href="#cb43-72" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb43-73"><a href="#cb43-73" aria-hidden="true" tabindex="-1"></a><span class="in">    agency = case_when(fund=="0515" &amp; object=="4470" &amp; type=="08" ~ "971", # income tax to local governments</span></span>
<span id="cb43-74"><a href="#cb43-74" aria-hidden="true" tabindex="-1"></a><span class="in">                     fund=="0515" &amp; object=="4491" &amp; type=="08" &amp; sequence=="00" ~ "971", # object is shared revenue payments</span></span>
<span id="cb43-75"><a href="#cb43-75" aria-hidden="true" tabindex="-1"></a><span class="in">                     fund=="0802" &amp; object=="4491" ~ "972", #pprt transfer</span></span>
<span id="cb43-76"><a href="#cb43-76" aria-hidden="true" tabindex="-1"></a><span class="in">                     fund=="0515" &amp; object=="4491" &amp; type=="08" &amp; sequence=="01" ~ "976", #gst to local</span></span>
<span id="cb43-77"><a href="#cb43-77" aria-hidden="true" tabindex="-1"></a><span class="in">                     fund=="0627" &amp; object=="4472"~ "976" , # public transportation fund but no observations exist</span></span>
<span id="cb43-78"><a href="#cb43-78" aria-hidden="true" tabindex="-1"></a><span class="in">                     fund=="0648" &amp; object=="4472" ~ "976", # downstate public transportation, but doesn't exist</span></span>
<span id="cb43-79"><a href="#cb43-79" aria-hidden="true" tabindex="-1"></a><span class="in">                     fund=="0515" &amp; object=="4470" &amp; type=="00" ~ "976", # object 4470 is grants to local governments</span></span>
<span id="cb43-80"><a href="#cb43-80" aria-hidden="true" tabindex="-1"></a><span class="in">                    object=="4491" &amp; (fund=="0188"|fund=="0189") ~ "976",</span></span>
<span id="cb43-81"><a href="#cb43-81" aria-hidden="true" tabindex="-1"></a><span class="in">                     fund=="0187" &amp; object=="4470" ~ "976",</span></span>
<span id="cb43-82"><a href="#cb43-82" aria-hidden="true" tabindex="-1"></a><span class="in">                     fund=="0186" &amp; object=="4470" ~ "976",</span></span>
<span id="cb43-83"><a href="#cb43-83" aria-hidden="true" tabindex="-1"></a><span class="in">                    object=="4491" &amp; (fund=="0413"|fund=="0414"|fund=="0415")  ~ "975", #mft to local</span></span>
<span id="cb43-84"><a href="#cb43-84" aria-hidden="true" tabindex="-1"></a><span class="in">                  fund == "0952"~ "975", # Added Sept 29 2022 AWM. Transportation Renewal MFT</span></span>
<span id="cb43-85"><a href="#cb43-85" aria-hidden="true" tabindex="-1"></a><span class="in">                    TRUE ~ as.character(agency)),</span></span>
<span id="cb43-86"><a href="#cb43-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-87"><a href="#cb43-87" aria-hidden="true" tabindex="-1"></a><span class="in">  agency_name = case_when(agency == "971"~ "INCOME TAX 1/10 TO LOCAL",</span></span>
<span id="cb43-88"><a href="#cb43-88" aria-hidden="true" tabindex="-1"></a><span class="in">                          agency == "972" ~ "PPRT TRANSFER TO LOCAL",</span></span>
<span id="cb43-89"><a href="#cb43-89" aria-hidden="true" tabindex="-1"></a><span class="in">                          agency == "975" ~ "MFT TO LOCAL",</span></span>
<span id="cb43-90"><a href="#cb43-90" aria-hidden="true" tabindex="-1"></a><span class="in">                          agency == "976" ~ "GST TO LOCAL",</span></span>
<span id="cb43-91"><a href="#cb43-91" aria-hidden="true" tabindex="-1"></a><span class="in">                          TRUE~as.character(agency_name)),</span></span>
<span id="cb43-92"><a href="#cb43-92" aria-hidden="true" tabindex="-1"></a><span class="in">  group = ifelse(agency &gt; "970" &amp; agency &lt; "977", as.character(agency), as.character(group)))</span></span>
<span id="cb43-93"><a href="#cb43-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-94"><a href="#cb43-94" aria-hidden="true" tabindex="-1"></a><span class="in">transfers_long &lt;- exp_temp %&gt;% </span></span>
<span id="cb43-95"><a href="#cb43-95" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(group == "971" | group == "972" | group == "975" | group == "976")</span></span>
<span id="cb43-96"><a href="#cb43-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-97"><a href="#cb43-97" aria-hidden="true" tabindex="-1"></a><span class="in">transfers_long %&gt;% </span></span>
<span id="cb43-98"><a href="#cb43-98" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(agency_name, group, fy) %&gt;% </span></span>
<span id="cb43-99"><a href="#cb43-99" aria-hidden="true" tabindex="-1"></a><span class="in">  summarize(expenditure = sum(expenditure, na.rm=TRUE) )%&gt;% </span></span>
<span id="cb43-100"><a href="#cb43-100" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot() + </span></span>
<span id="cb43-101"><a href="#cb43-101" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(aes(x=fy, y = expenditure, color=agency_name)) + </span></span>
<span id="cb43-102"><a href="#cb43-102" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_classic()+</span></span>
<span id="cb43-103"><a href="#cb43-103" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(legend.position = "bottom", legend.title=element_blank())+</span></span>
<span id="cb43-104"><a href="#cb43-104" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "Transfers to Local Governments", </span></span>
<span id="cb43-105"><a href="#cb43-105" aria-hidden="true" tabindex="-1"></a><span class="in">       caption = "Data Source: Illinois Office of the Comptroller")</span></span>
<span id="cb43-106"><a href="#cb43-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-107"><a href="#cb43-107" aria-hidden="true" tabindex="-1"></a><span class="in">transfers &lt;- transfers_long %&gt;%</span></span>
<span id="cb43-108"><a href="#cb43-108" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(fy, group ) %&gt;%</span></span>
<span id="cb43-109"><a href="#cb43-109" aria-hidden="true" tabindex="-1"></a><span class="in">  summarize(sum_expenditure = sum(expenditure)/1000000) %&gt;%</span></span>
<span id="cb43-110"><a href="#cb43-110" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_wider(names_from = "group", values_from = "sum_expenditure", names_prefix = "exp_" )</span></span>
<span id="cb43-111"><a href="#cb43-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-112"><a href="#cb43-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-113"><a href="#cb43-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-114"><a href="#cb43-114" aria-hidden="true" tabindex="-1"></a><span class="in">debt_drop &lt;- exp_temp %&gt;% </span></span>
<span id="cb43-115"><a href="#cb43-115" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(object == "8841" |  object == "8811")  </span></span>
<span id="cb43-116"><a href="#cb43-116" aria-hidden="true" tabindex="-1"></a><span class="in"># escrow  OR  principle</span></span>
<span id="cb43-117"><a href="#cb43-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-118"><a href="#cb43-118" aria-hidden="true" tabindex="-1"></a><span class="in">#debt_drop %&gt;% group_by(fy) %&gt;% summarize(sum = sum(expenditure)) %&gt;% arrange(-fy)</span></span>
<span id="cb43-119"><a href="#cb43-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-120"><a href="#cb43-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-121"><a href="#cb43-121" aria-hidden="true" tabindex="-1"></a><span class="in">debt_keep &lt;- exp_temp %&gt;% mutate(agency = as.character(agency)) %&gt;%</span></span>
<span id="cb43-122"><a href="#cb43-122" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(fund != "0455" &amp; (object == "8813" | object == "8800" )) </span></span>
<span id="cb43-123"><a href="#cb43-123" aria-hidden="true" tabindex="-1"></a><span class="in"># examine the debt costs we want to include</span></span>
<span id="cb43-124"><a href="#cb43-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-125"><a href="#cb43-125" aria-hidden="true" tabindex="-1"></a><span class="in">#debt_keep %&gt;% group_by(fy) %&gt;% summarize(sum = sum(expenditure)) %&gt;% arrange(-fy) </span></span>
<span id="cb43-126"><a href="#cb43-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-127"><a href="#cb43-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-128"><a href="#cb43-128" aria-hidden="true" tabindex="-1"></a><span class="in">exp_temp &lt;- anti_join(exp_temp, debt_drop) </span></span>
<span id="cb43-129"><a href="#cb43-129" aria-hidden="true" tabindex="-1"></a><span class="in">exp_temp &lt;- anti_join(exp_temp, debt_keep)</span></span>
<span id="cb43-130"><a href="#cb43-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-131"><a href="#cb43-131" aria-hidden="true" tabindex="-1"></a><span class="in">debt_keep &lt;- debt_keep %&gt;%</span></span>
<span id="cb43-132"><a href="#cb43-132" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb43-133"><a href="#cb43-133" aria-hidden="true" tabindex="-1"></a><span class="in">    agency = ifelse(fund != "0455" &amp; (object == "8813" | object == "8800"), "903", as.character(agency)),</span></span>
<span id="cb43-134"><a href="#cb43-134" aria-hidden="true" tabindex="-1"></a><span class="in">    group = ifelse(fund != "0455" &amp; (object == "8813" | object == "8800"), "903", as.character(group)),</span></span>
<span id="cb43-135"><a href="#cb43-135" aria-hidden="true" tabindex="-1"></a><span class="in">    in_ff = ifelse(group == "903", 1, as.character(in_ff)))</span></span>
<span id="cb43-136"><a href="#cb43-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-137"><a href="#cb43-137" aria-hidden="true" tabindex="-1"></a><span class="in">debt_keep_yearly &lt;- debt_keep %&gt;% group_by(fy, group) %&gt;% summarize(debt_cost = sum(expenditure,na.rm=TRUE)/1000000) %&gt;% select(-group)</span></span>
<span id="cb43-138"><a href="#cb43-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-139"><a href="#cb43-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-140"><a href="#cb43-140" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-141"><a href="#cb43-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-142"><a href="#cb43-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-145"><a href="#cb43-145" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-146"><a href="#cb43-146" aria-hidden="true" tabindex="-1"></a>exp_temp <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/all_expenditures_recoded.csv"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-147"><a href="#cb43-147" aria-hidden="true" tabindex="-1"></a><span class="co">#exp_temp &lt;- read.csv("data/exp_fy23_recoded_02April2024.csv") %&gt;% </span></span>
<span id="cb43-148"><a href="#cb43-148" aria-hidden="true" tabindex="-1"></a><span class="co">#exp_temp &lt;- read.csv("data/exp_temp.csv") %&gt;% </span></span>
<span id="cb43-149"><a href="#cb43-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">agency =</span> <span class="fu">as.character</span>(agency),</span>
<span id="cb43-150"><a href="#cb43-150" aria-hidden="true" tabindex="-1"></a>         <span class="at">object =</span> <span class="fu">as.character</span>(object),</span>
<span id="cb43-151"><a href="#cb43-151" aria-hidden="true" tabindex="-1"></a>         <span class="at">object =</span> <span class="fu">str_pad</span>(object, <span class="at">side =</span> <span class="st">"left"</span>, <span class="dv">4</span>, <span class="at">pad =</span> <span class="st">"0"</span>),</span>
<span id="cb43-152"><a href="#cb43-152" aria-hidden="true" tabindex="-1"></a>         <span class="at">sequence =</span> <span class="fu">as.character</span>(sequence),</span>
<span id="cb43-153"><a href="#cb43-153" aria-hidden="true" tabindex="-1"></a>         <span class="at">sequence =</span> <span class="fu">str_pad</span>(sequence, <span class="at">side =</span> <span class="st">"left"</span>, <span class="dv">2</span>, <span class="at">pad =</span> <span class="st">"0"</span>),</span>
<span id="cb43-154"><a href="#cb43-154" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="fu">as.character</span>(type),</span>
<span id="cb43-155"><a href="#cb43-155" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="fu">str_pad</span>(type, <span class="at">side =</span> <span class="st">"left"</span>, <span class="dv">2</span>, <span class="at">pad =</span> <span class="st">"0"</span>),</span>
<span id="cb43-156"><a href="#cb43-156" aria-hidden="true" tabindex="-1"></a>         <span class="at">appr_org =</span> <span class="fu">as.character</span>(appr_org),</span>
<span id="cb43-157"><a href="#cb43-157" aria-hidden="true" tabindex="-1"></a>         <span class="at">appr_org =</span> <span class="fu">str_pad</span>(appr_org, <span class="at">side =</span> <span class="st">"left"</span>, <span class="dv">2</span>, <span class="at">pad =</span> <span class="st">"0"</span>),</span>
<span id="cb43-158"><a href="#cb43-158" aria-hidden="true" tabindex="-1"></a>         <span class="at">fund =</span> <span class="fu">as.character</span>(fund),</span>
<span id="cb43-159"><a href="#cb43-159" aria-hidden="true" tabindex="-1"></a>         <span class="at">fund =</span> <span class="fu">str_pad</span>(fund, <span class="at">side =</span> <span class="st">"left"</span>, <span class="dv">4</span>, <span class="at">pad =</span> <span class="st">"0"</span>))</span>
<span id="cb43-160"><a href="#cb43-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-161"><a href="#cb43-161" aria-hidden="true" tabindex="-1"></a><span class="co"># rev_temp &lt;- read.csv("data/rev_temp.csv") %&gt;%</span></span>
<span id="cb43-162"><a href="#cb43-162" aria-hidden="true" tabindex="-1"></a> <span class="co"># rev_temp &lt;- read.csv("data/rev_fy23_recoded_02April2024.csv") %&gt;%</span></span>
<span id="cb43-163"><a href="#cb43-163" aria-hidden="true" tabindex="-1"></a>rev_temp <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/all_revenue_recoded.csv"</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb43-164"><a href="#cb43-164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rev_type =</span> <span class="fu">as.character</span>(rev_type),</span>
<span id="cb43-165"><a href="#cb43-165" aria-hidden="true" tabindex="-1"></a>         <span class="at">agency =</span> <span class="fu">as.character</span>(agency),</span>
<span id="cb43-166"><a href="#cb43-166" aria-hidden="true" tabindex="-1"></a>            <span class="at">fund =</span> <span class="fu">str_pad</span>(fund, <span class="at">side =</span> <span class="st">"left"</span>, <span class="dv">4</span>, <span class="at">pad =</span> <span class="st">"0"</span>)) </span>
<span id="cb43-167"><a href="#cb43-167" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-168"><a href="#cb43-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-169"><a href="#cb43-169" aria-hidden="true" tabindex="-1"></a>**Dropping State CURE Revenue**</span>
<span id="cb43-170"><a href="#cb43-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-171"><a href="#cb43-171" aria-hidden="true" tabindex="-1"></a>The Fiscal Futures model focuses on sustainable revenue sources. To understand our fiscal gap and outlook, we need to exclude these one time revenues. GOMB has emphasized that they have allocated COVID dollars to one time expenditures (unemployment trust fund, budget stabilization fund, etc.). The fiscal gap, graphs,and CAGRs have been recalculated in the <span class="sc">\[</span>Drop COVID Dollars<span class="sc">\]</span> section below.</span>
<span id="cb43-172"><a href="#cb43-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-173"><a href="#cb43-173" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; NOTE: The code chunk below only drops revenue sources with the source name of "Federal Stimulus Package" (which is the State and Local CURE revenue). Additional federal money went into other funds during the beginning of pandemic. Many departments saw increased grants and received other funds (e.g. funds)</span></span>
<span id="cb43-174"><a href="#cb43-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-175"><a href="#cb43-175" aria-hidden="true" tabindex="-1"></a><span class="in">```{r }</span></span>
<span id="cb43-176"><a href="#cb43-176" aria-hidden="true" tabindex="-1"></a><span class="in">rev_temp &lt;- rev_temp %&gt;% </span></span>
<span id="cb43-177"><a href="#cb43-177" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(covid_dollars = ifelse(source_name_AWM == "FEDERAL STIMULUS PACKAGE",1,0))</span></span>
<span id="cb43-178"><a href="#cb43-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-179"><a href="#cb43-179" aria-hidden="true" tabindex="-1"></a><span class="in"># rev_temp %&gt;% filter(source_name_AWM == "FEDERAL STIMULUS PACKAGE") %&gt;%</span></span>
<span id="cb43-180"><a href="#cb43-180" aria-hidden="true" tabindex="-1"></a><span class="in">#  group_by(fy) %&gt;% summarize(Received = sum(receipts))</span></span>
<span id="cb43-181"><a href="#cb43-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-182"><a href="#cb43-182" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-183"><a href="#cb43-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-184"><a href="#cb43-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-185"><a href="#cb43-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-186"><a href="#cb43-186" aria-hidden="true" tabindex="-1"></a><span class="fu">## With Federal Stimulus from COVID Response</span></span>
<span id="cb43-187"><a href="#cb43-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-188"><a href="#cb43-188" aria-hidden="true" tabindex="-1"></a>If only sustainable revenues are included in the model, then the federal dollars from the pandemic response (CARES, CRSSA,&amp; ARPA) should be excluded from the calculation of the fiscal gap.</span>
<span id="cb43-189"><a href="#cb43-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-190"><a href="#cb43-190" aria-hidden="true" tabindex="-1"></a>The Fiscal Futures model focuses on sustainable revenue sources. To understand our fiscal gap and outlook, we need to exclude these one time revenues. GOMB has emphasized that they have allocated COVID dollars to one time expenditures (unemployment trust fund, budget stabilization fund, etc.). The fiscal gap, graphs,and CAGRs have been recalculated in the <span class="co">[</span><span class="ot">Drop COVID Dollars</span><span class="co">]</span> section below.</span>
<span id="cb43-191"><a href="#cb43-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-192"><a href="#cb43-192" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; NOTE: I have only dropped revenue with a source name = </span><span class="in">`Federal Stimulus Package`</span><span class="at">. Federal money went into other funds during the beginning of pandemic. All additional money for medicaid reimbursements and healthcare provider funds were not considered "Federal Stimulus Package" in the data and were not dropped.</span></span>
<span id="cb43-193"><a href="#cb43-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-194"><a href="#cb43-194" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>fund 0628 is essential government support services. Money in the fund is appropriated to cover COVID-19 related expenses. It should be included in our analytical frame based on criteria 2 and6 --- the fund supports an important state function about public safety, which would have to be performed even the fund structure were not existed. Public safety is supported by a combination of departments and boards, including IL Emergency Management Agency, which is the administering agency of the fund.</span>
<span id="cb43-195"><a href="#cb43-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-196"><a href="#cb43-196" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Education Stabilization Fund\</span>
<span id="cb43-197"><a href="#cb43-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-198"><a href="#cb43-198" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>ESSER 1, 2, and 3\</span>
<span id="cb43-199"><a href="#cb43-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-200"><a href="#cb43-200" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>CSLFRF (State and Local CURE)\</span>
<span id="cb43-201"><a href="#cb43-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-202"><a href="#cb43-202" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Provider Relief Fund\</span>
<span id="cb43-203"><a href="#cb43-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-204"><a href="#cb43-204" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Coronavirus Relief Fund (CRF)\</span>
<span id="cb43-205"><a href="#cb43-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-206"><a href="#cb43-206" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Consolidated Appropriations Act 2020\</span>
<span id="cb43-207"><a href="#cb43-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-208"><a href="#cb43-208" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Families First Coronavirus Response Act\</span>
<span id="cb43-209"><a href="#cb43-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-210"><a href="#cb43-210" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Paycheck Protection Program and Health Care Enhancement Act</span>
<span id="cb43-211"><a href="#cb43-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-212"><a href="#cb43-212" aria-hidden="true" tabindex="-1"></a>Need to recreate ff_exp and ff_rev totals without stimulus dollars.</span>
<span id="cb43-213"><a href="#cb43-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-214"><a href="#cb43-214" aria-hidden="true" tabindex="-1"></a><span class="in">```{r withcure}</span></span>
<span id="cb43-215"><a href="#cb43-215" aria-hidden="true" tabindex="-1"></a><span class="in">ff_rev &lt;- rev_temp %&gt;%   </span></span>
<span id="cb43-216"><a href="#cb43-216" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(rev_type_new = str_pad(rev_type_new, 2, "left", pad = "0")) %&gt;%</span></span>
<span id="cb43-217"><a href="#cb43-217" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(rev_type_new, fy) %&gt;% </span></span>
<span id="cb43-218"><a href="#cb43-218" aria-hidden="true" tabindex="-1"></a><span class="in">  summarize(sum_receipts = round(sum(receipts, na.rm=TRUE)/1000000 )) %&gt;%</span></span>
<span id="cb43-219"><a href="#cb43-219" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_wider(names_from = "rev_type_new", values_from = "sum_receipts", names_prefix = "rev_")</span></span>
<span id="cb43-220"><a href="#cb43-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-221"><a href="#cb43-221" aria-hidden="true" tabindex="-1"></a><span class="in">ff_rev &lt;- mutate_all(ff_rev, ~replace_na(.,0))</span></span>
<span id="cb43-222"><a href="#cb43-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-223"><a href="#cb43-223" aria-hidden="true" tabindex="-1"></a><span class="in">rev_long &lt;- pivot_longer(ff_rev, rev_02:rev_78, names_to = c("type","Category"), values_to = "Dollars", names_sep = "_") %&gt;% </span></span>
<span id="cb43-224"><a href="#cb43-224" aria-hidden="true" tabindex="-1"></a><span class="in">  rename(Year = fy) %&gt;%</span></span>
<span id="cb43-225"><a href="#cb43-225" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(Category_name = case_when(</span></span>
<span id="cb43-226"><a href="#cb43-226" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "02" ~ "INDIVIDUAL INCOME TAX" ,</span></span>
<span id="cb43-227"><a href="#cb43-227" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "03" ~ "CORPORATE INCOME TAX" ,</span></span>
<span id="cb43-228"><a href="#cb43-228" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "06" ~ "SALES TAX" ,</span></span>
<span id="cb43-229"><a href="#cb43-229" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "09" ~ "MOTOR FUEL TAX" ,</span></span>
<span id="cb43-230"><a href="#cb43-230" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "12" ~ "PUBLIC UTILITY TAX" ,</span></span>
<span id="cb43-231"><a href="#cb43-231" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "15" ~ "CIGARETTE TAXES" ,</span></span>
<span id="cb43-232"><a href="#cb43-232" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "18" ~ "LIQUOR GALLONAGE TAXES" ,</span></span>
<span id="cb43-233"><a href="#cb43-233" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "21" ~ "INHERITANCE TAX" ,</span></span>
<span id="cb43-234"><a href="#cb43-234" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "24" ~ "INSURANCE TAXES&amp;FEES&amp;LICENSES" ,</span></span>
<span id="cb43-235"><a href="#cb43-235" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "27" ~ "CORP FRANCHISE TAXES &amp; FEES" ,</span></span>
<span id="cb43-236"><a href="#cb43-236" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "30" ~ "HORSE RACING TAXES &amp; FEES",  # in Other</span></span>
<span id="cb43-237"><a href="#cb43-237" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "31" ~ "MEDICAL PROVIDER ASSESSMENTS" ,</span></span>
<span id="cb43-238"><a href="#cb43-238" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "32" ~ "GARNISHMENT-LEVIES" , # dropped</span></span>
<span id="cb43-239"><a href="#cb43-239" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "33" ~  "LOTTERY RECEIPTS" ,</span></span>
<span id="cb43-240"><a href="#cb43-240" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "35" ~  "OTHER TAXES" ,</span></span>
<span id="cb43-241"><a href="#cb43-241" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "36" ~  "RECEIPTS FROM REVENUE PRODUCING", </span></span>
<span id="cb43-242"><a href="#cb43-242" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "39" ~  "LICENSES, FEES &amp; REGISTRATIONS" ,</span></span>
<span id="cb43-243"><a href="#cb43-243" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "42" ~  "MOTOR VEHICLE AND OPERATORS" ,</span></span>
<span id="cb43-244"><a href="#cb43-244" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "45" ~  "STUDENT FEES-UNIVERSITIES",   # dropped</span></span>
<span id="cb43-245"><a href="#cb43-245" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "48" ~  "RIVERBOAT WAGERING TAXES" ,</span></span>
<span id="cb43-246"><a href="#cb43-246" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "51" ~  "RETIREMENT CONTRIBUTIONS" , # dropped</span></span>
<span id="cb43-247"><a href="#cb43-247" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "54" ~ "GIFTS AND BEQUESTS", </span></span>
<span id="cb43-248"><a href="#cb43-248" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "57" ~  "FEDERAL OTHER" ,</span></span>
<span id="cb43-249"><a href="#cb43-249" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "58" ~  "FEDERAL MEDICAID", </span></span>
<span id="cb43-250"><a href="#cb43-250" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "59" ~  "FEDERAL TRANSPORTATION" ,</span></span>
<span id="cb43-251"><a href="#cb43-251" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "60" ~  "OTHER GRANTS AND CONTRACTS", #other</span></span>
<span id="cb43-252"><a href="#cb43-252" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "63" ~  "INVESTMENT INCOME", # other</span></span>
<span id="cb43-253"><a href="#cb43-253" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "66" ~ "PROCEEDS,INVESTMENT MATURITIES" , #dropped</span></span>
<span id="cb43-254"><a href="#cb43-254" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "72" ~ "BOND ISSUE PROCEEDS",  #dropped</span></span>
<span id="cb43-255"><a href="#cb43-255" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "75" ~  "INTER-AGENCY RECEIPTS ",  #dropped</span></span>
<span id="cb43-256"><a href="#cb43-256" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "76" ~  "TRANSFER IN FROM OUT FUNDS",  #other</span></span>
<span id="cb43-257"><a href="#cb43-257" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "78" ~  "ALL OTHER SOURCES" ,</span></span>
<span id="cb43-258"><a href="#cb43-258" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "79" ~   "COOK COUNTY IGT", #dropped</span></span>
<span id="cb43-259"><a href="#cb43-259" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "98" ~  "PRIOR YEAR REFUNDS", #dropped</span></span>
<span id="cb43-260"><a href="#cb43-260" aria-hidden="true" tabindex="-1"></a><span class="in">                 T ~ "Check Me!"</span></span>
<span id="cb43-261"><a href="#cb43-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-262"><a href="#cb43-262" aria-hidden="true" tabindex="-1"></a><span class="in">  ) )%&gt;% </span></span>
<span id="cb43-263"><a href="#cb43-263" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(Category_name = str_to_title(Category_name))</span></span>
<span id="cb43-264"><a href="#cb43-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-265"><a href="#cb43-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-266"><a href="#cb43-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-267"><a href="#cb43-267" aria-hidden="true" tabindex="-1"></a><span class="in">exp_temp &lt;- read_csv("data/all_expenditures_recoded.csv") %&gt;%</span></span>
<span id="cb43-268"><a href="#cb43-268" aria-hidden="true" tabindex="-1"></a><span class="in">#exp_temp &lt;- read.csv("data/exp_fy23_recoded_02April2024.csv") %&gt;% </span></span>
<span id="cb43-269"><a href="#cb43-269" aria-hidden="true" tabindex="-1"></a><span class="in">#exp_temp &lt;- read.csv("data/exp_temp.csv") %&gt;% </span></span>
<span id="cb43-270"><a href="#cb43-270" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(agency = as.character(agency),</span></span>
<span id="cb43-271"><a href="#cb43-271" aria-hidden="true" tabindex="-1"></a><span class="in">         object = as.character(object),</span></span>
<span id="cb43-272"><a href="#cb43-272" aria-hidden="true" tabindex="-1"></a><span class="in">         object = str_pad(object, side = "left", 4, pad = "0"),</span></span>
<span id="cb43-273"><a href="#cb43-273" aria-hidden="true" tabindex="-1"></a><span class="in">         obj_seq_type = as.character(obj_seq_type),</span></span>
<span id="cb43-274"><a href="#cb43-274" aria-hidden="true" tabindex="-1"></a><span class="in">         sequence = as.character(sequence),</span></span>
<span id="cb43-275"><a href="#cb43-275" aria-hidden="true" tabindex="-1"></a><span class="in">         sequence = str_pad(sequence, side = "left", 2, pad = "0"),</span></span>
<span id="cb43-276"><a href="#cb43-276" aria-hidden="true" tabindex="-1"></a><span class="in">         type = as.character(type),</span></span>
<span id="cb43-277"><a href="#cb43-277" aria-hidden="true" tabindex="-1"></a><span class="in">         type = str_pad(type, side = "left", 2, pad = "0"),</span></span>
<span id="cb43-278"><a href="#cb43-278" aria-hidden="true" tabindex="-1"></a><span class="in">         appr_org = as.character(appr_org),</span></span>
<span id="cb43-279"><a href="#cb43-279" aria-hidden="true" tabindex="-1"></a><span class="in">         appr_org = str_pad(appr_org, side = "left", 2, pad = "0"),</span></span>
<span id="cb43-280"><a href="#cb43-280" aria-hidden="true" tabindex="-1"></a><span class="in">         fund = as.character(fund),</span></span>
<span id="cb43-281"><a href="#cb43-281" aria-hidden="true" tabindex="-1"></a><span class="in">         fund = str_pad(fund, side = "left", 4, pad = "0"),</span></span>
<span id="cb43-282"><a href="#cb43-282" aria-hidden="true" tabindex="-1"></a><span class="in">         group = as.character(group))</span></span>
<span id="cb43-283"><a href="#cb43-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-284"><a href="#cb43-284" aria-hidden="true" tabindex="-1"></a><span class="in">exp_temp %&gt;% filter(group_name == "Check name")</span></span>
<span id="cb43-285"><a href="#cb43-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-286"><a href="#cb43-286" aria-hidden="true" tabindex="-1"></a><span class="in">exp_temp &lt;- anti_join(exp_temp, transfers_long)</span></span>
<span id="cb43-287"><a href="#cb43-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-288"><a href="#cb43-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-289"><a href="#cb43-289" aria-hidden="true" tabindex="-1"></a><span class="in">ff_exp &lt;- exp_temp %&gt;% </span></span>
<span id="cb43-290"><a href="#cb43-290" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(fy, group) %&gt;% </span></span>
<span id="cb43-291"><a href="#cb43-291" aria-hidden="true" tabindex="-1"></a><span class="in">  summarize(sum_expenditures = round(sum(expenditure, na.rm=TRUE)/1000000 )) %&gt;%</span></span>
<span id="cb43-292"><a href="#cb43-292" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_wider(names_from = "group", values_from = "sum_expenditures", names_prefix = "exp_")%&gt;%</span></span>
<span id="cb43-293"><a href="#cb43-293" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb43-294"><a href="#cb43-294" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(debt_keep_yearly) %&gt;%</span></span>
<span id="cb43-295"><a href="#cb43-295" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(exp_903 = debt_cost) %&gt;%</span></span>
<span id="cb43-296"><a href="#cb43-296" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(transfers)  %&gt;%</span></span>
<span id="cb43-297"><a href="#cb43-297" aria-hidden="true" tabindex="-1"></a><span class="in"> mutate(exp_970 = exp_971 + exp_972  + exp_975 + exp_976)</span></span>
<span id="cb43-298"><a href="#cb43-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-299"><a href="#cb43-299" aria-hidden="true" tabindex="-1"></a><span class="in">ff_exp&lt;- ff_exp %&gt;% select(-c(debt_cost, exp_971:exp_976)) # drop unwanted columns</span></span>
<span id="cb43-300"><a href="#cb43-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-301"><a href="#cb43-301" aria-hidden="true" tabindex="-1"></a><span class="in">exp_long &lt;- pivot_longer(ff_exp, exp_402:exp_970 , names_to = c("type", "Category"), values_to = "Dollars", names_sep = "_") %&gt;% </span></span>
<span id="cb43-302"><a href="#cb43-302" aria-hidden="true" tabindex="-1"></a><span class="in">  rename(Year = fy ) %&gt;% </span></span>
<span id="cb43-303"><a href="#cb43-303" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(Category_name = </span></span>
<span id="cb43-304"><a href="#cb43-304" aria-hidden="true" tabindex="-1"></a><span class="in">           case_when(</span></span>
<span id="cb43-305"><a href="#cb43-305" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "402" ~ "AGING" ,</span></span>
<span id="cb43-306"><a href="#cb43-306" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "406" ~ "AGRICULTURE", </span></span>
<span id="cb43-307"><a href="#cb43-307" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "416" ~ "CENTRAL MANAGEMENT",</span></span>
<span id="cb43-308"><a href="#cb43-308" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "418" ~ "CHILDREN AND FAMILY SERVICES", </span></span>
<span id="cb43-309"><a href="#cb43-309" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "420" ~ "COMMERCE AND ECONOMIC OPPORTUNITY",</span></span>
<span id="cb43-310"><a href="#cb43-310" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "422" ~ "NATURAL RESOURCES" ,</span></span>
<span id="cb43-311"><a href="#cb43-311" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "426" ~ "CORRECTIONS",</span></span>
<span id="cb43-312"><a href="#cb43-312" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "427" ~ "EMPLOYMENT SECURITY" ,</span></span>
<span id="cb43-313"><a href="#cb43-313" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "444" ~ "HUMAN SERVICES" ,</span></span>
<span id="cb43-314"><a href="#cb43-314" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "448" ~ "Innovation and Technology", # AWM added fy2022</span></span>
<span id="cb43-315"><a href="#cb43-315" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "478" ~ "HEALTHCARE &amp; FAM SER NET OF MEDICAID", </span></span>
<span id="cb43-316"><a href="#cb43-316" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "482" ~ "PUBLIC HEALTH", </span></span>
<span id="cb43-317"><a href="#cb43-317" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "492" ~ "REVENUE", </span></span>
<span id="cb43-318"><a href="#cb43-318" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "494" ~ "TRANSPORTATION" ,</span></span>
<span id="cb43-319"><a href="#cb43-319" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "532" ~ "ENVIRONMENTAL PROTECT AGENCY" ,</span></span>
<span id="cb43-320"><a href="#cb43-320" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "557" ~ "IL STATE TOLL HIGHWAY AUTH" ,</span></span>
<span id="cb43-321"><a href="#cb43-321" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "684" ~ "IL COMMUNITY COLLEGE BOARD", </span></span>
<span id="cb43-322"><a href="#cb43-322" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "691" ~ "IL STUDENT ASSISTANCE COMM" ,</span></span>
<span id="cb43-323"><a href="#cb43-323" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "900" ~ "NOT IN FRAME",</span></span>
<span id="cb43-324"><a href="#cb43-324" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "901" ~ "STATE PENSION CONTRIBUTION",</span></span>
<span id="cb43-325"><a href="#cb43-325" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "903" ~ "DEBT SERVICE",</span></span>
<span id="cb43-326"><a href="#cb43-326" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "904" ~ "State Employee Healthcare",</span></span>
<span id="cb43-327"><a href="#cb43-327" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "910" ~ "LEGISLATIVE"  ,</span></span>
<span id="cb43-328"><a href="#cb43-328" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "920" ~ "JUDICIAL" ,</span></span>
<span id="cb43-329"><a href="#cb43-329" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "930" ~ "ELECTED OFFICERS" , </span></span>
<span id="cb43-330"><a href="#cb43-330" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "940" ~ "OTHER HEALTH-RELATED", </span></span>
<span id="cb43-331"><a href="#cb43-331" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "941" ~ "PUBLIC SAFETY" ,</span></span>
<span id="cb43-332"><a href="#cb43-332" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "942" ~ "ECON DEVT &amp; INFRASTRUCTURE" ,</span></span>
<span id="cb43-333"><a href="#cb43-333" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "943" ~ "CENTRAL SERVICES",</span></span>
<span id="cb43-334"><a href="#cb43-334" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "944" ~ "BUS &amp; PROFESSION REGULATION" ,</span></span>
<span id="cb43-335"><a href="#cb43-335" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "945" ~ "MEDICAID" ,</span></span>
<span id="cb43-336"><a href="#cb43-336" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "946" ~ "CAPITAL IMPROVEMENT" , </span></span>
<span id="cb43-337"><a href="#cb43-337" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "948" ~ "OTHER DEPARTMENTS" ,</span></span>
<span id="cb43-338"><a href="#cb43-338" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "949" ~ "OTHER BOARDS &amp; COMMISSIONS" ,</span></span>
<span id="cb43-339"><a href="#cb43-339" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "959" ~ "K-12 EDUCATION" ,</span></span>
<span id="cb43-340"><a href="#cb43-340" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "960" ~ "UNIVERSITY EDUCATION",</span></span>
<span id="cb43-341"><a href="#cb43-341" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "970" ~ "Local Govt Transfers",</span></span>
<span id="cb43-342"><a href="#cb43-342" aria-hidden="true" tabindex="-1"></a><span class="in">             T ~ "CHECK ME!")</span></span>
<span id="cb43-343"><a href="#cb43-343" aria-hidden="true" tabindex="-1"></a><span class="in">           ) %&gt;% </span></span>
<span id="cb43-344"><a href="#cb43-344" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(Category_name = str_to_title(Category_name))</span></span>
<span id="cb43-345"><a href="#cb43-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-346"><a href="#cb43-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-347"><a href="#cb43-347" aria-hidden="true" tabindex="-1"></a><span class="in">#exp_long_nototals &lt;- exp_long %&gt;% filter(Category_name != "Totals")</span></span>
<span id="cb43-348"><a href="#cb43-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-349"><a href="#cb43-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-350"><a href="#cb43-350" aria-hidden="true" tabindex="-1"></a><span class="in">aggregated_totals_long &lt;- rbind(rev_long, exp_long) </span></span>
<span id="cb43-351"><a href="#cb43-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-352"><a href="#cb43-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-353"><a href="#cb43-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-354"><a href="#cb43-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-355"><a href="#cb43-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-356"><a href="#cb43-356" aria-hidden="true" tabindex="-1"></a><span class="in">year_totals &lt;- aggregated_totals_long %&gt;% </span></span>
<span id="cb43-357"><a href="#cb43-357" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(type, Year) %&gt;% </span></span>
<span id="cb43-358"><a href="#cb43-358" aria-hidden="true" tabindex="-1"></a><span class="in">  summarize(Dollars = sum(Dollars, na.rm = TRUE)) %&gt;% </span></span>
<span id="cb43-359"><a href="#cb43-359" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_wider(names_from = "type", values_from = Dollars) %&gt;% </span></span>
<span id="cb43-360"><a href="#cb43-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-361"><a href="#cb43-361" aria-hidden="true" tabindex="-1"></a><span class="in">  rename(Expenditures = exp,</span></span>
<span id="cb43-362"><a href="#cb43-362" aria-hidden="true" tabindex="-1"></a><span class="in">         Revenue = rev) %&gt;%  </span></span>
<span id="cb43-363"><a href="#cb43-363" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(`Fiscal Gap` = Revenue - Expenditures)</span></span>
<span id="cb43-364"><a href="#cb43-364" aria-hidden="true" tabindex="-1"></a><span class="in"># %&gt;%  arrange(desc(Year))</span></span>
<span id="cb43-365"><a href="#cb43-365" aria-hidden="true" tabindex="-1"></a><span class="in"># creates variable for the Gap each year</span></span>
<span id="cb43-366"><a href="#cb43-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-367"><a href="#cb43-367" aria-hidden="true" tabindex="-1"></a><span class="in">year_totals  %&gt;%  </span></span>
<span id="cb43-368"><a href="#cb43-368" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate_all(., ~round(., digits = 0)) %&gt;%</span></span>
<span id="cb43-369"><a href="#cb43-369" aria-hidden="true" tabindex="-1"></a><span class="in">  kbl(caption = "Fiscal Gap for each Fiscal Year ($ Millions)") %&gt;% </span></span>
<span id="cb43-370"><a href="#cb43-370" aria-hidden="true" tabindex="-1"></a><span class="in">  kable_styling(bootstrap_options = c("striped"))  %&gt;%</span></span>
<span id="cb43-371"><a href="#cb43-371" aria-hidden="true" tabindex="-1"></a><span class="in">  kable_classic() %&gt;%   </span></span>
<span id="cb43-372"><a href="#cb43-372" aria-hidden="true" tabindex="-1"></a><span class="in">  add_footnote(c("Values include State CURE dollars (SLFRF)"))</span></span>
<span id="cb43-373"><a href="#cb43-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-374"><a href="#cb43-374" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-375"><a href="#cb43-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-376"><a href="#cb43-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-377"><a href="#cb43-377" aria-hidden="true" tabindex="-1"></a><span class="fu">## Drop State CURE Federal Stimulus Funds</span></span>
<span id="cb43-378"><a href="#cb43-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-379"><a href="#cb43-379" aria-hidden="true" tabindex="-1"></a><span class="in">```{r drop-coviddollars}</span></span>
<span id="cb43-380"><a href="#cb43-380" aria-hidden="true" tabindex="-1"></a><span class="in"># does not include rev_type == 58, medicaid dollars</span></span>
<span id="cb43-381"><a href="#cb43-381" aria-hidden="true" tabindex="-1"></a><span class="in">covid_dollars_rev &lt;- rev_temp %&gt;% filter(covid_dollars==1) # check what was dropped</span></span>
<span id="cb43-382"><a href="#cb43-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-383"><a href="#cb43-383" aria-hidden="true" tabindex="-1"></a><span class="in">covid_dollars_rev %&gt;% group_by(fy, agency_name) %&gt;% </span></span>
<span id="cb43-384"><a href="#cb43-384" aria-hidden="true" tabindex="-1"></a><span class="in">  summarize(receipts = sum(receipts)) %&gt;% </span></span>
<span id="cb43-385"><a href="#cb43-385" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_wider(names_from="agency_name", values_from = "receipts") %&gt;% arrange(-fy)</span></span>
<span id="cb43-386"><a href="#cb43-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-387"><a href="#cb43-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-388"><a href="#cb43-388" aria-hidden="true" tabindex="-1"></a><span class="in">covid_dollars_rev %&gt;% group_by(fy, fund_name_ab) %&gt;% </span></span>
<span id="cb43-389"><a href="#cb43-389" aria-hidden="true" tabindex="-1"></a><span class="in">  summarize(receipts = sum(receipts)) %&gt;% </span></span>
<span id="cb43-390"><a href="#cb43-390" aria-hidden="true" tabindex="-1"></a><span class="in">  arrange(-fy) %&gt;%</span></span>
<span id="cb43-391"><a href="#cb43-391" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_wider(names_from="fy", values_from = "receipts")</span></span>
<span id="cb43-392"><a href="#cb43-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-393"><a href="#cb43-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-394"><a href="#cb43-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-395"><a href="#cb43-395" aria-hidden="true" tabindex="-1"></a><span class="in">K12_ESSER_words &lt;- c("CRRSA","ESSER","EMER R", "EMR R", "CARES", "AMER R", "EMER ED")</span></span>
<span id="cb43-396"><a href="#cb43-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-397"><a href="#cb43-397" aria-hidden="true" tabindex="-1"></a><span class="in">ESSER_exp &lt;- exp_temp %&gt;% </span></span>
<span id="cb43-398"><a href="#cb43-398" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(agency_name == "STATE BOARD OF EDUCATION") %&gt;%</span></span>
<span id="cb43-399"><a href="#cb43-399" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(ESSERfunds = case_when(</span></span>
<span id="cb43-400"><a href="#cb43-400" aria-hidden="true" tabindex="-1"></a><span class="in">    str_detect(wh_approp_name, "CRRSA") ~ "ESSER",</span></span>
<span id="cb43-401"><a href="#cb43-401" aria-hidden="true" tabindex="-1"></a><span class="in">    str_detect(wh_approp_name, "ESSER") ~ "ESSER",</span></span>
<span id="cb43-402"><a href="#cb43-402" aria-hidden="true" tabindex="-1"></a><span class="in">    str_detect(wh_approp_name, "EMER R") ~ "ESSER",</span></span>
<span id="cb43-403"><a href="#cb43-403" aria-hidden="true" tabindex="-1"></a><span class="in">    str_detect(wh_approp_name, "EMR R") ~ "ESSER",</span></span>
<span id="cb43-404"><a href="#cb43-404" aria-hidden="true" tabindex="-1"></a><span class="in">    str_detect(wh_approp_name, "CARES") ~ "ESSER",</span></span>
<span id="cb43-405"><a href="#cb43-405" aria-hidden="true" tabindex="-1"></a><span class="in">    str_detect(wh_approp_name, "AMER R") ~ "ESSER",</span></span>
<span id="cb43-406"><a href="#cb43-406" aria-hidden="true" tabindex="-1"></a><span class="in">    str_detect(wh_approp_name, "EMER ED") ~ "ESSER",</span></span>
<span id="cb43-407"><a href="#cb43-407" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb43-408"><a href="#cb43-408" aria-hidden="true" tabindex="-1"></a><span class="in">    TRUE ~ 'not_esser')) %&gt;%</span></span>
<span id="cb43-409"><a href="#cb43-409" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(ESSERfunds == "ESSER")</span></span>
<span id="cb43-410"><a href="#cb43-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-411"><a href="#cb43-411" aria-hidden="true" tabindex="-1"></a><span class="in">ESSER_exp</span></span>
<span id="cb43-412"><a href="#cb43-412" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-413"><a href="#cb43-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-414"><a href="#cb43-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-415"><a href="#cb43-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-418"><a href="#cb43-418" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-419"><a href="#cb43-419" aria-hidden="true" tabindex="-1"></a><span class="co">#dropped_inff_0 &lt;- exp_temp %&gt;% filter(in_ff == 0)</span></span>
<span id="cb43-420"><a href="#cb43-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-421"><a href="#cb43-421" aria-hidden="true" tabindex="-1"></a><span class="co">#exp_temp &lt;- exp_temp %&gt;% filter(in_ff == 1) # drops in_ff = 0 funds AFTER dealing with net-revenue above</span></span>
<span id="cb43-422"><a href="#cb43-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-423"><a href="#cb43-423" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-424"><a href="#cb43-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-425"><a href="#cb43-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-426"><a href="#cb43-426" aria-hidden="true" tabindex="-1"></a><span class="in">```{r drop-coviddollars2}</span></span>
<span id="cb43-427"><a href="#cb43-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-428"><a href="#cb43-428" aria-hidden="true" tabindex="-1"></a><span class="in">rev_temp &lt;- rev_temp %&gt;%  filter(covid_dollars==0) # keeps observations that were not coded as COVID federal funds</span></span>
<span id="cb43-429"><a href="#cb43-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-430"><a href="#cb43-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-431"><a href="#cb43-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-432"><a href="#cb43-432" aria-hidden="true" tabindex="-1"></a><span class="in">ff_rev &lt;- rev_temp %&gt;%   </span></span>
<span id="cb43-433"><a href="#cb43-433" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(rev_type_new = str_pad(rev_type_new, 2, "left", pad = "0")) %&gt;%</span></span>
<span id="cb43-434"><a href="#cb43-434" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(rev_type_new, fy) %&gt;% </span></span>
<span id="cb43-435"><a href="#cb43-435" aria-hidden="true" tabindex="-1"></a><span class="in">  summarize(sum_receipts = round(sum(receipts, na.rm=TRUE)/1000000 )) %&gt;%</span></span>
<span id="cb43-436"><a href="#cb43-436" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_wider(names_from = "rev_type_new", values_from = "sum_receipts", names_prefix = "rev_")</span></span>
<span id="cb43-437"><a href="#cb43-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-438"><a href="#cb43-438" aria-hidden="true" tabindex="-1"></a><span class="in"># ff_rev&lt;- left_join(ff_rev, tax_refund)</span></span>
<span id="cb43-439"><a href="#cb43-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-440"><a href="#cb43-440" aria-hidden="true" tabindex="-1"></a><span class="in">ff_rev &lt;- mutate_all(ff_rev, ~replace_na(.,0))</span></span>
<span id="cb43-441"><a href="#cb43-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-442"><a href="#cb43-442" aria-hidden="true" tabindex="-1"></a><span class="in"># </span></span>
<span id="cb43-443"><a href="#cb43-443" aria-hidden="true" tabindex="-1"></a><span class="in"># ff_rev &lt;- ff_rev %&gt;%</span></span>
<span id="cb43-444"><a href="#cb43-444" aria-hidden="true" tabindex="-1"></a><span class="in">#   select(-c(# ref_02:ref_35, </span></span>
<span id="cb43-445"><a href="#cb43-445" aria-hidden="true" tabindex="-1"></a><span class="in">#           ref_CHECK</span></span>
<span id="cb43-446"><a href="#cb43-446" aria-hidden="true" tabindex="-1"></a><span class="in">#             ))</span></span>
<span id="cb43-447"><a href="#cb43-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-448"><a href="#cb43-448" aria-hidden="true" tabindex="-1"></a><span class="in">rev_long &lt;- pivot_longer(ff_rev, rev_02:rev_78, names_to = c("type","Category"), values_to = "Dollars", names_sep = "_") %&gt;% </span></span>
<span id="cb43-449"><a href="#cb43-449" aria-hidden="true" tabindex="-1"></a><span class="in">  rename(Year = fy) %&gt;%</span></span>
<span id="cb43-450"><a href="#cb43-450" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(Category_name = case_when(</span></span>
<span id="cb43-451"><a href="#cb43-451" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "02" ~ "INDIVIDUAL INCOME TAX" ,</span></span>
<span id="cb43-452"><a href="#cb43-452" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "03" ~ "CORPORATE INCOME TAX" ,</span></span>
<span id="cb43-453"><a href="#cb43-453" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "06" ~ "SALES TAX" ,</span></span>
<span id="cb43-454"><a href="#cb43-454" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "09" ~ "MOTOR FUEL TAX" ,</span></span>
<span id="cb43-455"><a href="#cb43-455" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "12" ~ "PUBLIC UTILITY TAX" ,</span></span>
<span id="cb43-456"><a href="#cb43-456" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "15" ~ "CIGARETTE TAXES" ,</span></span>
<span id="cb43-457"><a href="#cb43-457" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "18" ~ "LIQUOR GALLONAGE TAXES" ,</span></span>
<span id="cb43-458"><a href="#cb43-458" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "21" ~ "INHERITANCE TAX" ,</span></span>
<span id="cb43-459"><a href="#cb43-459" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "24" ~ "INSURANCE TAXES&amp;FEES&amp;LICENSES" ,</span></span>
<span id="cb43-460"><a href="#cb43-460" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "27" ~ "CORP FRANCHISE TAXES &amp; FEES" ,</span></span>
<span id="cb43-461"><a href="#cb43-461" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "30" ~ "HORSE RACING TAXES &amp; FEES",  # in Other</span></span>
<span id="cb43-462"><a href="#cb43-462" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "31" ~ "MEDICAL PROVIDER ASSESSMENTS" ,</span></span>
<span id="cb43-463"><a href="#cb43-463" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "32" ~ "GARNISHMENT-LEVIES" , # dropped</span></span>
<span id="cb43-464"><a href="#cb43-464" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "33" ~  "LOTTERY RECEIPTS" ,</span></span>
<span id="cb43-465"><a href="#cb43-465" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "35" ~  "OTHER TAXES" ,</span></span>
<span id="cb43-466"><a href="#cb43-466" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "36" ~  "RECEIPTS FROM REVENUE PRODUCING", </span></span>
<span id="cb43-467"><a href="#cb43-467" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "39" ~  "LICENSES, FEES &amp; REGISTRATIONS" ,</span></span>
<span id="cb43-468"><a href="#cb43-468" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "42" ~  "MOTOR VEHICLE AND OPERATORS" ,</span></span>
<span id="cb43-469"><a href="#cb43-469" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "45" ~  "STUDENT FEES-UNIVERSITIES",   # dropped</span></span>
<span id="cb43-470"><a href="#cb43-470" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "48" ~  "RIVERBOAT WAGERING TAXES" ,</span></span>
<span id="cb43-471"><a href="#cb43-471" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "51" ~  "RETIREMENT CONTRIBUTIONS" , # dropped</span></span>
<span id="cb43-472"><a href="#cb43-472" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "54" ~ "GIFTS AND BEQUESTS", </span></span>
<span id="cb43-473"><a href="#cb43-473" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "57" ~  "FEDERAL OTHER" ,</span></span>
<span id="cb43-474"><a href="#cb43-474" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "58" ~  "FEDERAL MEDICAID", </span></span>
<span id="cb43-475"><a href="#cb43-475" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "59" ~  "FEDERAL TRANSPORTATION" ,</span></span>
<span id="cb43-476"><a href="#cb43-476" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "60" ~  "OTHER GRANTS AND CONTRACTS", #other</span></span>
<span id="cb43-477"><a href="#cb43-477" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "63" ~  "INVESTMENT INCOME", # other</span></span>
<span id="cb43-478"><a href="#cb43-478" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "66" ~ "PROCEEDS,INVESTMENT MATURITIES" , #dropped</span></span>
<span id="cb43-479"><a href="#cb43-479" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "72" ~ "BOND ISSUE PROCEEDS",  #dropped</span></span>
<span id="cb43-480"><a href="#cb43-480" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "75" ~  "INTER-AGENCY RECEIPTS ",  #dropped</span></span>
<span id="cb43-481"><a href="#cb43-481" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "76" ~  "TRANSFER IN FROM OUT FUNDS",  #other</span></span>
<span id="cb43-482"><a href="#cb43-482" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "78" ~  "ALL OTHER SOURCES" ,</span></span>
<span id="cb43-483"><a href="#cb43-483" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "79" ~   "COOK COUNTY IGT", #dropped</span></span>
<span id="cb43-484"><a href="#cb43-484" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "98" ~  "PRIOR YEAR REFUNDS", #dropped</span></span>
<span id="cb43-485"><a href="#cb43-485" aria-hidden="true" tabindex="-1"></a><span class="in">                 T ~ "Check Me!"</span></span>
<span id="cb43-486"><a href="#cb43-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-487"><a href="#cb43-487" aria-hidden="true" tabindex="-1"></a><span class="in">  ) )%&gt;% </span></span>
<span id="cb43-488"><a href="#cb43-488" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(Category_name = str_to_title(Category_name))</span></span>
<span id="cb43-489"><a href="#cb43-489" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-490"><a href="#cb43-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-491"><a href="#cb43-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-492"><a href="#cb43-492" aria-hidden="true" tabindex="-1"></a><span class="in">```{r make-ffexplong-nocure, eval = FALSE}</span></span>
<span id="cb43-493"><a href="#cb43-493" aria-hidden="true" tabindex="-1"></a><span class="in">exp_temp &lt;- exp_temp %&gt;% filter(in_ff == 1) # drops in_ff = 0 funds AFTER dealing with net-revenue above</span></span>
<span id="cb43-494"><a href="#cb43-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-495"><a href="#cb43-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-496"><a href="#cb43-496" aria-hidden="true" tabindex="-1"></a><span class="in">exp_temp &lt;- exp_temp %&gt;%</span></span>
<span id="cb43-497"><a href="#cb43-497" aria-hidden="true" tabindex="-1"></a><span class="in">  #mutate(agency = as.numeric(agency) ) %&gt;%</span></span>
<span id="cb43-498"><a href="#cb43-498" aria-hidden="true" tabindex="-1"></a><span class="in">  # arrange(agency)%&gt;%</span></span>
<span id="cb43-499"><a href="#cb43-499" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb43-500"><a href="#cb43-500" aria-hidden="true" tabindex="-1"></a><span class="in">    group = case_when(</span></span>
<span id="cb43-501"><a href="#cb43-501" aria-hidden="true" tabindex="-1"></a><span class="in">      agency&gt;"100"&amp; agency&lt;"200" ~ "910", # legislative</span></span>
<span id="cb43-502"><a href="#cb43-502" aria-hidden="true" tabindex="-1"></a><span class="in">      </span></span>
<span id="cb43-503"><a href="#cb43-503" aria-hidden="true" tabindex="-1"></a><span class="in">      agency == "528"  | (agency&gt;"200" &amp; agency&lt;"300") ~ "920", # judicial</span></span>
<span id="cb43-504"><a href="#cb43-504" aria-hidden="true" tabindex="-1"></a><span class="in">      pension&gt;0  ~ "901", # pensions</span></span>
<span id="cb43-505"><a href="#cb43-505" aria-hidden="true" tabindex="-1"></a><span class="in">      (agency&gt;"309" &amp; agency&lt;"400") ~ "930",    # elected officers</span></span>
<span id="cb43-506"><a href="#cb43-506" aria-hidden="true" tabindex="-1"></a><span class="in">      </span></span>
<span id="cb43-507"><a href="#cb43-507" aria-hidden="true" tabindex="-1"></a><span class="in">      agency == "586" ~ "959", # create new K-12 group</span></span>
<span id="cb43-508"><a href="#cb43-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-509"><a href="#cb43-509" aria-hidden="true" tabindex="-1"></a><span class="in">      agency=="402" | agency=="418" | agency=="478" | agency=="444" | agency=="482" ~ as.character(agency), # aging, Children and Family Services (DCFS), Healthcare and Family Services (DHFS), human services (DHS), public health (DPH)</span></span>
<span id="cb43-510"><a href="#cb43-510" aria-hidden="true" tabindex="-1"></a><span class="in">      T ~ as.character(group))</span></span>
<span id="cb43-511"><a href="#cb43-511" aria-hidden="true" tabindex="-1"></a><span class="in">    ) %&gt;%      </span></span>
<span id="cb43-512"><a href="#cb43-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-513"><a href="#cb43-513" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb43-514"><a href="#cb43-514" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(group = case_when(</span></span>
<span id="cb43-515"><a href="#cb43-515" aria-hidden="true" tabindex="-1"></a><span class="in">    agency=="478" &amp; (appr_org=="01" | appr_org == "65" | appr_org=="88") &amp; (object=="4900" | object=="4400") ~ "945", # separates CHIP from health and human services and saves it as Medicaid</span></span>
<span id="cb43-516"><a href="#cb43-516" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb43-517"><a href="#cb43-517" aria-hidden="true" tabindex="-1"></a><span class="in">    agency == "586" &amp; fund == "0355" ~ "945",  # 586 (Board of Edu) has special education which is part of medicaid</span></span>
<span id="cb43-518"><a href="#cb43-518" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb43-519"><a href="#cb43-519" aria-hidden="true" tabindex="-1"></a><span class="in">    # OLD CODE: agency == "586" &amp; appr_org == "18" ~ "945", # Spec. Edu Medicaid Matching</span></span>
<span id="cb43-520"><a href="#cb43-520" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb43-521"><a href="#cb43-521" aria-hidden="true" tabindex="-1"></a><span class="in">    agency=="425" | agency=="466" | agency=="546" | agency=="569" | agency=="578" | agency=="583" | agency=="591" | agency=="592" | agency=="493" | agency=="588" ~ "941", # public safety &amp; Corrections</span></span>
<span id="cb43-522"><a href="#cb43-522" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb43-523"><a href="#cb43-523" aria-hidden="true" tabindex="-1"></a><span class="in">     agency=="406" | agency=="420" | agency=="494" |  agency=="557" ~ as.character(agency), # econ devt &amp; infra, tollway</span></span>
<span id="cb43-524"><a href="#cb43-524" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb43-525"><a href="#cb43-525" aria-hidden="true" tabindex="-1"></a><span class="in">    agency=="511" | agency=="554" | agency=="574" | agency=="598" ~ "946",  # Capital improvement</span></span>
<span id="cb43-526"><a href="#cb43-526" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb43-527"><a href="#cb43-527" aria-hidden="true" tabindex="-1"></a><span class="in">    agency=="422" | agency=="532" ~ as.character(agency), # environment &amp; nat. resources</span></span>
<span id="cb43-528"><a href="#cb43-528" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb43-529"><a href="#cb43-529" aria-hidden="true" tabindex="-1"></a><span class="in">    agency=="440" | agency=="446" | agency=="524" | agency=="563"  ~ "944", # business regulation</span></span>
<span id="cb43-530"><a href="#cb43-530" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb43-531"><a href="#cb43-531" aria-hidden="true" tabindex="-1"></a><span class="in">    agency=="492" ~ "492", # revenue</span></span>
<span id="cb43-532"><a href="#cb43-532" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb43-533"><a href="#cb43-533" aria-hidden="true" tabindex="-1"></a><span class="in">    agency == "416" ~ "416", # central management services</span></span>
<span id="cb43-534"><a href="#cb43-534" aria-hidden="true" tabindex="-1"></a><span class="in">    agency=="448" &amp; fy &gt; 2016 ~ "416", #add DoIT to central management </span></span>
<span id="cb43-535"><a href="#cb43-535" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb43-536"><a href="#cb43-536" aria-hidden="true" tabindex="-1"></a><span class="in">    T ~ as.character(group))) %&gt;%</span></span>
<span id="cb43-537"><a href="#cb43-537" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb43-538"><a href="#cb43-538" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb43-539"><a href="#cb43-539" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(group = case_when(</span></span>
<span id="cb43-540"><a href="#cb43-540" aria-hidden="true" tabindex="-1"></a><span class="in">    # agency=="684" | agency=="691"  ~ as.character(agency), # moved under higher education in next line. 11/28/2022 AWM</span></span>
<span id="cb43-541"><a href="#cb43-541" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb43-542"><a href="#cb43-542" aria-hidden="true" tabindex="-1"></a><span class="in">    agency=="692" | agency=="695" | agency == "684" |agency == "691" | (agency&gt;"599" &amp; agency&lt;"677") ~ "960", # higher education</span></span>
<span id="cb43-543"><a href="#cb43-543" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb43-544"><a href="#cb43-544" aria-hidden="true" tabindex="-1"></a><span class="in">    agency=="427"  ~ as.character(agency), # employment security</span></span>
<span id="cb43-545"><a href="#cb43-545" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb43-546"><a href="#cb43-546" aria-hidden="true" tabindex="-1"></a><span class="in">    agency=="507"|  agency=="442" | agency=="445" | agency=="452" |agency=="458" | agency=="497" ~ "948", # other departments</span></span>
<span id="cb43-547"><a href="#cb43-547" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb43-548"><a href="#cb43-548" aria-hidden="true" tabindex="-1"></a><span class="in">    # other boards &amp; Commissions</span></span>
<span id="cb43-549"><a href="#cb43-549" aria-hidden="true" tabindex="-1"></a><span class="in">    agency=="503" | agency=="509" | agency=="510" | agency=="565" |agency=="517" | agency=="525" | agency=="526" | agency=="529" | agency=="537" | agency=="541" | agency=="542" | agency=="548" |  agency=="555" | agency=="558" | agency=="559" | agency=="562" | agency=="564" | agency=="568" | agency=="579" | agency=="580" | agency=="587" | agency=="590" | agency=="527" | agency=="585" | agency=="567" | agency=="571" | agency=="575" | agency=="540" | agency=="576" | agency=="564" | agency=="534" | agency=="520" | agency=="506" | agency == "533" ~ "949", </span></span>
<span id="cb43-550"><a href="#cb43-550" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb43-551"><a href="#cb43-551" aria-hidden="true" tabindex="-1"></a><span class="in">    # non-pension expenditures of retirement funds moved to "Other Departments"</span></span>
<span id="cb43-552"><a href="#cb43-552" aria-hidden="true" tabindex="-1"></a><span class="in">    # should have removed pension expenditures already from exp_temp in Pensions step above</span></span>
<span id="cb43-553"><a href="#cb43-553" aria-hidden="true" tabindex="-1"></a><span class="in">    agency=="131" | agency=="275" | agency=="589" |agency=="593"|agency=="594"|agency=="693" ~ "948",</span></span>
<span id="cb43-554"><a href="#cb43-554" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb43-555"><a href="#cb43-555" aria-hidden="true" tabindex="-1"></a><span class="in">    T ~ as.character(group))) %&gt;%</span></span>
<span id="cb43-556"><a href="#cb43-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-557"><a href="#cb43-557" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(group_name = </span></span>
<span id="cb43-558"><a href="#cb43-558" aria-hidden="true" tabindex="-1"></a><span class="in">           case_when(</span></span>
<span id="cb43-559"><a href="#cb43-559" aria-hidden="true" tabindex="-1"></a><span class="in">             group == "416" ~ "Central Management",</span></span>
<span id="cb43-560"><a href="#cb43-560" aria-hidden="true" tabindex="-1"></a><span class="in">             group == "478" ~ "Healthcare and Family Services",</span></span>
<span id="cb43-561"><a href="#cb43-561" aria-hidden="true" tabindex="-1"></a><span class="in">             group == "482" ~ "Public Health",</span></span>
<span id="cb43-562"><a href="#cb43-562" aria-hidden="true" tabindex="-1"></a><span class="in">             group == "900" ~ "NOT IN FRAME",</span></span>
<span id="cb43-563"><a href="#cb43-563" aria-hidden="true" tabindex="-1"></a><span class="in">             group == "901" ~ "STATE PENSION CONTRIBUTION",</span></span>
<span id="cb43-564"><a href="#cb43-564" aria-hidden="true" tabindex="-1"></a><span class="in">             group == "903" ~ "DEBT SERVICE",</span></span>
<span id="cb43-565"><a href="#cb43-565" aria-hidden="true" tabindex="-1"></a><span class="in">             group == "910" ~ "LEGISLATIVE"  ,</span></span>
<span id="cb43-566"><a href="#cb43-566" aria-hidden="true" tabindex="-1"></a><span class="in">             group == "920" ~ "JUDICIAL" ,</span></span>
<span id="cb43-567"><a href="#cb43-567" aria-hidden="true" tabindex="-1"></a><span class="in">             group == "930" ~ "ELECTED OFFICERS" , </span></span>
<span id="cb43-568"><a href="#cb43-568" aria-hidden="true" tabindex="-1"></a><span class="in">             group == "940" ~ "OTHER HEALTH-RELATED", </span></span>
<span id="cb43-569"><a href="#cb43-569" aria-hidden="true" tabindex="-1"></a><span class="in">             group == "941" ~ "PUBLIC SAFETY" ,</span></span>
<span id="cb43-570"><a href="#cb43-570" aria-hidden="true" tabindex="-1"></a><span class="in">             group == "942" ~ "ECON DEVT &amp; INFRASTRUCTURE" ,</span></span>
<span id="cb43-571"><a href="#cb43-571" aria-hidden="true" tabindex="-1"></a><span class="in">             group == "943" ~ "CENTRAL SERVICES",</span></span>
<span id="cb43-572"><a href="#cb43-572" aria-hidden="true" tabindex="-1"></a><span class="in">             group == "944" ~ "BUS &amp; PROFESSION REGULATION" ,</span></span>
<span id="cb43-573"><a href="#cb43-573" aria-hidden="true" tabindex="-1"></a><span class="in">             group == "945" ~ "MEDICAID" ,</span></span>
<span id="cb43-574"><a href="#cb43-574" aria-hidden="true" tabindex="-1"></a><span class="in">             group == "946" ~ "CAPITAL IMPROVEMENT" , </span></span>
<span id="cb43-575"><a href="#cb43-575" aria-hidden="true" tabindex="-1"></a><span class="in">             group == "948" ~ "OTHER DEPARTMENTS" ,</span></span>
<span id="cb43-576"><a href="#cb43-576" aria-hidden="true" tabindex="-1"></a><span class="in">             group == "949" ~ "OTHER BOARDS &amp; COMMISSIONS" ,</span></span>
<span id="cb43-577"><a href="#cb43-577" aria-hidden="true" tabindex="-1"></a><span class="in">             group == "959" ~ "K-12 EDUCATION" ,</span></span>
<span id="cb43-578"><a href="#cb43-578" aria-hidden="true" tabindex="-1"></a><span class="in">             group == "960" ~ "UNIVERSITY EDUCATION" ,</span></span>
<span id="cb43-579"><a href="#cb43-579" aria-hidden="true" tabindex="-1"></a><span class="in">             group == agency ~ as.character(group),</span></span>
<span id="cb43-580"><a href="#cb43-580" aria-hidden="true" tabindex="-1"></a><span class="in">             TRUE ~ "Check name"),</span></span>
<span id="cb43-581"><a href="#cb43-581" aria-hidden="true" tabindex="-1"></a><span class="in">         year = fy)</span></span>
<span id="cb43-582"><a href="#cb43-582" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-583"><a href="#cb43-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-584"><a href="#cb43-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-585"><a href="#cb43-585" aria-hidden="true" tabindex="-1"></a><span class="in">```{r make-ffexplong-withcure}</span></span>
<span id="cb43-586"><a href="#cb43-586" aria-hidden="true" tabindex="-1"></a><span class="in">exp_temp &lt;- read_csv("data/all_expenditures_recoded.csv") %&gt;%</span></span>
<span id="cb43-587"><a href="#cb43-587" aria-hidden="true" tabindex="-1"></a><span class="in">#exp_temp &lt;- read.csv("data/exp_fy23_recoded_02April2024.csv") %&gt;% </span></span>
<span id="cb43-588"><a href="#cb43-588" aria-hidden="true" tabindex="-1"></a><span class="in">#exp_temp &lt;- read.csv("data/exp_temp.csv") %&gt;% </span></span>
<span id="cb43-589"><a href="#cb43-589" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(agency = as.character(agency),</span></span>
<span id="cb43-590"><a href="#cb43-590" aria-hidden="true" tabindex="-1"></a><span class="in">         object = as.character(object),</span></span>
<span id="cb43-591"><a href="#cb43-591" aria-hidden="true" tabindex="-1"></a><span class="in">         object = str_pad(object, side = "left", 4, pad = "0"),</span></span>
<span id="cb43-592"><a href="#cb43-592" aria-hidden="true" tabindex="-1"></a><span class="in">         sequence = as.character(sequence),</span></span>
<span id="cb43-593"><a href="#cb43-593" aria-hidden="true" tabindex="-1"></a><span class="in">         sequence = str_pad(sequence, side = "left", 2, pad = "0"),</span></span>
<span id="cb43-594"><a href="#cb43-594" aria-hidden="true" tabindex="-1"></a><span class="in">         type = as.character(type),</span></span>
<span id="cb43-595"><a href="#cb43-595" aria-hidden="true" tabindex="-1"></a><span class="in">         type = str_pad(type, side = "left", 2, pad = "0"),</span></span>
<span id="cb43-596"><a href="#cb43-596" aria-hidden="true" tabindex="-1"></a><span class="in">         appr_org = as.character(appr_org),</span></span>
<span id="cb43-597"><a href="#cb43-597" aria-hidden="true" tabindex="-1"></a><span class="in">         appr_org = str_pad(appr_org, side = "left", 2, pad = "0"),</span></span>
<span id="cb43-598"><a href="#cb43-598" aria-hidden="true" tabindex="-1"></a><span class="in">         fund = as.character(fund),</span></span>
<span id="cb43-599"><a href="#cb43-599" aria-hidden="true" tabindex="-1"></a><span class="in">         fund = str_pad(fund, side = "left", 4, pad = "0"))</span></span>
<span id="cb43-600"><a href="#cb43-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-601"><a href="#cb43-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-602"><a href="#cb43-602" aria-hidden="true" tabindex="-1"></a><span class="in">ff_exp &lt;- exp_temp %&gt;% </span></span>
<span id="cb43-603"><a href="#cb43-603" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(fy, group) %&gt;% </span></span>
<span id="cb43-604"><a href="#cb43-604" aria-hidden="true" tabindex="-1"></a><span class="in">  summarize(sum_expenditures = round(sum(expenditure, na.rm=TRUE)/1000000 )) %&gt;%</span></span>
<span id="cb43-605"><a href="#cb43-605" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_wider(names_from = "group", values_from = "sum_expenditures", names_prefix = "exp_")%&gt;%</span></span>
<span id="cb43-606"><a href="#cb43-606" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb43-607"><a href="#cb43-607" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(debt_keep_yearly) %&gt;%</span></span>
<span id="cb43-608"><a href="#cb43-608" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(exp_903 = debt_cost) %&gt;%</span></span>
<span id="cb43-609"><a href="#cb43-609" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(transfers)  %&gt;%</span></span>
<span id="cb43-610"><a href="#cb43-610" aria-hidden="true" tabindex="-1"></a><span class="in"> mutate(exp_970 = exp_971 + exp_972  + exp_975 + exp_976)</span></span>
<span id="cb43-611"><a href="#cb43-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-612"><a href="#cb43-612" aria-hidden="true" tabindex="-1"></a><span class="in">#ff_exp&lt;- ff_exp %&gt;% select(-c(debt_cost, exp_971:exp_976)) # drop unwanted columns</span></span>
<span id="cb43-613"><a href="#cb43-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-614"><a href="#cb43-614" aria-hidden="true" tabindex="-1"></a><span class="in">exp_long &lt;- pivot_longer(ff_exp, exp_402:exp_970 , names_to = c("type", "Category"), values_to = "Dollars", names_sep = "_") %&gt;% </span></span>
<span id="cb43-615"><a href="#cb43-615" aria-hidden="true" tabindex="-1"></a><span class="in">  rename(Year = fy ) %&gt;% </span></span>
<span id="cb43-616"><a href="#cb43-616" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(Category_name = </span></span>
<span id="cb43-617"><a href="#cb43-617" aria-hidden="true" tabindex="-1"></a><span class="in">           case_when(</span></span>
<span id="cb43-618"><a href="#cb43-618" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "402" ~ "AGING" ,</span></span>
<span id="cb43-619"><a href="#cb43-619" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "406" ~ "AGRICULTURE", </span></span>
<span id="cb43-620"><a href="#cb43-620" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "416" ~ "CENTRAL MANAGEMENT",</span></span>
<span id="cb43-621"><a href="#cb43-621" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "418" ~ "CHILDREN AND FAMILY SERVICES", </span></span>
<span id="cb43-622"><a href="#cb43-622" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "420" ~ "COMMERCE AND ECONOMIC OPPORTUNITY",</span></span>
<span id="cb43-623"><a href="#cb43-623" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "422" ~ "NATURAL RESOURCES" ,</span></span>
<span id="cb43-624"><a href="#cb43-624" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "426" ~ "CORRECTIONS",</span></span>
<span id="cb43-625"><a href="#cb43-625" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "427" ~ "EMPLOYMENT SECURITY" ,</span></span>
<span id="cb43-626"><a href="#cb43-626" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "444" ~ "HUMAN SERVICES" ,</span></span>
<span id="cb43-627"><a href="#cb43-627" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "448" ~ "Innovation and Technology", # AWM added fy2022</span></span>
<span id="cb43-628"><a href="#cb43-628" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "478" ~ "HEALTHCARE &amp; FAM SER NET OF MEDICAID", </span></span>
<span id="cb43-629"><a href="#cb43-629" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "482" ~ "PUBLIC HEALTH", </span></span>
<span id="cb43-630"><a href="#cb43-630" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "492" ~ "REVENUE", </span></span>
<span id="cb43-631"><a href="#cb43-631" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "494" ~ "TRANSPORTATION" ,</span></span>
<span id="cb43-632"><a href="#cb43-632" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "532" ~ "ENVIRONMENTAL PROTECT AGENCY" ,</span></span>
<span id="cb43-633"><a href="#cb43-633" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "557" ~ "IL STATE TOLL HIGHWAY AUTH" ,</span></span>
<span id="cb43-634"><a href="#cb43-634" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "684" ~ "IL COMMUNITY COLLEGE BOARD", </span></span>
<span id="cb43-635"><a href="#cb43-635" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "691" ~ "IL STUDENT ASSISTANCE COMM" ,</span></span>
<span id="cb43-636"><a href="#cb43-636" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "900" ~ "NOT IN FRAME",</span></span>
<span id="cb43-637"><a href="#cb43-637" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "901" ~ "STATE PENSION CONTRIBUTION",</span></span>
<span id="cb43-638"><a href="#cb43-638" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "903" ~ "DEBT SERVICE",</span></span>
<span id="cb43-639"><a href="#cb43-639" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "904" ~ "State Employee Healthcare",</span></span>
<span id="cb43-640"><a href="#cb43-640" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "910" ~ "LEGISLATIVE"  ,</span></span>
<span id="cb43-641"><a href="#cb43-641" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "920" ~ "JUDICIAL" ,</span></span>
<span id="cb43-642"><a href="#cb43-642" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "930" ~ "ELECTED OFFICERS" , </span></span>
<span id="cb43-643"><a href="#cb43-643" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "940" ~ "OTHER HEALTH-RELATED", </span></span>
<span id="cb43-644"><a href="#cb43-644" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "941" ~ "PUBLIC SAFETY" ,</span></span>
<span id="cb43-645"><a href="#cb43-645" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "942" ~ "ECON DEVT &amp; INFRASTRUCTURE" ,</span></span>
<span id="cb43-646"><a href="#cb43-646" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "943" ~ "CENTRAL SERVICES",</span></span>
<span id="cb43-647"><a href="#cb43-647" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "944" ~ "BUS &amp; PROFESSION REGULATION" ,</span></span>
<span id="cb43-648"><a href="#cb43-648" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "945" ~ "MEDICAID" ,</span></span>
<span id="cb43-649"><a href="#cb43-649" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "946" ~ "CAPITAL IMPROVEMENT" , </span></span>
<span id="cb43-650"><a href="#cb43-650" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "948" ~ "OTHER DEPARTMENTS" ,</span></span>
<span id="cb43-651"><a href="#cb43-651" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "949" ~ "OTHER BOARDS &amp; COMMISSIONS" ,</span></span>
<span id="cb43-652"><a href="#cb43-652" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "959" ~ "K-12 EDUCATION" ,</span></span>
<span id="cb43-653"><a href="#cb43-653" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "960" ~ "UNIVERSITY EDUCATION",</span></span>
<span id="cb43-654"><a href="#cb43-654" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "970" ~ "Local Govt Transfers",</span></span>
<span id="cb43-655"><a href="#cb43-655" aria-hidden="true" tabindex="-1"></a><span class="in">             T ~ "CHECK ME!")</span></span>
<span id="cb43-656"><a href="#cb43-656" aria-hidden="true" tabindex="-1"></a><span class="in">           ) %&gt;% </span></span>
<span id="cb43-657"><a href="#cb43-657" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(Category_name = str_to_title(Category_name))</span></span>
<span id="cb43-658"><a href="#cb43-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-659"><a href="#cb43-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-660"><a href="#cb43-660" aria-hidden="true" tabindex="-1"></a><span class="in">#exp_long_nototals &lt;- exp_long %&gt;% filter(Category_name != "Totals")</span></span>
<span id="cb43-661"><a href="#cb43-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-662"><a href="#cb43-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-663"><a href="#cb43-663" aria-hidden="true" tabindex="-1"></a><span class="in">aggregated_totals_long &lt;- rbind(rev_long, exp_long) </span></span>
<span id="cb43-664"><a href="#cb43-664" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-665"><a href="#cb43-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-666"><a href="#cb43-666" aria-hidden="true" tabindex="-1"></a>Change plots:</span>
<span id="cb43-667"><a href="#cb43-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-670"><a href="#cb43-670" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-671"><a href="#cb43-671" aria-hidden="true" tabindex="-1"></a>year_totals2 <span class="ot">&lt;-</span> aggregated_totals_long <span class="sc">%&gt;%</span> </span>
<span id="cb43-672"><a href="#cb43-672" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(type, Year) <span class="sc">%&gt;%</span> </span>
<span id="cb43-673"><a href="#cb43-673" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Dollars =</span> <span class="fu">sum</span>(Dollars, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb43-674"><a href="#cb43-674" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"type"</span>, <span class="at">values_from =</span> Dollars) <span class="sc">%&gt;%</span> </span>
<span id="cb43-675"><a href="#cb43-675" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb43-676"><a href="#cb43-676" aria-hidden="true" tabindex="-1"></a>         <span class="at">Expenditures =</span> exp,</span>
<span id="cb43-677"><a href="#cb43-677" aria-hidden="true" tabindex="-1"></a>         <span class="at">Revenue =</span> rev) <span class="sc">%&gt;%</span>  </span>
<span id="cb43-678"><a href="#cb43-678" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Fiscal Gap</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(Revenue <span class="sc">-</span> Expenditures)) <span class="sc">%&gt;%</span> </span>
<span id="cb43-679"><a href="#cb43-679" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Year))</span>
<span id="cb43-680"><a href="#cb43-680" aria-hidden="true" tabindex="-1"></a><span class="co"># creates variable for the Gap each year</span></span>
<span id="cb43-681"><a href="#cb43-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-682"><a href="#cb43-682" aria-hidden="true" tabindex="-1"></a>year_totals2 <span class="co"># gap for FY22 changed to 2.3 billion</span></span>
<span id="cb43-683"><a href="#cb43-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-684"><a href="#cb43-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-685"><a href="#cb43-685" aria-hidden="true" tabindex="-1"></a>annotation_billions <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb43-686"><a href="#cb43-686" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">2004</span>, <span class="dv">2017</span>, <span class="dv">2019</span>),</span>
<span id="cb43-687"><a href="#cb43-687" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">50</span>, <span class="dv">10</span>),  </span>
<span id="cb43-688"><a href="#cb43-688" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"Expenditures"</span>,<span class="st">"Revenue"</span>, <span class="st">"Fiscal Gap"</span>))</span>
<span id="cb43-689"><a href="#cb43-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-690"><a href="#cb43-690" aria-hidden="true" tabindex="-1"></a>fiscal_gap1 <span class="ot">&lt;-</span> year_totals <span class="sc">%&gt;%</span></span>
<span id="cb43-691"><a href="#cb43-691" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb43-692"><a href="#cb43-692" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb43-693"><a href="#cb43-693" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Revenue<span class="sc">/</span><span class="dv">1000</span>), <span class="at">color =</span> <span class="st">"Black"</span>, <span class="at">lwd=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb43-694"><a href="#cb43-694" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Expenditures<span class="sc">/</span><span class="dv">1000</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">lwd=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb43-695"><a href="#cb43-695" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> <span class="st">`</span><span class="at">Fiscal Gap</span><span class="st">`</span><span class="sc">/</span><span class="dv">1000</span>), <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb43-696"><a href="#cb43-696" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> annotation_billions, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">label=</span>label))<span class="sc">+</span></span>
<span id="cb43-697"><a href="#cb43-697" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb43-698"><a href="#cb43-698" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>, <span class="co">#axis.text.y = element_blank(),  </span></span>
<span id="cb43-699"><a href="#cb43-699" aria-hidden="true" tabindex="-1"></a>        <span class="co">#axis.ticks.y = element_blank(),</span></span>
<span id="cb43-700"><a href="#cb43-700" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb43-701"><a href="#cb43-701" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"dashed"</span>, <span class="st">"dashed"</span>)) <span class="sc">+</span></span>
<span id="cb43-702"><a href="#cb43-702" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>, <span class="dv">120</span>), <span class="at">labels =</span> comma)<span class="sc">+</span></span>
<span id="cb43-703"><a href="#cb43-703" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">1998</span>,<span class="dv">2023</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) </span>
<span id="cb43-704"><a href="#cb43-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-705"><a href="#cb43-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-706"><a href="#cb43-706" aria-hidden="true" tabindex="-1"></a>fiscal_gap1</span>
<span id="cb43-707"><a href="#cb43-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-708"><a href="#cb43-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-709"><a href="#cb43-709" aria-hidden="true" tabindex="-1"></a>fiscal_gap_droppedCURE <span class="ot">&lt;-</span> year_totals2 <span class="sc">%&gt;%</span>  </span>
<span id="cb43-710"><a href="#cb43-710" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb43-711"><a href="#cb43-711" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb43-712"><a href="#cb43-712" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Revenue<span class="sc">/</span><span class="dv">1000</span>), <span class="at">color =</span> <span class="st">"Black"</span>, <span class="at">lwd=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb43-713"><a href="#cb43-713" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Expenditures<span class="sc">/</span><span class="dv">1000</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">lwd=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb43-714"><a href="#cb43-714" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> <span class="st">`</span><span class="at">Fiscal Gap</span><span class="st">`</span><span class="sc">/</span><span class="dv">1000</span>), <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb43-715"><a href="#cb43-715" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> annotation_billions, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">label=</span>label))<span class="sc">+</span></span>
<span id="cb43-716"><a href="#cb43-716" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb43-717"><a href="#cb43-717" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,<span class="co"># axis.text.y = element_blank(),</span></span>
<span id="cb43-718"><a href="#cb43-718" aria-hidden="true" tabindex="-1"></a>        <span class="co">#axis.ticks.y = element_blank(),</span></span>
<span id="cb43-719"><a href="#cb43-719" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>() )<span class="sc">+</span></span>
<span id="cb43-720"><a href="#cb43-720" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"dashed"</span>, <span class="st">"dashed"</span>)) <span class="sc">+</span></span>
<span id="cb43-721"><a href="#cb43-721" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">120</span>), <span class="at">labels =</span> comma)<span class="sc">+</span></span>
<span id="cb43-722"><a href="#cb43-722" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">1998</span>, <span class="dv">2023</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) </span>
<span id="cb43-723"><a href="#cb43-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-724"><a href="#cb43-724" aria-hidden="true" tabindex="-1"></a>  <span class="co"># # geom_smooth adds regression line, graphed first so it appears behind line graph</span></span>
<span id="cb43-725"><a href="#cb43-725" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_smooth(aes(x = Year, y = Revenue), color = "gray", method = "lm", se = FALSE) + </span></span>
<span id="cb43-726"><a href="#cb43-726" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_smooth(aes(x = Year, y = Expenditures), color = "rosybrown2", method = "lm", se = FALSE) +</span></span>
<span id="cb43-727"><a href="#cb43-727" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb43-728"><a href="#cb43-728" aria-hidden="true" tabindex="-1"></a>  <span class="co"># # line graph of revenue and expenditures</span></span>
<span id="cb43-729"><a href="#cb43-729" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_line(aes(x = Year, y = Revenue), color = "black", size=1) +</span></span>
<span id="cb43-730"><a href="#cb43-730" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_line(aes(x = Year, y = Expenditures), color = "red", size=1) +</span></span>
<span id="cb43-731"><a href="#cb43-731" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_line(aes(x=Year, y = `Fiscal Gap`), color="gray") +</span></span>
<span id="cb43-732"><a href="#cb43-732" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb43-733"><a href="#cb43-733" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_text(data= annotation, aes(x=x, y = y, label=label))+</span></span>
<span id="cb43-734"><a href="#cb43-734" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb43-735"><a href="#cb43-735" aria-hidden="true" tabindex="-1"></a>  <span class="co"># # labels</span></span>
<span id="cb43-736"><a href="#cb43-736" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   theme_bw() +</span></span>
<span id="cb43-737"><a href="#cb43-737" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_y_continuous(labels = comma)+</span></span>
<span id="cb43-738"><a href="#cb43-738" aria-hidden="true" tabindex="-1"></a>  <span class="co"># xlab("Year") + </span></span>
<span id="cb43-739"><a href="#cb43-739" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ylab("Millions of Dollars")  +</span></span>
<span id="cb43-740"><a href="#cb43-740" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ggtitle("Illinois Expenditures and Revenue Totals, 1998-2022")</span></span>
<span id="cb43-741"><a href="#cb43-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-742"><a href="#cb43-742" aria-hidden="true" tabindex="-1"></a>fiscal_gap_droppedCURE</span>
<span id="cb43-743"><a href="#cb43-743" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-744"><a href="#cb43-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-745"><a href="#cb43-745" aria-hidden="true" tabindex="-1"></a>Compare with and without federal COVID dollars:</span>
<span id="cb43-746"><a href="#cb43-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-749"><a href="#cb43-749" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-750"><a href="#cb43-750" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb43-751"><a href="#cb43-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-752"><a href="#cb43-752" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(fiscal_gap1,</span>
<span id="cb43-753"><a href="#cb43-753" aria-hidden="true" tabindex="-1"></a>                   fiscal_gap_droppedCURE, <span class="at">nrow=</span><span class="dv">1</span>, </span>
<span id="cb43-754"><a href="#cb43-754" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"With ARPA State CURE Funds"</span>, <span class="st">"Without ARPA State Cure Funds"</span>))</span>
<span id="cb43-755"><a href="#cb43-755" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-756"><a href="#cb43-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-757"><a href="#cb43-757" aria-hidden="true" tabindex="-1"></a>**Revenue amounts in millions of dollars:**</span>
<span id="cb43-758"><a href="#cb43-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-761"><a href="#cb43-761" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-762"><a href="#cb43-762" aria-hidden="true" tabindex="-1"></a>rev_long <span class="sc">%&gt;%</span></span>
<span id="cb43-763"><a href="#cb43-763" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="dv">2023</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-764"><a href="#cb43-764" aria-hidden="true" tabindex="-1"></a>  <span class="co">#mutate(`Total Expenditures`= sum(Dollars, na.rm = TRUE)) %&gt;%</span></span>
<span id="cb43-765"><a href="#cb43-765" aria-hidden="true" tabindex="-1"></a> <span class="co"># select(-c(Year, `Total Expenditures`)) %&gt;%</span></span>
<span id="cb43-766"><a href="#cb43-766" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="st">`</span><span class="at">Dollars</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb43-767"><a href="#cb43-767" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb43-768"><a href="#cb43-768" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_reorder</span>(Category_name, <span class="st">`</span><span class="at">Dollars</span><span class="st">`</span>), <span class="at">y =</span> <span class="st">`</span><span class="at">Dollars</span><span class="st">`</span>))<span class="sc">+</span> </span>
<span id="cb43-769"><a href="#cb43-769" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb43-770"><a href="#cb43-770" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb43-771"><a href="#cb43-771" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Revenues for FY2023"</span>)<span class="sc">+</span></span>
<span id="cb43-772"><a href="#cb43-772" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Revenue Categories"</span>) <span class="sc">+</span></span>
<span id="cb43-773"><a href="#cb43-773" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Millions of Dollars"</span>)</span>
<span id="cb43-774"><a href="#cb43-774" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-775"><a href="#cb43-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-776"><a href="#cb43-776" aria-hidden="true" tabindex="-1"></a><span class="fu">### Forecasting attempt</span></span>
<span id="cb43-777"><a href="#cb43-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-778"><a href="#cb43-778" aria-hidden="true" tabindex="-1"></a>First images use revenue that includes all federal stimulus packages. Revenue projections are skewed heavily due to the large amount of covid money flowing in the past 2 years.</span>
<span id="cb43-779"><a href="#cb43-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-782"><a href="#cb43-782" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-783"><a href="#cb43-783" aria-hidden="true" tabindex="-1"></a><span class="do">## Revenues</span></span>
<span id="cb43-784"><a href="#cb43-784" aria-hidden="true" tabindex="-1"></a>year_totals2 <span class="ot">&lt;-</span> year_totals2 <span class="sc">%&gt;%</span> </span>
<span id="cb43-785"><a href="#cb43-785" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Year)</span>
<span id="cb43-786"><a href="#cb43-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-787"><a href="#cb43-787" aria-hidden="true" tabindex="-1"></a><span class="co">#ts_rev &lt;- year_totals %&gt;% select(Year, Revenue ) %&gt;% arrange(Year)</span></span>
<span id="cb43-788"><a href="#cb43-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-789"><a href="#cb43-789" aria-hidden="true" tabindex="-1"></a>tsrev <span class="ot">&lt;-</span> <span class="fu">ts</span>(year_totals2<span class="sc">$</span>Revenue, <span class="at">start =</span><span class="st">"1998"</span>, <span class="at">frequency =</span> <span class="dv">1</span>) <span class="co"># yearly data</span></span>
<span id="cb43-790"><a href="#cb43-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-791"><a href="#cb43-791" aria-hidden="true" tabindex="-1"></a><span class="co"># start(tsrev) # 1998, January</span></span>
<span id="cb43-792"><a href="#cb43-792" aria-hidden="true" tabindex="-1"></a><span class="co"># end(tsrev)  ## 2022 </span></span>
<span id="cb43-793"><a href="#cb43-793" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(tsrev)</span></span>
<span id="cb43-794"><a href="#cb43-794" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(tsrev)</span></span>
<span id="cb43-795"><a href="#cb43-795" aria-hidden="true" tabindex="-1"></a><span class="co"># abline(reg=lm(tsrev~time(tsrev)))</span></span>
<span id="cb43-796"><a href="#cb43-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-797"><a href="#cb43-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-798"><a href="#cb43-798" aria-hidden="true" tabindex="-1"></a><span class="do">#### ARIMAs</span></span>
<span id="cb43-799"><a href="#cb43-799" aria-hidden="true" tabindex="-1"></a>mymodel <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(tsrev, <span class="at">seasonal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb43-800"><a href="#cb43-800" aria-hidden="true" tabindex="-1"></a><span class="co"># mymodel          # ARIMA (0, 1, 0) with drift</span></span>
<span id="cb43-801"><a href="#cb43-801" aria-hidden="true" tabindex="-1"></a>myforecastrev <span class="ot">&lt;-</span> <span class="fu">forecast</span>(mymodel, <span class="at">h =</span> <span class="dv">20</span>)</span>
<span id="cb43-802"><a href="#cb43-802" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(myforecastrev,  xlab ="", ylab ="Total Revenue", main ="Chicago Revenue")</span></span>
<span id="cb43-803"><a href="#cb43-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-804"><a href="#cb43-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-805"><a href="#cb43-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-806"><a href="#cb43-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-807"><a href="#cb43-807" aria-hidden="true" tabindex="-1"></a><span class="do">#### revenue chart</span></span>
<span id="cb43-808"><a href="#cb43-808" aria-hidden="true" tabindex="-1"></a>model_rev <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(tsrev, <span class="at">seasonal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb43-809"><a href="#cb43-809" aria-hidden="true" tabindex="-1"></a>forecast_rev <span class="ot">&lt;-</span> <span class="fu">forecast</span>(model_rev, <span class="at">h =</span> <span class="dv">20</span>)</span>
<span id="cb43-810"><a href="#cb43-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-811"><a href="#cb43-811" aria-hidden="true" tabindex="-1"></a>q <span class="ot">&lt;-</span> <span class="fu">forecast</span>(forecast_rev,  <span class="at">h =</span> <span class="dv">20</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb43-812"><a href="#cb43-812" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb43-813"><a href="#cb43-813" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Dollars (Millions)"</span>) <span class="sc">+</span></span>
<span id="cb43-814"><a href="#cb43-814" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb43-815"><a href="#cb43-815" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Forecasted Revenue"</span>) <span class="sc">+</span></span>
<span id="cb43-816"><a href="#cb43-816" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb43-817"><a href="#cb43-817" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> dollar )</span>
<span id="cb43-818"><a href="#cb43-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-819"><a href="#cb43-819" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(forecast_rev)</span>
<span id="cb43-820"><a href="#cb43-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-821"><a href="#cb43-821" aria-hidden="true" tabindex="-1"></a><span class="co"># annotation &lt;- data.frame(</span></span>
<span id="cb43-822"><a href="#cb43-822" aria-hidden="true" tabindex="-1"></a><span class="co">#   x = c(2027, 2032),</span></span>
<span id="cb43-823"><a href="#cb43-823" aria-hidden="true" tabindex="-1"></a><span class="co">#   y = c(200000, 300000),  </span></span>
<span id="cb43-824"><a href="#cb43-824" aria-hidden="true" tabindex="-1"></a><span class="co">#   label = c("$120 billion in 2027","$135 billion in 2032")</span></span>
<span id="cb43-825"><a href="#cb43-825" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb43-826"><a href="#cb43-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-827"><a href="#cb43-827" aria-hidden="true" tabindex="-1"></a>annotation <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb43-828"><a href="#cb43-828" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">2020</span>, <span class="dv">2032</span>),</span>
<span id="cb43-829"><a href="#cb43-829" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">150000</span>, <span class="dv">200000</span>),  </span>
<span id="cb43-830"><a href="#cb43-830" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"$125 billion in 2027"</span>,<span class="st">"$141 billion in 2032"</span>)</span>
<span id="cb43-831"><a href="#cb43-831" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-832"><a href="#cb43-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-833"><a href="#cb43-833" aria-hidden="true" tabindex="-1"></a>q<span class="sc">+</span> <span class="fu">geom_label</span>(<span class="at">data =</span> annotation, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">label=</span>label), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb43-834"><a href="#cb43-834" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">caption =</span> <span class="st">"after dropping federal covid dollars"</span>)</span>
<span id="cb43-835"><a href="#cb43-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-836"><a href="#cb43-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-837"><a href="#cb43-837" aria-hidden="true" tabindex="-1"></a><span class="do">## Expenditures</span></span>
<span id="cb43-838"><a href="#cb43-838" aria-hidden="true" tabindex="-1"></a>tsexp <span class="ot">&lt;-</span> <span class="fu">ts</span>(year_totals2<span class="sc">$</span>Expenditures, <span class="at">start =</span> <span class="st">"1998"</span>, <span class="at">frequency =</span> <span class="dv">1</span>)</span>
<span id="cb43-839"><a href="#cb43-839" aria-hidden="true" tabindex="-1"></a>model_exp<span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(tsexp, <span class="at">seasonal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb43-840"><a href="#cb43-840" aria-hidden="true" tabindex="-1"></a><span class="co"># model_exp            # ARIMA (0,1,1) with drift</span></span>
<span id="cb43-841"><a href="#cb43-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-842"><a href="#cb43-842" aria-hidden="true" tabindex="-1"></a>forecast_exp <span class="ot">&lt;-</span> <span class="fu">forecast</span>(model_exp, <span class="at">h =</span> <span class="dv">20</span>) </span>
<span id="cb43-843"><a href="#cb43-843" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(forecast_exp, xlab ="",  ylab ="Total Expenditures", main ="Chicago Expenditures")</span></span>
<span id="cb43-844"><a href="#cb43-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-845"><a href="#cb43-845" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">forecast</span>(model_exp,  <span class="at">h =</span> <span class="dv">20</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb43-846"><a href="#cb43-846" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb43-847"><a href="#cb43-847" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Dollars (Millions)"</span>) <span class="sc">+</span></span>
<span id="cb43-848"><a href="#cb43-848" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb43-849"><a href="#cb43-849" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Forecasted Expenditures"</span>) <span class="sc">+</span></span>
<span id="cb43-850"><a href="#cb43-850" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb43-851"><a href="#cb43-851" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> dollar )</span>
<span id="cb43-852"><a href="#cb43-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-853"><a href="#cb43-853" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(forecast_exp)</span>
<span id="cb43-854"><a href="#cb43-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-855"><a href="#cb43-855" aria-hidden="true" tabindex="-1"></a>annotation <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb43-856"><a href="#cb43-856" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">2027</span>, <span class="dv">2032</span>),</span>
<span id="cb43-857"><a href="#cb43-857" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">139000</span>, <span class="dv">100000</span>),  <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"$117 ± 20 Billion in 2027"</span>,<span class="st">"$161 ± 20 Billion in 2032 "</span>)</span>
<span id="cb43-858"><a href="#cb43-858" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-859"><a href="#cb43-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-860"><a href="#cb43-860" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> </span>
<span id="cb43-861"><a href="#cb43-861" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> annotation, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">label=</span>label), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb43-862"><a href="#cb43-862" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Forecasted Expenditures"</span>, </span>
<span id="cb43-863"><a href="#cb43-863" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Projected values at 95% confidence interval. </span></span>
<span id="cb43-864"><a href="#cb43-864" aria-hidden="true" tabindex="-1"></a><span class="st">  Dark blue represents 80% liklihood of falling with that range, </span></span>
<span id="cb43-865"><a href="#cb43-865" aria-hidden="true" tabindex="-1"></a><span class="st">  light blue represents 95% liklihood of being in projected range."</span>)</span>
<span id="cb43-866"><a href="#cb43-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-867"><a href="#cb43-867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-868"><a href="#cb43-868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-869"><a href="#cb43-869" aria-hidden="true" tabindex="-1"></a><span class="do">## Exp and Rev together</span></span>
<span id="cb43-870"><a href="#cb43-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-871"><a href="#cb43-871" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(tsexp) <span class="sc">+</span></span>
<span id="cb43-872"><a href="#cb43-872" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_line(tsexp)+</span></span>
<span id="cb43-873"><a href="#cb43-873" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_line(aes(model_rev))+</span></span>
<span id="cb43-874"><a href="#cb43-874" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(forecast_rev, <span class="at">series =</span> <span class="st">"Revenue"</span>) <span class="sc">+</span></span>
<span id="cb43-875"><a href="#cb43-875" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(forecast_exp, <span class="at">series =</span> <span class="st">"Expenditure)"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb43-876"><a href="#cb43-876" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(year_totals, <span class="at">mapping=</span> <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Revenue))  <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="st">"Forecast"</span>)) <span class="sc">+</span> </span>
<span id="cb43-877"><a href="#cb43-877" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Forecasted Revenue and Expenditures"</span>, <span class="at">caption =</span> <span class="st">"Revenue includes State and Local CURE Dollars"</span>)</span>
<span id="cb43-878"><a href="#cb43-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-879"><a href="#cb43-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-880"><a href="#cb43-880" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-881"><a href="#cb43-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-882"><a href="#cb43-882" aria-hidden="true" tabindex="-1"></a>Revenue forecasting using precovid trends:</span>
<span id="cb43-883"><a href="#cb43-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-886"><a href="#cb43-886" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-887"><a href="#cb43-887" aria-hidden="true" tabindex="-1"></a><span class="co"># revenue using precovid trends</span></span>
<span id="cb43-888"><a href="#cb43-888" aria-hidden="true" tabindex="-1"></a>tsrev <span class="ot">&lt;-</span> <span class="fu">ts</span>(year_totals<span class="sc">$</span>Revenue, <span class="at">start =</span><span class="st">"1998"</span>, <span class="at">end =</span> <span class="st">"2020"</span>, <span class="at">frequency =</span> <span class="dv">1</span>) <span class="co"># yearly data</span></span>
<span id="cb43-889"><a href="#cb43-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-890"><a href="#cb43-890" aria-hidden="true" tabindex="-1"></a>tsexp2019 <span class="ot">&lt;-</span> <span class="fu">ts</span>(year_totals<span class="sc">$</span>Expenditures, <span class="at">start =</span><span class="st">"1998"</span>, <span class="at">end =</span> <span class="st">"2020"</span>, <span class="at">frequency =</span> <span class="dv">1</span>) <span class="co"># yearly data</span></span>
<span id="cb43-891"><a href="#cb43-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-892"><a href="#cb43-892" aria-hidden="true" tabindex="-1"></a><span class="do">#### revenue chart</span></span>
<span id="cb43-893"><a href="#cb43-893" aria-hidden="true" tabindex="-1"></a>model_rev <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(tsrev, <span class="at">seasonal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb43-894"><a href="#cb43-894" aria-hidden="true" tabindex="-1"></a>forecast_rev <span class="ot">&lt;-</span> <span class="fu">forecast</span>(model_rev, <span class="at">h =</span> <span class="dv">23</span>)</span>
<span id="cb43-895"><a href="#cb43-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-896"><a href="#cb43-896" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">forecast</span>(forecast_rev,  <span class="at">h =</span> <span class="dv">22</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb43-897"><a href="#cb43-897" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb43-898"><a href="#cb43-898" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Dollars (Millions)"</span>) <span class="sc">+</span></span>
<span id="cb43-899"><a href="#cb43-899" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb43-900"><a href="#cb43-900" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Forecasted Revenue"</span>) <span class="sc">+</span></span>
<span id="cb43-901"><a href="#cb43-901" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb43-902"><a href="#cb43-902" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> dollar )</span>
<span id="cb43-903"><a href="#cb43-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-904"><a href="#cb43-904" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(forecast_rev)</span>
<span id="cb43-905"><a href="#cb43-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-906"><a href="#cb43-906" aria-hidden="true" tabindex="-1"></a>annotation <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb43-907"><a href="#cb43-907" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">2020</span>, <span class="dv">2032</span>),</span>
<span id="cb43-908"><a href="#cb43-908" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">90000</span>, <span class="dv">100000</span>),  </span>
<span id="cb43-909"><a href="#cb43-909" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"$96 Billion in 2027"</span>,<span class="st">"$107 Billion in 2032"</span>)</span>
<span id="cb43-910"><a href="#cb43-910" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-911"><a href="#cb43-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-912"><a href="#cb43-912" aria-hidden="true" tabindex="-1"></a>c<span class="sc">+</span> <span class="fu">geom_label</span>(<span class="at">data =</span> annotation, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">label=</span>label), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb43-913"><a href="#cb43-913" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">"Revenue Forecasted using Pre-Covid Data"</span>, </span>
<span id="cb43-914"><a href="#cb43-914" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Own Source and Federal Revenues Combined"</span>)</span>
<span id="cb43-915"><a href="#cb43-915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-916"><a href="#cb43-916" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(tsexp2019) <span class="sc">+</span></span>
<span id="cb43-917"><a href="#cb43-917" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_line(tsexp)+</span></span>
<span id="cb43-918"><a href="#cb43-918" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_line(aes(model_rev))+</span></span>
<span id="cb43-919"><a href="#cb43-919" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(forecast_rev, <span class="at">series =</span> <span class="st">"Revenue"</span>) <span class="sc">+</span></span>
<span id="cb43-920"><a href="#cb43-920" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(forecast_exp, <span class="at">series =</span> <span class="st">"Expenditure)"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb43-921"><a href="#cb43-921" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(year_totals, <span class="at">mapping=</span> <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Revenue))  <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="st">"Forecast"</span>)) <span class="sc">+</span> </span>
<span id="cb43-922"><a href="#cb43-922" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Forecasted Revenue and Expenditures"</span>, <span class="at">subtitle =</span> <span class="st">"Using Pre-Covid revenue data (ending in FY2020) with Actual 2022 expenditures"</span>)</span>
<span id="cb43-923"><a href="#cb43-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-924"><a href="#cb43-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-925"><a href="#cb43-925" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-926"><a href="#cb43-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-929"><a href="#cb43-929" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-930"><a href="#cb43-930" aria-hidden="true" tabindex="-1"></a><span class="do">### Federal Revenue</span></span>
<span id="cb43-931"><a href="#cb43-931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-932"><a href="#cb43-932" aria-hidden="true" tabindex="-1"></a>fed_rev <span class="ot">&lt;-</span> ff_rev <span class="sc">%&gt;%</span> <span class="fu">select</span>(fy, rev_57, rev_58, rev_59) <span class="sc">%&gt;%</span></span>
<span id="cb43-933"><a href="#cb43-933" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fed_total =</span> rev_57<span class="sc">+</span>rev_58<span class="sc">+</span>rev_59)</span>
<span id="cb43-934"><a href="#cb43-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-935"><a href="#cb43-935" aria-hidden="true" tabindex="-1"></a>fed_ts57 <span class="ot">&lt;-</span> <span class="fu">ts</span>(fed_rev<span class="sc">$</span>rev_57, <span class="at">start =</span><span class="st">"1998"</span>, <span class="at">frequency =</span> <span class="dv">1</span>) <span class="co"># yearly data</span></span>
<span id="cb43-936"><a href="#cb43-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-937"><a href="#cb43-937" aria-hidden="true" tabindex="-1"></a>model_fed <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(fed_ts57, <span class="at">seasonal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb43-938"><a href="#cb43-938" aria-hidden="true" tabindex="-1"></a>forecast_fed <span class="ot">&lt;-</span> <span class="fu">forecast</span>(model_fed, <span class="at">h =</span> <span class="dv">23</span>)</span>
<span id="cb43-939"><a href="#cb43-939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-940"><a href="#cb43-940" aria-hidden="true" tabindex="-1"></a>fed57 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(forecast_fed,  <span class="at">h =</span> <span class="dv">20</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb43-941"><a href="#cb43-941" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb43-942"><a href="#cb43-942" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Nominal Dollars (Millions)"</span>) <span class="sc">+</span></span>
<span id="cb43-943"><a href="#cb43-943" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb43-944"><a href="#cb43-944" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Forecasted Federal Other Revenue"</span>) <span class="sc">+</span></span>
<span id="cb43-945"><a href="#cb43-945" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb43-946"><a href="#cb43-946" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> dollar )</span>
<span id="cb43-947"><a href="#cb43-947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-948"><a href="#cb43-948" aria-hidden="true" tabindex="-1"></a>fed57</span>
<span id="cb43-949"><a href="#cb43-949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-950"><a href="#cb43-950" aria-hidden="true" tabindex="-1"></a>fed_ts58 <span class="ot">&lt;-</span> <span class="fu">ts</span>(fed_rev<span class="sc">$</span>rev_58, <span class="at">start =</span><span class="st">"1998"</span>, <span class="at">frequency =</span> <span class="dv">1</span>) <span class="co"># yearly data</span></span>
<span id="cb43-951"><a href="#cb43-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-952"><a href="#cb43-952" aria-hidden="true" tabindex="-1"></a>model_fed <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(fed_ts58, <span class="at">seasonal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb43-953"><a href="#cb43-953" aria-hidden="true" tabindex="-1"></a>forecast_fed <span class="ot">&lt;-</span> <span class="fu">forecast</span>(model_fed, <span class="at">h =</span> <span class="dv">23</span>)</span>
<span id="cb43-954"><a href="#cb43-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-955"><a href="#cb43-955" aria-hidden="true" tabindex="-1"></a>fed58 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(forecast_fed,  <span class="at">h =</span> <span class="dv">20</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb43-956"><a href="#cb43-956" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb43-957"><a href="#cb43-957" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Nominal Dollars (Millions)"</span>) <span class="sc">+</span></span>
<span id="cb43-958"><a href="#cb43-958" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb43-959"><a href="#cb43-959" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Forecasted Federal Transfers for Transportation"</span>) <span class="sc">+</span></span>
<span id="cb43-960"><a href="#cb43-960" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb43-961"><a href="#cb43-961" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> dollar )</span>
<span id="cb43-962"><a href="#cb43-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-963"><a href="#cb43-963" aria-hidden="true" tabindex="-1"></a>fed58</span>
<span id="cb43-964"><a href="#cb43-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-965"><a href="#cb43-965" aria-hidden="true" tabindex="-1"></a>fed_ts59 <span class="ot">&lt;-</span> <span class="fu">ts</span>(fed_rev<span class="sc">$</span>rev_59, <span class="at">start =</span><span class="st">"1998"</span>, <span class="at">frequency =</span> <span class="dv">1</span>) <span class="co"># yearly data</span></span>
<span id="cb43-966"><a href="#cb43-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-967"><a href="#cb43-967" aria-hidden="true" tabindex="-1"></a>model_fed <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(fed_ts59, <span class="at">seasonal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb43-968"><a href="#cb43-968" aria-hidden="true" tabindex="-1"></a>forecast_fed <span class="ot">&lt;-</span> <span class="fu">forecast</span>(model_fed, <span class="at">h =</span> <span class="dv">23</span>)</span>
<span id="cb43-969"><a href="#cb43-969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-970"><a href="#cb43-970" aria-hidden="true" tabindex="-1"></a>fed59 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(forecast_fed,  <span class="at">h =</span> <span class="dv">20</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb43-971"><a href="#cb43-971" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb43-972"><a href="#cb43-972" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Nominal Dollars (Millions)"</span>) <span class="sc">+</span></span>
<span id="cb43-973"><a href="#cb43-973" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb43-974"><a href="#cb43-974" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Forecasted Federal Medicaid Reimbursements"</span>) <span class="sc">+</span></span>
<span id="cb43-975"><a href="#cb43-975" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb43-976"><a href="#cb43-976" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> dollar )</span>
<span id="cb43-977"><a href="#cb43-977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-978"><a href="#cb43-978" aria-hidden="true" tabindex="-1"></a>fed59</span>
<span id="cb43-979"><a href="#cb43-979" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-980"><a href="#cb43-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-983"><a href="#cb43-983" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-984"><a href="#cb43-984" aria-hidden="true" tabindex="-1"></a>fed_rev <span class="ot">&lt;-</span> ff_rev <span class="sc">%&gt;%</span> <span class="fu">select</span>(fy, rev_57, rev_58, rev_59) <span class="sc">%&gt;%</span></span>
<span id="cb43-985"><a href="#cb43-985" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fed_total =</span> rev_57<span class="sc">+</span>rev_58<span class="sc">+</span>rev_59)</span>
<span id="cb43-986"><a href="#cb43-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-987"><a href="#cb43-987" aria-hidden="true" tabindex="-1"></a>fed_tstotal <span class="ot">&lt;-</span> <span class="fu">ts</span>(fed_rev<span class="sc">$</span>fed_total, <span class="at">start =</span><span class="st">"1998"</span>, <span class="at">frequency =</span> <span class="dv">1</span>) <span class="co"># yearly data</span></span>
<span id="cb43-988"><a href="#cb43-988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-989"><a href="#cb43-989" aria-hidden="true" tabindex="-1"></a>model_fed <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(fed_tstotal, <span class="at">seasonal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb43-990"><a href="#cb43-990" aria-hidden="true" tabindex="-1"></a>forecast_fed <span class="ot">&lt;-</span> <span class="fu">forecast</span>(model_fed, <span class="at">h =</span> <span class="dv">23</span>)</span>
<span id="cb43-991"><a href="#cb43-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-992"><a href="#cb43-992" aria-hidden="true" tabindex="-1"></a>fedtotal <span class="ot">&lt;-</span> <span class="fu">forecast</span>(forecast_fed,  <span class="at">h =</span> <span class="dv">20</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb43-993"><a href="#cb43-993" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb43-994"><a href="#cb43-994" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Nominal Dollars (Millions)"</span>) <span class="sc">+</span></span>
<span id="cb43-995"><a href="#cb43-995" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb43-996"><a href="#cb43-996" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Forecasted Federal Revenue WITHOUT Federal COVID Dollars"</span>, <span class="at">subtitle =</span> <span class="st">"Sum of Transportation, Medicaid, and Other Federal Revenue"</span>) <span class="sc">+</span></span>
<span id="cb43-997"><a href="#cb43-997" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb43-998"><a href="#cb43-998" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> dollar ) </span>
<span id="cb43-999"><a href="#cb43-999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1000"><a href="#cb43-1000" aria-hidden="true" tabindex="-1"></a>fedtotal</span>
<span id="cb43-1001"><a href="#cb43-1001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1002"><a href="#cb43-1002" aria-hidden="true" tabindex="-1"></a><span class="co">#fed_tstotal &lt;- ts(fed_rev$fed_total, start ="1998", end = "2020", frequency = 1) # yearly data</span></span>
<span id="cb43-1003"><a href="#cb43-1003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1004"><a href="#cb43-1004" aria-hidden="true" tabindex="-1"></a><span class="co">#model_fed2 &lt;- auto.arima(fed_tstotal, seasonal = FALSE)</span></span>
<span id="cb43-1005"><a href="#cb43-1005" aria-hidden="true" tabindex="-1"></a><span class="co">#forecast_fed2 &lt;- forecast(model_fed2, h = 23)</span></span>
<span id="cb43-1006"><a href="#cb43-1006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1007"><a href="#cb43-1007" aria-hidden="true" tabindex="-1"></a><span class="co"># fedtotal2 &lt;- forecast(forecast_fed2,  h = 20) %&gt;% </span></span>
<span id="cb43-1008"><a href="#cb43-1008" aria-hidden="true" tabindex="-1"></a><span class="co">#   autoplot() +</span></span>
<span id="cb43-1009"><a href="#cb43-1009" aria-hidden="true" tabindex="-1"></a><span class="co">#     ylab("Nominal Dollars (Millions)") +</span></span>
<span id="cb43-1010"><a href="#cb43-1010" aria-hidden="true" tabindex="-1"></a><span class="co">#   xlab("Year") +</span></span>
<span id="cb43-1011"><a href="#cb43-1011" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggtitle("Forecasted Federal Revenue -- pre-COVID trends", subtitle = "Sum of Transportation, Medicaid, and Other Federal Revenue") +</span></span>
<span id="cb43-1012"><a href="#cb43-1012" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_classic() +</span></span>
<span id="cb43-1013"><a href="#cb43-1013" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_y_continuous(labels = dollar ) </span></span>
<span id="cb43-1014"><a href="#cb43-1014" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb43-1015"><a href="#cb43-1015" aria-hidden="true" tabindex="-1"></a><span class="co"># fedtotal2</span></span>
<span id="cb43-1016"><a href="#cb43-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1017"><a href="#cb43-1017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1018"><a href="#cb43-1018" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(tsexp2019) <span class="sc">+</span></span>
<span id="cb43-1019"><a href="#cb43-1019" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_line(tsexp)+</span></span>
<span id="cb43-1020"><a href="#cb43-1020" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_line(aes(model_rev))+</span></span>
<span id="cb43-1021"><a href="#cb43-1021" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(forecast_fed, <span class="at">series =</span> <span class="st">"No Fed Stim Packages"</span>) <span class="sc">+</span></span>
<span id="cb43-1022"><a href="#cb43-1022" aria-hidden="true" tabindex="-1"></a>  <span class="co">#autolayer(forecast_fed2, series = "Pre-Covid Fed Rev)", alpha = 0.5) +</span></span>
<span id="cb43-1023"><a href="#cb43-1023" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(year_totals2, <span class="at">mapping=</span> <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Revenue))  <span class="sc">+</span> </span>
<span id="cb43-1024"><a href="#cb43-1024" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="st">"Forecast"</span>)) <span class="sc">+</span> </span>
<span id="cb43-1025"><a href="#cb43-1025" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Comparison of Combined Federal Revenue without Stimulus Packages and </span><span class="sc">\n</span><span class="st">Pre-COVID revenue trend"</span> , </span>
<span id="cb43-1026"><a href="#cb43-1026" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Using Pre-Covid revenue data (ending in FY2020)"</span>)</span>
<span id="cb43-1027"><a href="#cb43-1027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1028"><a href="#cb43-1028" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-1029"><a href="#cb43-1029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1030"><a href="#cb43-1030" aria-hidden="true" tabindex="-1"></a>Graphing the 3 federal revenue types together may be the most reliable since some COVID funding is still recorded in Federal Other and some are in other categories (like Disaster Response in FY2021). Need to look at more before using.</span>
<span id="cb43-1031"><a href="#cb43-1031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1032"><a href="#cb43-1032" aria-hidden="true" tabindex="-1"></a><span class="in">```{r drop-coviddollars3}</span></span>
<span id="cb43-1033"><a href="#cb43-1033" aria-hidden="true" tabindex="-1"></a><span class="in"># does not include rev_type == 58, medicaid dollars</span></span>
<span id="cb43-1034"><a href="#cb43-1034" aria-hidden="true" tabindex="-1"></a><span class="in"># covid_dollars &lt;- rev_temp %&gt;% filter(covid_dollars==1) # check what was dropped</span></span>
<span id="cb43-1035"><a href="#cb43-1035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1036"><a href="#cb43-1036" aria-hidden="true" tabindex="-1"></a><span class="in">#covid_dollars %&gt;% group_by(fy,rev_type) %&gt;% summarize(receipts = sum(receipts)) %&gt;% pivot_wider(names_from="rev_type", values_from = "receipts")</span></span>
<span id="cb43-1037"><a href="#cb43-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1038"><a href="#cb43-1038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1039"><a href="#cb43-1039" aria-hidden="true" tabindex="-1"></a><span class="in">rev_temp &lt;- rev_temp %&gt;%  filter(covid_dollars==0) # keeps observations that were not coded as COVID federal funds</span></span>
<span id="cb43-1040"><a href="#cb43-1040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1041"><a href="#cb43-1041" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1042"><a href="#cb43-1042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1043"><a href="#cb43-1043" aria-hidden="true" tabindex="-1"></a><span class="in">ff_rev &lt;- rev_temp %&gt;% </span></span>
<span id="cb43-1044"><a href="#cb43-1044" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(rev_type_new, fy) %&gt;% </span></span>
<span id="cb43-1045"><a href="#cb43-1045" aria-hidden="true" tabindex="-1"></a><span class="in">  summarize(sum_receipts = sum(receipts, na.rm=TRUE)/1000000 ) %&gt;%</span></span>
<span id="cb43-1046"><a href="#cb43-1046" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_wider(names_from = "rev_type_new", values_from = "sum_receipts", names_prefix = "rev_")</span></span>
<span id="cb43-1047"><a href="#cb43-1047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1048"><a href="#cb43-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1049"><a href="#cb43-1049" aria-hidden="true" tabindex="-1"></a><span class="in">ff_rev &lt;- mutate_all(ff_rev, ~replace_na(.,0))</span></span>
<span id="cb43-1050"><a href="#cb43-1050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1051"><a href="#cb43-1051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1052"><a href="#cb43-1052" aria-hidden="true" tabindex="-1"></a><span class="in">rev_long &lt;- pivot_longer(ff_rev, rev_02:rev_78, names_to = c("type","Category"), values_to = "Dollars", names_sep = "_") %&gt;% </span></span>
<span id="cb43-1053"><a href="#cb43-1053" aria-hidden="true" tabindex="-1"></a><span class="in">  rename(Year = fy) %&gt;%</span></span>
<span id="cb43-1054"><a href="#cb43-1054" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(Category_name = case_when(</span></span>
<span id="cb43-1055"><a href="#cb43-1055" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "02" ~ "INDIVIDUAL INCOME TAX" ,</span></span>
<span id="cb43-1056"><a href="#cb43-1056" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "03" ~ "CORPORATE INCOME TAX" ,</span></span>
<span id="cb43-1057"><a href="#cb43-1057" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "06" ~ "SALES TAX" ,</span></span>
<span id="cb43-1058"><a href="#cb43-1058" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "09" ~ "MOTOR FUEL TAX" ,</span></span>
<span id="cb43-1059"><a href="#cb43-1059" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "12" ~ "PUBLIC UTILITY TAX" ,</span></span>
<span id="cb43-1060"><a href="#cb43-1060" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "15" ~ "CIGARETTE TAXES" ,</span></span>
<span id="cb43-1061"><a href="#cb43-1061" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "18" ~ "LIQUOR GALLONAGE TAXES" ,</span></span>
<span id="cb43-1062"><a href="#cb43-1062" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "21" ~ "INHERITANCE TAX" ,</span></span>
<span id="cb43-1063"><a href="#cb43-1063" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "24" ~ "INSURANCE TAXES&amp;FEES&amp;LICENSES" ,</span></span>
<span id="cb43-1064"><a href="#cb43-1064" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "27" ~ "CORP FRANCHISE TAXES &amp; FEES" ,</span></span>
<span id="cb43-1065"><a href="#cb43-1065" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "30" ~ "HORSE RACING TAXES &amp; FEES",  # in Other</span></span>
<span id="cb43-1066"><a href="#cb43-1066" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "31" ~ "MEDICAL PROVIDER ASSESSMENTS" ,</span></span>
<span id="cb43-1067"><a href="#cb43-1067" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "32" ~ "GARNISHMENT-LEVIES" , # dropped</span></span>
<span id="cb43-1068"><a href="#cb43-1068" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "33" ~  "LOTTERY RECEIPTS" ,</span></span>
<span id="cb43-1069"><a href="#cb43-1069" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "35" ~  "OTHER TAXES" ,</span></span>
<span id="cb43-1070"><a href="#cb43-1070" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "36" ~  "RECEIPTS FROM REVENUE PRODUCING", </span></span>
<span id="cb43-1071"><a href="#cb43-1071" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "39" ~  "LICENSES, FEES &amp; REGISTRATIONS" ,</span></span>
<span id="cb43-1072"><a href="#cb43-1072" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "42" ~  "MOTOR VEHICLE AND OPERATORS" ,</span></span>
<span id="cb43-1073"><a href="#cb43-1073" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "45" ~  "STUDENT FEES-UNIVERSITIES",   # dropped</span></span>
<span id="cb43-1074"><a href="#cb43-1074" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "48" ~  "RIVERBOAT WAGERING TAXES" ,</span></span>
<span id="cb43-1075"><a href="#cb43-1075" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "51" ~  "RETIREMENT CONTRIBUTIONS" , # dropped</span></span>
<span id="cb43-1076"><a href="#cb43-1076" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "54" ~ "GIFTS AND BEQUESTS", </span></span>
<span id="cb43-1077"><a href="#cb43-1077" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "57" ~  "FEDERAL OTHER" ,</span></span>
<span id="cb43-1078"><a href="#cb43-1078" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "58" ~  "FEDERAL MEDICAID", </span></span>
<span id="cb43-1079"><a href="#cb43-1079" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "59" ~  "FEDERAL TRANSPORTATION" ,</span></span>
<span id="cb43-1080"><a href="#cb43-1080" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "60" ~  "OTHER GRANTS AND CONTRACTS", #other</span></span>
<span id="cb43-1081"><a href="#cb43-1081" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "63" ~  "INVESTMENT INCOME", # other</span></span>
<span id="cb43-1082"><a href="#cb43-1082" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "66" ~ "PROCEEDS,INVESTMENT MATURITIES" , #dropped</span></span>
<span id="cb43-1083"><a href="#cb43-1083" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "72" ~ "BOND ISSUE PROCEEDS",  #dropped</span></span>
<span id="cb43-1084"><a href="#cb43-1084" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "75" ~  "INTER-AGENCY RECEIPTS ",  #dropped</span></span>
<span id="cb43-1085"><a href="#cb43-1085" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "76" ~  "TRANSFER IN FROM OUT FUNDS",  #other</span></span>
<span id="cb43-1086"><a href="#cb43-1086" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "78" ~  "ALL OTHER SOURCES" ,</span></span>
<span id="cb43-1087"><a href="#cb43-1087" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "79" ~   "COOK COUNTY IGT", #dropped</span></span>
<span id="cb43-1088"><a href="#cb43-1088" aria-hidden="true" tabindex="-1"></a><span class="in">    Category == "98" ~  "PRIOR YEAR REFUNDS", #dropped</span></span>
<span id="cb43-1089"><a href="#cb43-1089" aria-hidden="true" tabindex="-1"></a><span class="in">                 T ~ "Check Me!"</span></span>
<span id="cb43-1090"><a href="#cb43-1090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1091"><a href="#cb43-1091" aria-hidden="true" tabindex="-1"></a><span class="in">  ) )%&gt;% </span></span>
<span id="cb43-1092"><a href="#cb43-1092" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(Category_name = str_to_title(Category_name))</span></span>
<span id="cb43-1093"><a href="#cb43-1093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1094"><a href="#cb43-1094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1095"><a href="#cb43-1095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1096"><a href="#cb43-1096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1097"><a href="#cb43-1097" aria-hidden="true" tabindex="-1"></a><span class="in">exp_long &lt;- pivot_longer(ff_exp, exp_402:exp_970 , names_to = c("type", "Category"), values_to = "Dollars", names_sep = "_") %&gt;% </span></span>
<span id="cb43-1098"><a href="#cb43-1098" aria-hidden="true" tabindex="-1"></a><span class="in">  rename(Year = fy ) %&gt;% </span></span>
<span id="cb43-1099"><a href="#cb43-1099" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(Category_name = </span></span>
<span id="cb43-1100"><a href="#cb43-1100" aria-hidden="true" tabindex="-1"></a><span class="in">           case_when(</span></span>
<span id="cb43-1101"><a href="#cb43-1101" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "402" ~ "AGING" ,</span></span>
<span id="cb43-1102"><a href="#cb43-1102" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "406" ~ "AGRICULTURE", </span></span>
<span id="cb43-1103"><a href="#cb43-1103" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "416" ~ "CENTRAL MANAGEMENT",</span></span>
<span id="cb43-1104"><a href="#cb43-1104" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "418" ~ "CHILDREN AND FAMILY SERVICES", </span></span>
<span id="cb43-1105"><a href="#cb43-1105" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "420" ~ "COMMERCE AND ECONOMIC OPPORTUNITY",</span></span>
<span id="cb43-1106"><a href="#cb43-1106" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "422" ~ "NATURAL RESOURCES" ,</span></span>
<span id="cb43-1107"><a href="#cb43-1107" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "426" ~ "CORRECTIONS",</span></span>
<span id="cb43-1108"><a href="#cb43-1108" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "427" ~ "EMPLOYMENT SECURITY" ,</span></span>
<span id="cb43-1109"><a href="#cb43-1109" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "444" ~ "HUMAN SERVICES" ,</span></span>
<span id="cb43-1110"><a href="#cb43-1110" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "448" ~ "Innovation and Technology", # AWM added fy2022</span></span>
<span id="cb43-1111"><a href="#cb43-1111" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "478" ~ "HEALTHCARE &amp; FAM SER NET OF MEDICAID", </span></span>
<span id="cb43-1112"><a href="#cb43-1112" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "482" ~ "PUBLIC HEALTH", </span></span>
<span id="cb43-1113"><a href="#cb43-1113" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "492" ~ "REVENUE", </span></span>
<span id="cb43-1114"><a href="#cb43-1114" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "494" ~ "TRANSPORTATION" ,</span></span>
<span id="cb43-1115"><a href="#cb43-1115" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "532" ~ "ENVIRONMENTAL PROTECT AGENCY" ,</span></span>
<span id="cb43-1116"><a href="#cb43-1116" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "557" ~ "IL STATE TOLL HIGHWAY AUTH" ,</span></span>
<span id="cb43-1117"><a href="#cb43-1117" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "684" ~ "IL COMMUNITY COLLEGE BOARD", </span></span>
<span id="cb43-1118"><a href="#cb43-1118" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "691" ~ "IL STUDENT ASSISTANCE COMM" ,</span></span>
<span id="cb43-1119"><a href="#cb43-1119" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "900" ~ "NOT IN FRAME",</span></span>
<span id="cb43-1120"><a href="#cb43-1120" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "901" ~ "STATE PENSION CONTRIBUTION",</span></span>
<span id="cb43-1121"><a href="#cb43-1121" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "903" ~ "DEBT SERVICE",</span></span>
<span id="cb43-1122"><a href="#cb43-1122" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "904" ~ "State Employee Healthcare",</span></span>
<span id="cb43-1123"><a href="#cb43-1123" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "910" ~ "LEGISLATIVE"  ,</span></span>
<span id="cb43-1124"><a href="#cb43-1124" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "920" ~ "JUDICIAL" ,</span></span>
<span id="cb43-1125"><a href="#cb43-1125" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "930" ~ "ELECTED OFFICERS" , </span></span>
<span id="cb43-1126"><a href="#cb43-1126" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "940" ~ "OTHER HEALTH-RELATED", </span></span>
<span id="cb43-1127"><a href="#cb43-1127" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "941" ~ "PUBLIC SAFETY" ,</span></span>
<span id="cb43-1128"><a href="#cb43-1128" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "942" ~ "ECON DEVT &amp; INFRASTRUCTURE" ,</span></span>
<span id="cb43-1129"><a href="#cb43-1129" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "943" ~ "CENTRAL SERVICES",</span></span>
<span id="cb43-1130"><a href="#cb43-1130" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "944" ~ "BUS &amp; PROFESSION REGULATION" ,</span></span>
<span id="cb43-1131"><a href="#cb43-1131" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "945" ~ "MEDICAID" ,</span></span>
<span id="cb43-1132"><a href="#cb43-1132" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "946" ~ "CAPITAL IMPROVEMENT" , </span></span>
<span id="cb43-1133"><a href="#cb43-1133" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "948" ~ "OTHER DEPARTMENTS" ,</span></span>
<span id="cb43-1134"><a href="#cb43-1134" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "949" ~ "OTHER BOARDS &amp; COMMISSIONS" ,</span></span>
<span id="cb43-1135"><a href="#cb43-1135" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "959" ~ "K-12 EDUCATION" ,</span></span>
<span id="cb43-1136"><a href="#cb43-1136" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "960" ~ "UNIVERSITY EDUCATION",</span></span>
<span id="cb43-1137"><a href="#cb43-1137" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "970" ~ "Local Govt Transfers",</span></span>
<span id="cb43-1138"><a href="#cb43-1138" aria-hidden="true" tabindex="-1"></a><span class="in">             T ~ "CHECK ME!")</span></span>
<span id="cb43-1139"><a href="#cb43-1139" aria-hidden="true" tabindex="-1"></a><span class="in">           ) %&gt;% </span></span>
<span id="cb43-1140"><a href="#cb43-1140" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(Category_name = str_to_title(Category_name))</span></span>
<span id="cb43-1141"><a href="#cb43-1141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1142"><a href="#cb43-1142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1143"><a href="#cb43-1143" aria-hidden="true" tabindex="-1"></a><span class="in">#exp_long_nototals &lt;- exp_long %&gt;% filter(Category_name != "Totals")</span></span>
<span id="cb43-1144"><a href="#cb43-1144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1145"><a href="#cb43-1145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1146"><a href="#cb43-1146" aria-hidden="true" tabindex="-1"></a><span class="in">aggregated_totals_long &lt;- rbind(rev_long, exp_long) </span></span>
<span id="cb43-1147"><a href="#cb43-1147" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-1148"><a href="#cb43-1148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1149"><a href="#cb43-1149" aria-hidden="true" tabindex="-1"></a>Change plots:</span>
<span id="cb43-1150"><a href="#cb43-1150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1153"><a href="#cb43-1153" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-1154"><a href="#cb43-1154" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-totals-without-FederalStimulus</span></span>
<span id="cb43-1155"><a href="#cb43-1155" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: Fiscal Gap without State CURE Federal Revenue</span></span>
<span id="cb43-1156"><a href="#cb43-1156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1157"><a href="#cb43-1157" aria-hidden="true" tabindex="-1"></a>year_totals2 <span class="ot">&lt;-</span> aggregated_totals_long <span class="sc">%&gt;%</span> </span>
<span id="cb43-1158"><a href="#cb43-1158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(type, Year) <span class="sc">%&gt;%</span> </span>
<span id="cb43-1159"><a href="#cb43-1159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Dollars =</span> <span class="fu">sum</span>(Dollars, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb43-1160"><a href="#cb43-1160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"type"</span>, <span class="at">values_from =</span> Dollars) <span class="sc">%&gt;%</span> </span>
<span id="cb43-1161"><a href="#cb43-1161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb43-1162"><a href="#cb43-1162" aria-hidden="true" tabindex="-1"></a>         <span class="at">Expenditures =</span> exp,</span>
<span id="cb43-1163"><a href="#cb43-1163" aria-hidden="true" tabindex="-1"></a>         <span class="at">Revenue =</span> rev) <span class="sc">%&gt;%</span>  </span>
<span id="cb43-1164"><a href="#cb43-1164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Fiscal Gap</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(Revenue <span class="sc">-</span> Expenditures)) <span class="sc">%&gt;%</span> </span>
<span id="cb43-1165"><a href="#cb43-1165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Year))</span>
<span id="cb43-1166"><a href="#cb43-1166" aria-hidden="true" tabindex="-1"></a><span class="co"># creates variable for the Gap each year</span></span>
<span id="cb43-1167"><a href="#cb43-1167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1168"><a href="#cb43-1168" aria-hidden="true" tabindex="-1"></a>year_totals2 <span class="co"># gap for FY22 changed to ~2 or 3 billion</span></span>
<span id="cb43-1169"><a href="#cb43-1169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1170"><a href="#cb43-1170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1171"><a href="#cb43-1171" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-1172"><a href="#cb43-1172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1175"><a href="#cb43-1175" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-1176"><a href="#cb43-1176" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-withandwithout-stateCURE</span></span>
<span id="cb43-1177"><a href="#cb43-1177" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Illinois Revenue Trend</span></span>
<span id="cb43-1178"><a href="#cb43-1178" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-subcap: </span></span>
<span id="cb43-1179"><a href="#cb43-1179" aria-hidden="true" tabindex="-1"></a><span class="co">#| - "With State CURE"</span></span>
<span id="cb43-1180"><a href="#cb43-1180" aria-hidden="true" tabindex="-1"></a><span class="co">#| - "Without State CURE"</span></span>
<span id="cb43-1181"><a href="#cb43-1181" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap-location: top</span></span>
<span id="cb43-1182"><a href="#cb43-1182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1183"><a href="#cb43-1183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1184"><a href="#cb43-1184" aria-hidden="true" tabindex="-1"></a>annotation_billions <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb43-1185"><a href="#cb43-1185" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">2004</span>, <span class="dv">2017</span>, <span class="dv">2019</span>),</span>
<span id="cb43-1186"><a href="#cb43-1186" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">50</span>, <span class="dv">10</span>),</span>
<span id="cb43-1187"><a href="#cb43-1187" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"Expenditures"</span>,<span class="st">"Revenue"</span>, <span class="st">"Fiscal Gap"</span>))</span>
<span id="cb43-1188"><a href="#cb43-1188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1189"><a href="#cb43-1189" aria-hidden="true" tabindex="-1"></a>fiscal_gap1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> year_totals, <span class="fu">aes</span>(<span class="at">x=</span>Year, <span class="at">y =</span> Revenue<span class="sc">/</span><span class="dv">1000</span>)) <span class="sc">+</span></span>
<span id="cb43-1190"><a href="#cb43-1190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_recessions</span>(<span class="at">text =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb43-1191"><a href="#cb43-1191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb43-1192"><a href="#cb43-1192" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Revenue<span class="sc">/</span><span class="dv">1000</span>), <span class="at">color =</span> <span class="st">"Black"</span>, <span class="at">lwd=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb43-1193"><a href="#cb43-1193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Expenditures<span class="sc">/</span><span class="dv">1000</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">lwd=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb43-1194"><a href="#cb43-1194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> <span class="st">`</span><span class="at">Fiscal Gap</span><span class="st">`</span><span class="sc">/</span><span class="dv">1000</span>), <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb43-1195"><a href="#cb43-1195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1196"><a href="#cb43-1196" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> annotation_billions, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">label=</span>label))<span class="sc">+</span></span>
<span id="cb43-1197"><a href="#cb43-1197" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb43-1198"><a href="#cb43-1198" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>, <span class="co">#axis.text.y = element_blank(),</span></span>
<span id="cb43-1199"><a href="#cb43-1199" aria-hidden="true" tabindex="-1"></a>        <span class="co">#axis.ticks.y = element_blank(),</span></span>
<span id="cb43-1200"><a href="#cb43-1200" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb43-1201"><a href="#cb43-1201" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"dashed"</span>, <span class="st">"dashed"</span>)) <span class="sc">+</span></span>
<span id="cb43-1202"><a href="#cb43-1202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">16</span>, <span class="dv">120</span>), <span class="at">labels =</span> comma)<span class="sc">+</span></span>
<span id="cb43-1203"><a href="#cb43-1203" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">1998</span>,<span class="dv">2023</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb43-1204"><a href="#cb43-1204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1205"><a href="#cb43-1205" aria-hidden="true" tabindex="-1"></a>fiscal_gap1</span>
<span id="cb43-1206"><a href="#cb43-1206" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave(fiscal_gap1, file = "Figure7a-WithCURE.eps")</span></span>
<span id="cb43-1207"><a href="#cb43-1207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1208"><a href="#cb43-1208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1209"><a href="#cb43-1209" aria-hidden="true" tabindex="-1"></a>fiscal_gap_droppedCURE <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> year_totals2, <span class="fu">aes</span>(<span class="at">x=</span>Year, <span class="at">y =</span> Revenue<span class="sc">/</span><span class="dv">1000</span>)) <span class="sc">+</span></span>
<span id="cb43-1210"><a href="#cb43-1210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_recessions</span>(<span class="at">text =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb43-1211"><a href="#cb43-1211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb43-1212"><a href="#cb43-1212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1213"><a href="#cb43-1213" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb43-1214"><a href="#cb43-1214" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Revenue<span class="sc">/</span><span class="dv">1000</span>), <span class="at">color =</span> <span class="st">"Black"</span>, <span class="at">lwd=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb43-1215"><a href="#cb43-1215" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Expenditures<span class="sc">/</span><span class="dv">1000</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">lwd=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb43-1216"><a href="#cb43-1216" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> <span class="st">`</span><span class="at">Fiscal Gap</span><span class="st">`</span><span class="sc">/</span><span class="dv">1000</span>), <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb43-1217"><a href="#cb43-1217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1218"><a href="#cb43-1218" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> annotation_billions, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">label=</span>label))<span class="sc">+</span></span>
<span id="cb43-1219"><a href="#cb43-1219" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb43-1220"><a href="#cb43-1220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,<span class="co"># axis.text.y = element_blank(),</span></span>
<span id="cb43-1221"><a href="#cb43-1221" aria-hidden="true" tabindex="-1"></a>                                    <span class="co">#axis.ticks.y = element_blank(),</span></span>
<span id="cb43-1222"><a href="#cb43-1222" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>() )<span class="sc">+</span></span>
<span id="cb43-1223"><a href="#cb43-1223" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"dashed"</span>, <span class="st">"dashed"</span>)) <span class="sc">+</span></span>
<span id="cb43-1224"><a href="#cb43-1224" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">16</span>,<span class="dv">120</span>), <span class="at">labels =</span> comma)<span class="sc">+</span></span>
<span id="cb43-1225"><a href="#cb43-1225" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">1998</span>,<span class="dv">2023</span>),<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb43-1226"><a href="#cb43-1226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1227"><a href="#cb43-1227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1228"><a href="#cb43-1228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1229"><a href="#cb43-1229" aria-hidden="true" tabindex="-1"></a>  <span class="co"># # geom_smooth adds regression line, graphed first so it appears behind line graph</span></span>
<span id="cb43-1230"><a href="#cb43-1230" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_smooth(aes(x = Year, y = Revenue), color = "gray", method = "lm", se = FALSE) + </span></span>
<span id="cb43-1231"><a href="#cb43-1231" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_smooth(aes(x = Year, y = Expenditures), color = "rosybrown2", method = "lm", se = FALSE) +</span></span>
<span id="cb43-1232"><a href="#cb43-1232" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb43-1233"><a href="#cb43-1233" aria-hidden="true" tabindex="-1"></a>  <span class="co"># # line graph of revenue and expenditures</span></span>
<span id="cb43-1234"><a href="#cb43-1234" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_line(aes(x = Year, y = Revenue), color = "black", size=1) +</span></span>
<span id="cb43-1235"><a href="#cb43-1235" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_line(aes(x = Year, y = Expenditures), color = "red", size=1) +</span></span>
<span id="cb43-1236"><a href="#cb43-1236" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_line(aes(x=Year, y = `Fiscal Gap`), color="gray") +</span></span>
<span id="cb43-1237"><a href="#cb43-1237" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb43-1238"><a href="#cb43-1238" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_text(data= annotation, aes(x=x, y = y, label=label))+</span></span>
<span id="cb43-1239"><a href="#cb43-1239" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb43-1240"><a href="#cb43-1240" aria-hidden="true" tabindex="-1"></a>  <span class="co"># # labels</span></span>
<span id="cb43-1241"><a href="#cb43-1241" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   theme_bw() +</span></span>
<span id="cb43-1242"><a href="#cb43-1242" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_y_continuous(labels = comma)+</span></span>
<span id="cb43-1243"><a href="#cb43-1243" aria-hidden="true" tabindex="-1"></a>  <span class="co"># xlab("Year") + </span></span>
<span id="cb43-1244"><a href="#cb43-1244" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ylab("Millions of Dollars")  +</span></span>
<span id="cb43-1245"><a href="#cb43-1245" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ggtitle("Illinois Expenditures and Revenue Totals, 1998-2022")</span></span>
<span id="cb43-1246"><a href="#cb43-1246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1247"><a href="#cb43-1247" aria-hidden="true" tabindex="-1"></a>  fiscal_gap_droppedCURE</span>
<span id="cb43-1248"><a href="#cb43-1248" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-1249"><a href="#cb43-1249" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave(fiscal_gap_droppedCURE, file = "Figure7b-WithoutCURE.eps")</span></span>
<span id="cb43-1250"><a href="#cb43-1250" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-1251"><a href="#cb43-1251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1252"><a href="#cb43-1252" aria-hidden="true" tabindex="-1"></a>Compare with and without federal COVID dollars:</span>
<span id="cb43-1253"><a href="#cb43-1253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1254"><a href="#cb43-1254" aria-hidden="true" tabindex="-1"></a><span class="in">```{r include=FALSE}</span></span>
<span id="cb43-1255"><a href="#cb43-1255" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-both-graphs-comparison</span></span>
<span id="cb43-1256"><a href="#cb43-1256" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: Comparison of revenue with and without federal State CURE funds.</span></span>
<span id="cb43-1257"><a href="#cb43-1257" aria-hidden="true" tabindex="-1"></a><span class="in">library(gridExtra)</span></span>
<span id="cb43-1258"><a href="#cb43-1258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1259"><a href="#cb43-1259" aria-hidden="true" tabindex="-1"></a><span class="in">with_without_CURE&lt;- cowplot::plot_grid(fiscal_gap1,</span></span>
<span id="cb43-1260"><a href="#cb43-1260" aria-hidden="true" tabindex="-1"></a><span class="in">                   fiscal_gap_droppedCURE, ncol=2, labels = c("With State CURE", "Without State Cure"))</span></span>
<span id="cb43-1261"><a href="#cb43-1261" aria-hidden="true" tabindex="-1"></a><span class="in">with_without_CURE</span></span>
<span id="cb43-1262"><a href="#cb43-1262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1263"><a href="#cb43-1263" aria-hidden="true" tabindex="-1"></a><span class="in">#ggsave(plot = with_without_CURE, file = "Figure7.eps")</span></span>
<span id="cb43-1264"><a href="#cb43-1264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1265"><a href="#cb43-1265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1266"><a href="#cb43-1266" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-1267"><a href="#cb43-1267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1268"><a href="#cb43-1268" aria-hidden="true" tabindex="-1"></a>**Revenue amounts in millions of dollars:**</span>
<span id="cb43-1269"><a href="#cb43-1269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1272"><a href="#cb43-1272" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-1273"><a href="#cb43-1273" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-revlong-bargraphs</span></span>
<span id="cb43-1274"><a href="#cb43-1274" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Comparison of revenue with and without federal State CURE funds.</span></span>
<span id="cb43-1275"><a href="#cb43-1275" aria-hidden="true" tabindex="-1"></a>rev_long <span class="sc">%&gt;%</span></span>
<span id="cb43-1276"><a href="#cb43-1276" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="dv">2023</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-1277"><a href="#cb43-1277" aria-hidden="true" tabindex="-1"></a>  <span class="co">#mutate(`Total Expenditures`= sum(Dollars, na.rm = TRUE)) %&gt;%</span></span>
<span id="cb43-1278"><a href="#cb43-1278" aria-hidden="true" tabindex="-1"></a> <span class="co"># select(-c(Year, `Total Expenditures`)) %&gt;%</span></span>
<span id="cb43-1279"><a href="#cb43-1279" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="st">`</span><span class="at">Dollars</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb43-1280"><a href="#cb43-1280" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb43-1281"><a href="#cb43-1281" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_reorder</span>(Category_name, <span class="st">`</span><span class="at">Dollars</span><span class="st">`</span>), <span class="at">y =</span> <span class="st">`</span><span class="at">Dollars</span><span class="st">`</span>))<span class="sc">+</span> </span>
<span id="cb43-1282"><a href="#cb43-1282" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb43-1283"><a href="#cb43-1283" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb43-1284"><a href="#cb43-1284" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Revenues for FY2023"</span>)<span class="sc">+</span></span>
<span id="cb43-1285"><a href="#cb43-1285" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Revenue Categories"</span>) <span class="sc">+</span></span>
<span id="cb43-1286"><a href="#cb43-1286" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Millions of Dollars"</span>)</span>
<span id="cb43-1287"><a href="#cb43-1287" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-1288"><a href="#cb43-1288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1289"><a href="#cb43-1289" aria-hidden="true" tabindex="-1"></a><span class="fu">### All Categories with Totals</span></span>
<span id="cb43-1290"><a href="#cb43-1290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1293"><a href="#cb43-1293" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-1294"><a href="#cb43-1294" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-rev-tables-droppedCURE</span></span>
<span id="cb43-1295"><a href="#cb43-1295" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: Revenue without State CURE </span></span>
<span id="cb43-1296"><a href="#cb43-1296" aria-hidden="true" tabindex="-1"></a>exp_totals <span class="ot">&lt;-</span> ff_exp <span class="sc">%&gt;%</span> <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">exp_TOTALS =</span> <span class="fu">sum</span>(<span class="fu">across</span>(exp_402<span class="sc">:</span>exp_970)))</span>
<span id="cb43-1297"><a href="#cb43-1297" aria-hidden="true" tabindex="-1"></a>rev_totals <span class="ot">&lt;-</span> ff_rev <span class="sc">%&gt;%</span>    <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb43-1298"><a href="#cb43-1298" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rev_TOTALS =</span> <span class="fu">sum</span>(<span class="fu">across</span>(rev_02<span class="sc">:</span>rev_78)))</span>
<span id="cb43-1299"><a href="#cb43-1299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1300"><a href="#cb43-1300" aria-hidden="true" tabindex="-1"></a>rev_long <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(rev_totals, rev_02<span class="sc">:</span>rev_TOTALS, <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"type"</span>,<span class="st">"Category"</span>), <span class="at">values_to =</span> <span class="st">"Dollars"</span>, <span class="at">names_sep =</span> <span class="st">"_"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb43-1301"><a href="#cb43-1301" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Year =</span> fy) <span class="sc">%&gt;%</span></span>
<span id="cb43-1302"><a href="#cb43-1302" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Category_name =</span> <span class="fu">case_when</span>(</span>
<span id="cb43-1303"><a href="#cb43-1303" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"02"</span> <span class="sc">~</span> <span class="st">"INDIVIDUAL INCOME TAXES"</span> ,</span>
<span id="cb43-1304"><a href="#cb43-1304" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"03"</span> <span class="sc">~</span> <span class="st">"CORPORATE INCOME TAXES"</span> ,</span>
<span id="cb43-1305"><a href="#cb43-1305" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"06"</span> <span class="sc">~</span> <span class="st">"SALES TAXES"</span> ,</span>
<span id="cb43-1306"><a href="#cb43-1306" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"09"</span> <span class="sc">~</span> <span class="st">"MOTOR FUEL TAX"</span> ,</span>
<span id="cb43-1307"><a href="#cb43-1307" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"12"</span> <span class="sc">~</span> <span class="st">"PUBLIC UTILITY TAXES"</span> ,</span>
<span id="cb43-1308"><a href="#cb43-1308" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"15"</span> <span class="sc">~</span> <span class="st">"CIGARETTE TAXES"</span> ,</span>
<span id="cb43-1309"><a href="#cb43-1309" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"18"</span> <span class="sc">~</span> <span class="st">"LIQUOR GALLONAGE TAXES"</span> ,</span>
<span id="cb43-1310"><a href="#cb43-1310" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"21"</span> <span class="sc">~</span> <span class="st">"INHERITANCE TAX"</span> ,</span>
<span id="cb43-1311"><a href="#cb43-1311" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"24"</span> <span class="sc">~</span> <span class="st">"INSURANCE TAXES&amp;FEES&amp;LICENSES"</span> ,</span>
<span id="cb43-1312"><a href="#cb43-1312" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"27"</span> <span class="sc">~</span> <span class="st">"CORP FRANCHISE TAXES &amp; FEES"</span> ,</span>
<span id="cb43-1313"><a href="#cb43-1313" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"30"</span> <span class="sc">~</span> <span class="st">"HORSE RACING TAXES &amp; FEES"</span>,  <span class="co"># in Other</span></span>
<span id="cb43-1314"><a href="#cb43-1314" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"31"</span> <span class="sc">~</span> <span class="st">"MEDICAL PROVIDER ASSESSMENTS"</span> ,</span>
<span id="cb43-1315"><a href="#cb43-1315" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"32"</span> <span class="sc">~</span> <span class="st">"GARNISHMENT-LEVIES"</span> , <span class="co"># dropped</span></span>
<span id="cb43-1316"><a href="#cb43-1316" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"33"</span> <span class="sc">~</span>  <span class="st">"LOTTERY RECEIPTS"</span> ,</span>
<span id="cb43-1317"><a href="#cb43-1317" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"35"</span> <span class="sc">~</span>  <span class="st">"OTHER TAXES"</span> ,</span>
<span id="cb43-1318"><a href="#cb43-1318" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"36"</span> <span class="sc">~</span>  <span class="st">"RECEIPTS FROM REVENUE PRODUCING"</span>, </span>
<span id="cb43-1319"><a href="#cb43-1319" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"39"</span> <span class="sc">~</span>  <span class="st">"LICENSES, FEES &amp; REGISTRATIONS"</span> ,</span>
<span id="cb43-1320"><a href="#cb43-1320" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"42"</span> <span class="sc">~</span>  <span class="st">"MOTOR VEHICLE AND OPERATORS"</span> ,</span>
<span id="cb43-1321"><a href="#cb43-1321" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"45"</span> <span class="sc">~</span>  <span class="st">"STUDENT FEES-UNIVERSITIES"</span>,   <span class="co"># dropped</span></span>
<span id="cb43-1322"><a href="#cb43-1322" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"48"</span> <span class="sc">~</span>  <span class="st">"RIVERBOAT WAGERING TAXES"</span> ,</span>
<span id="cb43-1323"><a href="#cb43-1323" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"51"</span> <span class="sc">~</span>  <span class="st">"RETIREMENT CONTRIBUTIONS"</span> , <span class="co"># dropped</span></span>
<span id="cb43-1324"><a href="#cb43-1324" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"54"</span> <span class="sc">~</span> <span class="st">"GIFTS AND BEQUESTS"</span>, </span>
<span id="cb43-1325"><a href="#cb43-1325" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"57"</span> <span class="sc">~</span>  <span class="st">"FEDERAL OTHER"</span> ,</span>
<span id="cb43-1326"><a href="#cb43-1326" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"58"</span> <span class="sc">~</span>  <span class="st">"FEDERAL MEDICAID"</span>, </span>
<span id="cb43-1327"><a href="#cb43-1327" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"59"</span> <span class="sc">~</span>  <span class="st">"FEDERAL TRANSPORTATION"</span> ,</span>
<span id="cb43-1328"><a href="#cb43-1328" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"60"</span> <span class="sc">~</span>  <span class="st">"OTHER GRANTS AND CONTRACTS"</span>, <span class="co">#other</span></span>
<span id="cb43-1329"><a href="#cb43-1329" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"63"</span> <span class="sc">~</span>  <span class="st">"INVESTMENT INCOME"</span>, <span class="co"># other</span></span>
<span id="cb43-1330"><a href="#cb43-1330" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"66"</span> <span class="sc">~</span> <span class="st">"PROCEEDS,INVESTMENT MATURITIES"</span> , <span class="co">#dropped</span></span>
<span id="cb43-1331"><a href="#cb43-1331" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"72"</span> <span class="sc">~</span> <span class="st">"BOND ISSUE PROCEEDS"</span>,  <span class="co">#dropped</span></span>
<span id="cb43-1332"><a href="#cb43-1332" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"75"</span> <span class="sc">~</span>  <span class="st">"INTER-AGENCY RECEIPTS "</span>,  <span class="co">#dropped</span></span>
<span id="cb43-1333"><a href="#cb43-1333" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"76"</span> <span class="sc">~</span>  <span class="st">"TRANSFER IN FROM OUT FUNDS"</span>,  <span class="co">#other</span></span>
<span id="cb43-1334"><a href="#cb43-1334" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"78"</span> <span class="sc">~</span>  <span class="st">"ALL OTHER SOURCES"</span> ,</span>
<span id="cb43-1335"><a href="#cb43-1335" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"79"</span> <span class="sc">~</span>   <span class="st">"COOK COUNTY IGT"</span>, <span class="co">#dropped</span></span>
<span id="cb43-1336"><a href="#cb43-1336" aria-hidden="true" tabindex="-1"></a>    Category <span class="sc">==</span> <span class="st">"98"</span> <span class="sc">~</span>  <span class="st">"PRIOR YEAR REFUNDS"</span>, <span class="co">#dropped</span></span>
<span id="cb43-1337"><a href="#cb43-1337" aria-hidden="true" tabindex="-1"></a>Category <span class="sc">==</span> <span class="st">"TOTALS"</span> <span class="sc">~</span> <span class="st">"Total"</span></span>
<span id="cb43-1338"><a href="#cb43-1338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1339"><a href="#cb43-1339" aria-hidden="true" tabindex="-1"></a>  ) ) <span class="sc">%&gt;%</span> </span>
<span id="cb43-1340"><a href="#cb43-1340" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>type, <span class="sc">-</span>Category) <span class="sc">%&gt;%</span>  <span class="co"># drop extra columns type and Category number</span></span>
<span id="cb43-1341"><a href="#cb43-1341" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, Category_name) <span class="sc">%&gt;%</span></span>
<span id="cb43-1342"><a href="#cb43-1342" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Dollars=</span> <span class="fu">round</span>(<span class="fu">sum</span>(Dollars),<span class="at">digits=</span><span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb43-1343"><a href="#cb43-1343" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Category_name =</span> <span class="fu">str_to_title</span>(Category_name))</span>
<span id="cb43-1344"><a href="#cb43-1344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1345"><a href="#cb43-1345" aria-hidden="true" tabindex="-1"></a><span class="co"># creates wide version of table where each revenue source is a column</span></span>
<span id="cb43-1346"><a href="#cb43-1346" aria-hidden="true" tabindex="-1"></a>revenue_wide2 <span class="ot">&lt;-</span> rev_long <span class="sc">%&gt;%</span> <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Category_name, </span>
<span id="cb43-1347"><a href="#cb43-1347" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> Dollars) <span class="sc">%&gt;%</span></span>
<span id="cb43-1348"><a href="#cb43-1348" aria-hidden="true" tabindex="-1"></a><span class="co">#  relocate("Other Revenue Sources **", .after = last_col()) %&gt;%</span></span>
<span id="cb43-1349"><a href="#cb43-1349" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(<span class="st">"Total"</span>, <span class="at">.after =</span>  <span class="fu">last_col</span>())</span>
<span id="cb43-1350"><a href="#cb43-1350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1351"><a href="#cb43-1351" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-1352"><a href="#cb43-1352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1353"><a href="#cb43-1353" aria-hidden="true" tabindex="-1"></a><span class="in">```{r }</span></span>
<span id="cb43-1354"><a href="#cb43-1354" aria-hidden="true" tabindex="-1"></a><span class="in">exp_long &lt;- pivot_longer(exp_totals, exp_402:exp_TOTALS , names_to = c("type", "Category"), values_to = "Dollars", names_sep = "_") %&gt;% </span></span>
<span id="cb43-1355"><a href="#cb43-1355" aria-hidden="true" tabindex="-1"></a><span class="in">  rename(Year = fy ) %&gt;% </span></span>
<span id="cb43-1356"><a href="#cb43-1356" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(Category_name = </span></span>
<span id="cb43-1357"><a href="#cb43-1357" aria-hidden="true" tabindex="-1"></a><span class="in">           case_when(</span></span>
<span id="cb43-1358"><a href="#cb43-1358" aria-hidden="true" tabindex="-1"></a><span class="in">            Category == "402" ~ "AGING" ,</span></span>
<span id="cb43-1359"><a href="#cb43-1359" aria-hidden="true" tabindex="-1"></a><span class="in">            Category == "406" ~ "AGRICULTURE", </span></span>
<span id="cb43-1360"><a href="#cb43-1360" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "416" ~ "Central Management",</span></span>
<span id="cb43-1361"><a href="#cb43-1361" aria-hidden="true" tabindex="-1"></a><span class="in">            Category == "418" ~ "CHILDREN AND FAMILY SERVICES", </span></span>
<span id="cb43-1362"><a href="#cb43-1362" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "420" ~ "Community Development",</span></span>
<span id="cb43-1363"><a href="#cb43-1363" aria-hidden="true" tabindex="-1"></a><span class="in">            Category == "422" ~ "NATURAL RESOURCES" ,</span></span>
<span id="cb43-1364"><a href="#cb43-1364" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "426" ~ "CORRECTIONS",</span></span>
<span id="cb43-1365"><a href="#cb43-1365" aria-hidden="true" tabindex="-1"></a><span class="in">            Category == "427" ~ "EMPLOYMENT SECURITY" ,</span></span>
<span id="cb43-1366"><a href="#cb43-1366" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "444" ~ "Human Services" ,</span></span>
<span id="cb43-1367"><a href="#cb43-1367" aria-hidden="true" tabindex="-1"></a><span class="in">           Category == "478" ~ "HEALTHCARE &amp; FAM SER NET OF MEDICAID", </span></span>
<span id="cb43-1368"><a href="#cb43-1368" aria-hidden="true" tabindex="-1"></a><span class="in">            Category == "482" ~ "PUBLIC HEALTH", </span></span>
<span id="cb43-1369"><a href="#cb43-1369" aria-hidden="true" tabindex="-1"></a><span class="in">            Category == "492" ~ "REVENUE", </span></span>
<span id="cb43-1370"><a href="#cb43-1370" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "494" ~ "Transportation" ,</span></span>
<span id="cb43-1371"><a href="#cb43-1371" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "532" ~ "ENVIRONMENTAL PROTECT AGENCY" ,</span></span>
<span id="cb43-1372"><a href="#cb43-1372" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "557" ~ "Tollway" ,</span></span>
<span id="cb43-1373"><a href="#cb43-1373" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "684" ~ "IL COMMUNITY COLLEGE BOARD", </span></span>
<span id="cb43-1374"><a href="#cb43-1374" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "691" ~ "IL STUDENT ASSISTANCE COMM" ,</span></span>
<span id="cb43-1375"><a href="#cb43-1375" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "900" ~ "NOT IN FRAME",</span></span>
<span id="cb43-1376"><a href="#cb43-1376" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "901" ~ "State Pension Contribution",</span></span>
<span id="cb43-1377"><a href="#cb43-1377" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "903" ~ "Debt Service",</span></span>
<span id="cb43-1378"><a href="#cb43-1378" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "904" ~ "State Employee Healthcare",</span></span>
<span id="cb43-1379"><a href="#cb43-1379" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "910" ~ "LEGISLATIVE"  ,</span></span>
<span id="cb43-1380"><a href="#cb43-1380" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "920" ~ "JUDICIAL" ,</span></span>
<span id="cb43-1381"><a href="#cb43-1381" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "930" ~ "ELECTED OFFICERS" , </span></span>
<span id="cb43-1382"><a href="#cb43-1382" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "940" ~ "OTHER HEALTH-RELATED", </span></span>
<span id="cb43-1383"><a href="#cb43-1383" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "941" ~ "Public Safety" ,</span></span>
<span id="cb43-1384"><a href="#cb43-1384" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "942" ~ "ECON DEVT &amp; INFRASTRUCTURE" ,</span></span>
<span id="cb43-1385"><a href="#cb43-1385" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "943" ~ "CENTRAL SERVICES",</span></span>
<span id="cb43-1386"><a href="#cb43-1386" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "944" ~ "BUS &amp; PROFESSION REGULATION" ,</span></span>
<span id="cb43-1387"><a href="#cb43-1387" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "945" ~ "Medicaid" ,</span></span>
<span id="cb43-1388"><a href="#cb43-1388" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "946" ~ "Capital Improvement" , </span></span>
<span id="cb43-1389"><a href="#cb43-1389" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "948" ~ "OTHER DEPARTMENTS" ,</span></span>
<span id="cb43-1390"><a href="#cb43-1390" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "949" ~ "OTHER BOARDS &amp; COMMISSIONS" ,</span></span>
<span id="cb43-1391"><a href="#cb43-1391" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "959" ~ "K-12 Education" ,</span></span>
<span id="cb43-1392"><a href="#cb43-1392" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "960" ~ "UNIVERSITY EDUCATION",</span></span>
<span id="cb43-1393"><a href="#cb43-1393" aria-hidden="true" tabindex="-1"></a><span class="in">             Category == "970" ~ "Local Govt Revenue Sharing",</span></span>
<span id="cb43-1394"><a href="#cb43-1394" aria-hidden="true" tabindex="-1"></a><span class="in">          Category == "TOTALS" ~ "Total") #,T ~ "All Other Expenditures **")</span></span>
<span id="cb43-1395"><a href="#cb43-1395" aria-hidden="true" tabindex="-1"></a><span class="in">           ) %&gt;% </span></span>
<span id="cb43-1396"><a href="#cb43-1396" aria-hidden="true" tabindex="-1"></a><span class="in">  select(-type, -Category) %&gt;% </span></span>
<span id="cb43-1397"><a href="#cb43-1397" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(Year, Category_name) %&gt;% </span></span>
<span id="cb43-1398"><a href="#cb43-1398" aria-hidden="true" tabindex="-1"></a><span class="in">  summarise(Dollars= round(sum(Dollars),digits=2)) %&gt;% </span></span>
<span id="cb43-1399"><a href="#cb43-1399" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(Category_name = str_to_title(Category_name))</span></span>
<span id="cb43-1400"><a href="#cb43-1400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1401"><a href="#cb43-1401" aria-hidden="true" tabindex="-1"></a><span class="in">expenditure_wide2 &lt;- exp_long%&gt;% </span></span>
<span id="cb43-1402"><a href="#cb43-1402" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_wider(names_from = Category_name, </span></span>
<span id="cb43-1403"><a href="#cb43-1403" aria-hidden="true" tabindex="-1"></a><span class="in">              values_from = Dollars) %&gt;%</span></span>
<span id="cb43-1404"><a href="#cb43-1404" aria-hidden="true" tabindex="-1"></a><span class="in">  #relocate("All Other Expenditures **", .after = last_col()) %&gt;%</span></span>
<span id="cb43-1405"><a href="#cb43-1405" aria-hidden="true" tabindex="-1"></a><span class="in">  relocate("Total", .after =  last_col())</span></span>
<span id="cb43-1406"><a href="#cb43-1406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1407"><a href="#cb43-1407" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>